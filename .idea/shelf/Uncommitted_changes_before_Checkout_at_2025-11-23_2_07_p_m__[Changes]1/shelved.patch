Index: app/src/main/java/com/example/smartair/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.smartair;\r\n\r\nimport android.os.Bundle;\r\n\r\nimport androidx.activity.EdgeToEdge;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.graphics.Insets;\r\nimport androidx.core.view.ViewCompat;\r\nimport androidx.core.view.WindowInsetsCompat;\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        EdgeToEdge.enable(this);\r\n        setContentView(R.layout.activity_main);\r\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {\r\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\r\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\r\n            return insets;\r\n        });\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/MainActivity.java b/app/src/main/java/com/example/smartair/MainActivity.java
--- a/app/src/main/java/com/example/smartair/MainActivity.java	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/src/main/java/com/example/smartair/MainActivity.java	(date 1763918002059)
@@ -1,24 +1,87 @@
 package com.example.smartair;
 
+import android.content.Intent;
 import android.os.Bundle;
+import android.widget.Button;
+import android.widget.EditText;
 
-import androidx.activity.EdgeToEdge;
+
 import androidx.appcompat.app.AppCompatActivity;
 import androidx.core.graphics.Insets;
 import androidx.core.view.ViewCompat;
 import androidx.core.view.WindowInsetsCompat;
 
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import android.widget.Toast;
+
+
 public class MainActivity extends AppCompatActivity {
+    private EditText etEmail, etPassword;
+    private Button btnLogin, btnGoSignUp;
+    private FirebaseAuth mAuth;
+    private FirebaseFirestore db;
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        EdgeToEdge.enable(this);
         setContentView(R.layout.activity_main);
-        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {
-            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
-            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
-            return insets;
-        });
+
+        etEmail = findViewById(R.id.etEmail);
+        etPassword = findViewById(R.id.etPassword);
+        btnLogin = findViewById(R.id.btnLogin);
+        btnGoSignUp = findViewById(R.id.btnGoSignUp);
+
+        mAuth = FirebaseAuth.getInstance();
+        db = FirebaseFirestore.getInstance();
+
+        btnGoSignUp.setOnClickListener(v -> startActivity(new Intent(this, com.example.smartair.unsure.SignUpActivity.class)));
+
+        btnLogin.setOnClickListener(v -> loginUser());
+    }
+
+    private void loginUser() {
+        String email = etEmail.getText().toString().trim();
+        String password = etPassword.getText().toString().trim();
+
+        if(email.isEmpty() || password.isEmpty()) {
+            Toast.makeText(this, "Email and password cannot be empty", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        mAuth.signInWithEmailAndPassword(email, password)
+                .addOnCompleteListener(this, task -> {
+                    if(task.isSuccessful()) {
+                        FirebaseUser user = mAuth.getCurrentUser();
+                        if(user != null) {
+                            db.collection("users").document(user.getUid())
+                                    .get()
+                                    .addOnSuccessListener(doc -> {
+                                        if(doc.exists()) {
+                                            String role = doc.getString("role");
+                                            if(role == null) role = "child";
+                                            switch(role) {
+                                                case "child":
+                                                    startActivity(new Intent(this, com.example.smartair.homepages.HomepageActivity.class));
+                                                    break;
+                                                case "parent":
+                                                    startActivity(new Intent(this, com.example.smartair.homepages.HomepageParentsActivity.class));
+                                                    break;
+                                                case "provider":
+                                                    startActivity(new Intent(this, com.example.smartair.homepages.HomepageProvidersActivity.class));
+                                                    break;
+                                            }
+                                            finish();
+                                        } else {
+                                            Toast.makeText(this, "User role not found", Toast.LENGTH_SHORT).show();
+                                        }
+                                    });
+                        }
+                    } else {
+                        Toast.makeText(this, "Login Failed: " + task.getException().getMessage(), Toast.LENGTH_SHORT).show();
+                    }
+                });
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/onboarding/OnboardingActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/onboarding/OnboardingActivity.java b/app/src/main/java/com/example/smartair/onboarding/OnboardingActivity.java
new file mode 100644
--- /dev/null	(date 1763918002075)
+++ b/app/src/main/java/com/example/smartair/onboarding/OnboardingActivity.java	(date 1763918002075)
@@ -0,0 +1,4 @@
+package com.example.smartair.onboarding;
+
+public class OnboardingActivity {
+}
Index: app/src/main/java/com/example/smartair/technique_guidance/YoutubePageFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/technique_guidance/YoutubePageFragment.java b/app/src/main/java/com/example/smartair/technique_guidance/YoutubePageFragment.java
new file mode 100644
--- /dev/null	(date 1763918002082)
+++ b/app/src/main/java/com/example/smartair/technique_guidance/YoutubePageFragment.java	(date 1763918002082)
@@ -0,0 +1,60 @@
+package com.example.smartair.technique_guidance;
+
+import android.annotation.SuppressLint;
+import android.os.Bundle;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.webkit.WebSettings;
+import android.webkit.WebView;
+import android.webkit.WebViewClient;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+import com.example.smartair.R;
+
+public class YoutubePageFragment extends Fragment {
+
+    private static final String ARG_VIDEO = "arg_video";
+    private String videoId;
+
+    public static YoutubePageFragment newInstance(String videoId) {
+        YoutubePageFragment f = new YoutubePageFragment();
+        Bundle b = new Bundle();
+        b.putString(ARG_VIDEO, videoId);
+        f.setArguments(b);
+        return f;
+    }
+
+    @Override
+    public void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        if (getArguments() != null) videoId = getArguments().getString(ARG_VIDEO);
+    }
+
+    @SuppressLint("SetJavaScriptEnabled")
+    @Nullable
+    @Override
+    public View onCreateView(@NonNull LayoutInflater inflater,
+                             @Nullable ViewGroup container,
+                             @Nullable Bundle savedInstanceState) {
+        View v = inflater.inflate(R.layout.fragment_youtube, container, false);
+        WebView webView = v.findViewById(R.id.youtubeWebView);
+
+        WebSettings ws = webView.getSettings();
+        ws.setJavaScriptEnabled(true);
+        ws.setDomStorageEnabled(true);
+        webView.setWebViewClient(new WebViewClient());
+
+        // Use YouTube embed (responsive)
+        String html = "<html><body style='margin:0;padding:0;'><iframe width='100%' height='100%' " +
+                "src='https://www.youtube.com/embed/" + videoId + "?rel=0&autoplay=0' " +
+                "frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></body></html>";
+
+        webView.loadData(html, "text/html", "utf-8");
+        return v;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/model/PEFEntry.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/model/PEFEntry.java b/app/src/main/java/com/example/smartair/model/PEFEntry.java
new file mode 100644
--- /dev/null	(date 1763918002073)
+++ b/app/src/main/java/com/example/smartair/model/PEFEntry.java	(date 1763918002073)
@@ -0,0 +1,121 @@
+package com.example.smartair.model;
+
+import android.util.Log;
+import org.json.JSONException;
+import org.json.JSONObject;
+import java.io.Serializable;
+
+/**
+ * Represents a Peak Expiratory Flow (PEF) entry.
+ * Can be tagged as pre-medicine or post-medicine to track how medicine affects breathing.
+ */
+public class PEFEntry implements Serializable {
+    private static final String TAG = "PEFEntry";
+    
+    private String id;
+    private int pefValue; // PEF value in L/min
+    private long timestamp; // Unix timestamp in milliseconds
+    private MedicineTag medicineTag; // Pre-medicine or post-medicine tag
+
+    public enum MedicineTag {
+        PRE_MEDICINE("Before Medicine"),
+        POST_MEDICINE("After Medicine"),
+        NONE("No Medicine Tag");
+
+        private final String displayName;
+
+        MedicineTag(String displayName) {
+            this.displayName = displayName;
+        }
+
+        public String getDisplayName() {
+            return displayName;
+        }
+
+        public static MedicineTag fromString(String value) {
+            try {
+                return valueOf(value);
+            } catch (Exception e) {
+                return NONE;
+            }
+        }
+    }
+
+    public PEFEntry() {
+        // no-arg
+    }
+
+    public PEFEntry(int pefValue, long timestamp, MedicineTag medicineTag) {
+        this.pefValue = pefValue;
+        this.timestamp = timestamp;
+        this.medicineTag = medicineTag != null ? medicineTag : MedicineTag.NONE;
+    }
+
+    public String getId() {
+        return id;
+    }
+
+    public void setId(String id) {
+        this.id = id;
+    }
+
+    public int getPefValue() {
+        return pefValue;
+    }
+
+    public void setPefValue(int pefValue) {
+        this.pefValue = pefValue;
+    }
+
+    public long getTimestamp() {
+        return timestamp;
+    }
+
+    public void setTimestamp(long timestamp) {
+        this.timestamp = timestamp;
+    }
+
+    public MedicineTag getMedicineTag() {
+        return medicineTag;
+    }
+
+    public void setMedicineTag(MedicineTag medicineTag) {
+        this.medicineTag = medicineTag != null ? medicineTag : MedicineTag.NONE;
+    }
+
+    public boolean isPreMedicine() {
+        return medicineTag == MedicineTag.PRE_MEDICINE;
+    }
+
+    public boolean isPostMedicine() {
+        return medicineTag == MedicineTag.POST_MEDICINE;
+    }
+
+    public JSONObject toJSON() {
+        JSONObject json = new JSONObject();
+        try {
+            json.put("id", id != null ? id : "");
+            json.put("pefValue", pefValue);
+            json.put("timestamp", timestamp);
+            json.put("medicineTag", medicineTag != null ? medicineTag.name() : MedicineTag.NONE.name());
+        } catch (JSONException e) {
+            Log.e(TAG, "Error converting PEFEntry to JSON", e);
+        }
+        return json;
+    }
+
+    public static PEFEntry fromJSON(JSONObject json) {
+        PEFEntry entry = new PEFEntry();
+        try {
+            entry.setId(json.optString("id", ""));
+            entry.setPefValue(json.optInt("pefValue", 0));
+            entry.setTimestamp(json.optLong("timestamp", System.currentTimeMillis()));
+            String tagStr = json.optString("medicineTag", MedicineTag.NONE.name());
+            entry.setMedicineTag(MedicineTag.fromString(tagStr));
+        } catch (Exception e) {
+            Log.e(TAG, "Error creating PEFEntry from JSON", e);
+        }
+        return entry;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/model/Child.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/model/Child.java b/app/src/main/java/com/example/smartair/model/Child.java
new file mode 100644
--- /dev/null	(date 1763918002073)
+++ b/app/src/main/java/com/example/smartair/model/Child.java	(date 1763918002073)
@@ -0,0 +1,106 @@
+package com.example.smartair.model;
+
+import android.util.Log;
+import org.json.JSONException;
+import org.json.JSONObject;
+import java.io.Serializable;
+
+/**
+ * Represents a child user in the SmartAir app.
+ * Contains personal information and health metrics including Personal Best (PB).
+ */
+public class Child implements Serializable {
+    private static final String TAG = "Child";
+    
+    private String id;
+    private String name;
+    private String dateOfBirth; // Format: YYYY-MM-DD
+    private Integer personalBest; // Personal Best PEF value (null if not set)
+    private String notes; // Optional notes
+
+    public Child() {
+    }
+
+    public Child(String id, String name, String dateOfBirth) {
+        this.id = id;
+        this.name = name;
+        this.dateOfBirth = dateOfBirth;
+        this.personalBest = null;
+        this.notes = null;
+    }
+
+    public String getId() {
+        return id;
+    }
+
+    public void setId(String id) {
+        this.id = id;
+    }
+
+    public String getName() {
+        return name;
+    }
+
+    public void setName(String name) {
+        this.name = name;
+    }
+
+    public String getDateOfBirth() {
+        return dateOfBirth;
+    }
+
+    public void setDateOfBirth(String dateOfBirth) {
+        this.dateOfBirth = dateOfBirth;
+    }
+
+    public Integer getPersonalBest() {
+        return personalBest;
+    }
+
+    public void setPersonalBest(Integer personalBest) {
+        this.personalBest = personalBest;
+    }
+
+    public String getNotes() {
+        return notes;
+    }
+
+    public void setNotes(String notes) {
+        this.notes = notes;
+    }
+
+    public boolean hasPersonalBest() {
+        return personalBest != null && personalBest > 0;
+    }
+
+    public JSONObject toJSON() {
+        JSONObject json = new JSONObject();
+        try {
+            json.put("id", id != null ? id : "");
+            json.put("name", name != null ? name : "");
+            json.put("dateOfBirth", dateOfBirth != null ? dateOfBirth : "");
+            json.put("personalBest", personalBest != null ? personalBest : JSONObject.NULL);
+            json.put("notes", notes != null ? notes : "");
+        } catch (JSONException e) {
+            Log.e(TAG, "Error converting Child to JSON", e);
+        }
+        return json;
+    }
+
+    public static Child fromJSON(JSONObject json) {
+        Child child = new Child();
+        try {
+            child.setId(json.optString("id", ""));
+            child.setName(json.optString("name", ""));
+            child.setDateOfBirth(json.optString("dateOfBirth", ""));
+            if (!json.isNull("personalBest")) {
+                child.setPersonalBest(json.optInt("personalBest", 0));
+            }
+            child.setNotes(json.optString("notes", ""));
+        } catch (Exception e) {
+            Log.e(TAG, "Error creating Child from JSON", e);
+        }
+        return child;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/technique_guidance/StepFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/technique_guidance/StepFragment.java b/app/src/main/java/com/example/smartair/technique_guidance/StepFragment.java
new file mode 100644
--- /dev/null	(date 1763918002080)
+++ b/app/src/main/java/com/example/smartair/technique_guidance/StepFragment.java	(date 1763918002080)
@@ -0,0 +1,60 @@
+package com.example.smartair.technique_guidance;
+
+
+import android.os.Bundle;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+import com.example.smartair.R;
+
+public class StepFragment extends Fragment {
+
+    private static final String ARG_IMG = "arg_img";
+    private static final String ARG_TEXT = "arg_text";
+
+    public static StepFragment newInstance(int imgRes, String text) {
+        StepFragment f = new StepFragment();
+        Bundle b = new Bundle();
+        b.putInt(ARG_IMG, imgRes);
+        b.putString(ARG_TEXT, text);
+        f.setArguments(b);
+        return f;
+    }
+
+    private int imgRes;
+    private String text;
+
+    @Override
+    public void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        if (getArguments() != null) {
+            imgRes = getArguments().getInt(ARG_IMG);
+            text = getArguments().getString(ARG_TEXT);
+        }
+    }
+
+    @Nullable
+    @Override
+    public View onCreateView(@NonNull LayoutInflater inflater,
+                             @Nullable ViewGroup container,
+                             @Nullable Bundle savedInstanceState) {
+        View v = inflater.inflate(R.layout.fragment_step, container, false);
+        ImageView img = v.findViewById(R.id.stepImage);
+        TextView txt = v.findViewById(R.id.stepText);
+
+        if (imgRes != 0) {
+            img.setImageResource(imgRes);
+        }
+        txt.setText(text);
+
+        return v;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/technique_guidance/PageItem.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/technique_guidance/PageItem.java b/app/src/main/java/com/example/smartair/technique_guidance/PageItem.java
new file mode 100644
--- /dev/null	(date 1763918002079)
+++ b/app/src/main/java/com/example/smartair/technique_guidance/PageItem.java	(date 1763918002079)
@@ -0,0 +1,14 @@
+package com.example.smartair.technique_guidance;
+
+
+
+public class PageItem {
+    public int imageRes; // 0 => special (youtube)
+    public String text;  // for youtube page we store "youtube:VIDEO_ID"
+
+    public PageItem(int imageRes, String text) {
+        this.imageRes = imageRes;
+        this.text = text;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/technique_guidance/TechniqueActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/technique_guidance/TechniqueActivity.java b/app/src/main/java/com/example/smartair/technique_guidance/TechniqueActivity.java
new file mode 100644
--- /dev/null	(date 1763918002081)
+++ b/app/src/main/java/com/example/smartair/technique_guidance/TechniqueActivity.java	(date 1763918002081)
@@ -0,0 +1,45 @@
+package com.example.smartair.technique_guidance;
+
+import android.os.Bundle;
+
+import androidx.annotation.Nullable;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.viewpager2.widget.ViewPager2;
+
+import com.example.smartair.R;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public class TechniqueActivity extends AppCompatActivity {
+
+    private ViewPager2 viewPager;
+    private StepsAdapter adapter;
+
+    @Override
+    protected void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_technique);
+
+        viewPager = findViewById(R.id.viewPager);
+
+        // prepare pages: 5 steps + 1 youtube page
+        List<PageItem> pages = new ArrayList<>();
+
+        // step images should be in res/drawable/step1.jpg ... step5.jpg
+        pages.add(new PageItem(R.drawable.step1, "Step 1 — Get ready: Seal the mouthpiece\n\nImagine your little rocket would leak if air slips out. Put your lips tightly around the mouthpiece—no gaps."));
+        pages.add(new PageItem(R.drawable.step2, "Step 2 — Empty your lungs: Blow out slowly\n\nBefore pressing your rocket, breathe out all the air like blowing out a birthday candle."));
+        pages.add(new PageItem(R.drawable.step3, "Step 3 — Fire! Inhale deeply while pressing\n\nPress the inhaler quickly and deeply breathe in for 3–5 seconds so the medicine reaches the lungs."));
+        pages.add(new PageItem(R.drawable.step4, "Step 4 — Hold the breath\n\nHold your breath for about 10 seconds if you can — this helps the medicine work. If not, hold as long as comfortable (at least 4–5s)."));
+        pages.add(new PageItem(R.drawable.step5, "Step 5 — Wait before the next puff\n\nIf another puff is needed, wait 30–60 seconds (sing a short song!) then repeat the steps."));
+
+        // youtube page special: imageResId = 0 means youtube page (adapter will detect)
+        pages.add(new PageItem(0, "youtube:Br9irulpbsc"));
+
+        adapter = new StepsAdapter(this, pages);
+        viewPager.setAdapter(adapter);
+
+        // Optional: set orientation and offscreen limit
+        viewPager.setOffscreenPageLimit(1);
+    }
+}
Index: app/src/main/java/com/example/smartair/technique_guidance/StepsAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/technique_guidance/StepsAdapter.java b/app/src/main/java/com/example/smartair/technique_guidance/StepsAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002081)
+++ b/app/src/main/java/com/example/smartair/technique_guidance/StepsAdapter.java	(date 1763918002081)
@@ -0,0 +1,38 @@
+package com.example.smartair.technique_guidance;
+
+import android.content.Context;
+
+import androidx.annotation.NonNull;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentActivity;
+import androidx.viewpager2.adapter.FragmentStateAdapter;
+
+import java.util.List;
+
+public class StepsAdapter extends FragmentStateAdapter {
+
+    private List<PageItem> pages;
+
+    public StepsAdapter(@NonNull FragmentActivity fragmentActivity, List<PageItem> pages) {
+        super(fragmentActivity);
+        this.pages = pages;
+    }
+
+    @NonNull
+    @Override
+    public Fragment createFragment(int position) {
+        PageItem item = pages.get(position);
+        if (item.imageRes == 0 && item.text != null && item.text.startsWith("youtube:")) {
+            String videoId = item.text.substring("youtube:".length());
+            return com.example.smartair.technique_guidance.YoutubePageFragment.newInstance(videoId);
+        } else {
+            return StepFragment.newInstance(item.imageRes, item.text);
+        }
+    }
+
+    @Override
+    public int getItemCount() {
+        return pages.size();
+    }
+}
+
Index: app/src/main/res/layout/item_child.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_child.xml b/app/src/main/res/layout/item_child.xml
new file mode 100644
--- /dev/null	(date 1763918002234)
+++ b/app/src/main/res/layout/item_child.xml	(date 1763918002234)
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="vertical"
+    android:padding="16dp"
+    android:background="?android:attr/selectableItemBackground">
+
+    <TextView
+        android:id="@+id/txtChildName"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Child Name"
+        android:textSize="18sp"
+        android:textStyle="bold" />
+
+    <TextView
+        android:id="@+id/txtChildDOB"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Date of Birth: DD-MM-YY"
+        android:textSize="14sp"
+        android:textColor="#666" />
+
+    <TextView
+        android:id="@+id/txtChildNotes"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Notes..."
+        android:textSize="14sp"
+        android:textColor="#555" />
+</LinearLayout>
Index: app/src/main/res/layout/activity_register.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_register.xml b/app/src/main/res/layout/activity_register.xml
new file mode 100644
--- /dev/null	(date 1763918002232)
+++ b/app/src/main/res/layout/activity_register.xml	(date 1763918002232)
@@ -0,0 +1,167 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fillViewport="true"
+    android:background="@android:color/white">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="24dp">
+
+        <TextView
+            android:id="@+id/titleTextView"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Create Account"
+            android:textSize="28sp"
+            android:textStyle="bold"
+            android:textColor="@android:color/black"
+            android:layout_marginTop="32dp"
+            app:layout_constraintTop_toTopOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent" />
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/nameInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="32dp"
+            android:hint="Name"
+            app:layout_constraintTop_toBottomOf="@id/titleTextView">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/nameEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textPersonName"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/emailInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:hint="Email"
+            app:layout_constraintTop_toBottomOf="@id/nameInputLayout">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/emailEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textEmailAddress"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/passwordInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:hint="Password"
+            app:passwordToggleEnabled="true"
+            app:layout_constraintTop_toBottomOf="@id/emailInputLayout">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/passwordEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textPassword"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/confirmPasswordInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:hint="Confirm Password"
+            app:passwordToggleEnabled="true"
+            app:layout_constraintTop_toBottomOf="@id/passwordInputLayout">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/confirmPasswordEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textPassword"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <TextView
+            android:id="@+id/roleLabel"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="I am a:"
+            android:textSize="16sp"
+            android:textStyle="bold"
+            android:layout_marginTop="24dp"
+            app:layout_constraintTop_toBottomOf="@id/confirmPasswordInputLayout"
+            app:layout_constraintStart_toStartOf="parent" />
+
+        <RadioGroup
+            android:id="@+id/roleRadioGroup"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="8dp"
+            app:layout_constraintTop_toBottomOf="@id/roleLabel">
+
+            <RadioButton
+                android:id="@+id/radioParent"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Parent"
+                android:textSize="16sp" />
+
+            <RadioButton
+                android:id="@+id/radioProvider"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Healthcare Provider"
+                android:textSize="16sp" />
+
+            <RadioButton
+                android:id="@+id/radioChild"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Child"
+                android:textSize="16sp" />
+        </RadioGroup>
+
+        <Button
+            android:id="@+id/registerButton"
+            android:layout_width="match_parent"
+            android:layout_height="56dp"
+            android:text="Register"
+            android:textSize="16sp"
+            android:layout_marginTop="24dp"
+            app:layout_constraintTop_toBottomOf="@id/roleRadioGroup" />
+
+        <ProgressBar
+            android:id="@+id/progressBar"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:visibility="gone"
+            app:layout_constraintTop_toBottomOf="@id/registerButton"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            android:layout_marginTop="16dp" />
+
+        <TextView
+            android:id="@+id/backToLoginTextView"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="← Back to Login"
+            android:textColor="?attr/colorPrimary"
+            android:textSize="16sp"
+            android:layout_marginTop="16dp"
+            android:clickable="true"
+            android:focusable="true"
+            app:layout_constraintTop_toBottomOf="@id/progressBar"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent" />
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+</ScrollView>
\ No newline at end of file
Index: app/src/main/res/layout/activity_manage_sharing.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_manage_sharing.xml b/app/src/main/res/layout/activity_manage_sharing.xml
new file mode 100644
--- /dev/null	(date 1763918002230)
+++ b/app/src/main/res/layout/activity_manage_sharing.xml	(date 1763918002230)
@@ -0,0 +1,369 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp">
+
+    <LinearLayout
+        android:orientation="vertical"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <!-- Title -->
+        <TextView
+            android:id="@+id/textSharingTitle"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Provider Sharing Settings"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            android:paddingBottom="16dp"/>
+
+        <!-- Subtitle -->
+        <TextView
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Choose what data (per child) is shared with the provider. All changes save automatically."
+            android:textSize="16sp"
+            android:paddingBottom="20dp" />
+
+        <!-- Loading Indicator -->
+        <ProgressBar
+            android:id="@+id/loadingIndicator"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center"
+            android:visibility="gone"
+            android:paddingBottom="16dp"/>
+
+        <TextView
+            android:id="@+id/textSaving"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Saving..."
+            android:textSize="14sp"
+            android:textColor="#888888"
+            android:visibility="gone"
+            android:paddingTop="8dp"
+            android:paddingBottom="16dp" />
+
+        <LinearLayout
+            android:id="@+id/rowRescueLogs"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Rescue Logs"
+                    android:textSize="18sp"/>
+
+                <TextView
+                    android:id="@+id/tagRescue"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchRescueLogs"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 2: CONTROLLER ADHERENCE -->
+        <LinearLayout
+            android:id="@+id/rowController"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Controller Adherence Summary"
+                    android:textSize="18sp"
+                    android:singleLine="false"
+                    android:ellipsize="none"/>
+
+                <TextView
+                    android:id="@+id/tagController"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+
+                android:id="@+id/switchController"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 3: SYMPTOMS -->
+        <LinearLayout
+            android:id="@+id/rowSymptoms"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Symptoms"
+                    android:textSize="18sp"/>
+
+                <TextView
+                    android:id="@+id/tagSymptoms"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchSymptoms"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 4: TRIGGERS -->
+        <LinearLayout
+            android:id="@+id/rowTriggers"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Triggers"
+                    android:textSize="18sp"/>
+
+                <TextView
+                    android:id="@+id/tagTriggers"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchTriggers"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 5: PEF -->
+        <LinearLayout
+            android:id="@+id/rowPEF"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Peak-Flow (PEF)"
+                    android:textSize="18sp"/>
+
+                <TextView
+                    android:id="@+id/tagPEF"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchPEF"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 6: TRIAGE INCIDENTS -->
+        <LinearLayout
+            android:id="@+id/rowTriage"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Triage Incidents"
+                    android:textSize="18sp"/>
+
+                <TextView
+                    android:id="@+id/tagTriage"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchTriage"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+
+        <!-- ROW 7: CHARTS -->
+        <LinearLayout
+            android:id="@+id/rowCharts"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:minHeight="64dp"
+            android:orientation="horizontal"
+            android:gravity="center_vertical"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp"
+            android:clickable="true"
+            android:focusable="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <LinearLayout
+                android:orientation="vertical"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1">
+
+                <TextView
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Share Summary Charts / Dashboard Visuals"
+                    android:textSize="18sp"
+                    android:singleLine="false"
+                    android:ellipsize="none"/>
+
+                <TextView
+                    android:id="@+id/tagCharts"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:text="Shared with Provider"
+                    android:textSize="13sp"
+                    android:textColor="#33AA33"
+                    android:visibility="gone"
+                    android:paddingTop="2dp"/>
+            </LinearLayout>
+
+            <androidx.appcompat.widget.SwitchCompat
+                android:id="@+id/switchCharts"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:duplicateParentState="true" />
+        </LinearLayout>
+
+    </LinearLayout>
+</ScrollView>
\ No newline at end of file
Index: app/src/main/res/layout/fragment_youtube.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_youtube.xml b/app/src/main/res/layout/fragment_youtube.xml
new file mode 100644
--- /dev/null	(date 1763918002234)
+++ b/app/src/main/res/layout/fragment_youtube.xml	(date 1763918002234)
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="16dp">
+
+    <androidx.cardview.widget.CardView
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:cardCornerRadius="16dp"
+        app:cardElevation="8dp"
+        android:backgroundTint="@color/card_bg">
+
+        <WebView
+            android:id="@+id/youtubeWebView"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"/>
+
+    </androidx.cardview.widget.CardView>
+
+</FrameLayout>
Index: app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckAdapter.java b/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002076)
+++ b/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckAdapter.java	(date 1763918002076)
@@ -0,0 +1,89 @@
+package com.example.smartair.pre_post_checks;
+
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.google.firebase.firestore.DocumentSnapshot;
+
+import java.text.SimpleDateFormat;
+import java.util.ArrayList;
+import java.util.Date;
+import java.util.List;
+import java.util.Locale;
+
+public class PrePostCheckAdapter extends RecyclerView.Adapter<PrePostCheckAdapter.CheckViewHolder> {
+
+    private List<DocumentSnapshot> checkList = new ArrayList<>();
+    private static final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+
+    public void setChecks(List<DocumentSnapshot> checks) {
+        this.checkList = checks != null ? checks : new ArrayList<>();
+        notifyDataSetChanged();
+    }
+
+    public void addCheck(DocumentSnapshot check) {
+        checkList.add(0, check); // 新记录插入顶部
+        notifyItemInserted(0);
+    }
+
+    @NonNull
+    @Override
+    public CheckViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(parent.getContext())
+                .inflate(R.layout.item_pre_post_check, parent, false);
+        return new CheckViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull CheckViewHolder holder, int position) {
+        holder.bind(checkList.get(position));
+    }
+
+    @Override
+    public int getItemCount() {
+        return checkList.size();
+    }
+
+    static class CheckViewHolder extends RecyclerView.ViewHolder {
+
+        TextView tvWhenResult, tvRating, tvNote, tvTimestamp;
+
+        public CheckViewHolder(@NonNull View itemView) {
+            super(itemView);
+            tvWhenResult = itemView.findViewById(R.id.tvWhenResult);
+            tvRating = itemView.findViewById(R.id.tvRating);
+            tvNote = itemView.findViewById(R.id.tvNote);
+            tvTimestamp = itemView.findViewById(R.id.tvTimestamp);
+        }
+
+        public void bind(DocumentSnapshot doc) {
+            String when = doc.getString("when");
+            String result = doc.getString("result");
+            Double rating = doc.getDouble("rating");
+            String note = doc.getString("note");
+            Long ts = doc.getLong("timestamp");
+
+            tvWhenResult.setText((when != null ? when : "-") + " | " + (result != null ? result : "-"));
+            tvRating.setText("Rating: " + (rating != null ? rating : "-"));
+
+            if (note != null && !note.isEmpty()) {
+                tvNote.setText("Note: " + note);
+                tvNote.setVisibility(View.VISIBLE);
+            } else {
+                tvNote.setVisibility(View.GONE);
+            }
+
+            if (ts != null) {
+                tvTimestamp.setText(sdf.format(new Date(ts)));
+            } else {
+                tvTimestamp.setText("-");
+            }
+        }
+    }
+}
Index: app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckActivity.java b/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckActivity.java
new file mode 100644
--- /dev/null	(date 1763918002076)
+++ b/app/src/main/java/com/example/smartair/pre_post_checks/PrePostCheckActivity.java	(date 1763918002076)
@@ -0,0 +1,185 @@
+package com.example.smartair.pre_post_checks;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.text.TextUtils;
+import android.view.View;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.RatingBar;
+import android.widget.RadioButton;
+import android.widget.RadioGroup;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AlertDialog;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.example.smartair.badges_system.BadgeActivity;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.CollectionReference;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.text.SimpleDateFormat;
+import java.util.Date;
+import java.util.HashMap;
+import java.util.Locale;
+
+public class PrePostCheckActivity extends AppCompatActivity {
+
+    private RadioGroup rgWhen;
+    private RadioGroup rgResult;
+    private RatingBar ratingBar;
+    private EditText etNote;
+    private Button btnSubmit;
+    private RecyclerView rvCheckHistory;
+    private PrePostCheckAdapter adapter;
+    private SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+
+    private FirebaseAuth auth;
+    private FirebaseFirestore db;
+    private CollectionReference checkRef;
+    private FirebaseUser user;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_pre_post_check);
+
+        rgWhen = findViewById(R.id.rgWhen);
+        rgResult = findViewById(R.id.rgResult);
+        ratingBar = findViewById(R.id.ratingBar);
+        etNote = findViewById(R.id.etNote);
+        btnSubmit = findViewById(R.id.btnSubmitCheck);
+        rvCheckHistory = findViewById(R.id.rvCheckHistory);
+
+        auth = FirebaseAuth.getInstance();
+        db = FirebaseFirestore.getInstance();
+        user = auth.getCurrentUser();
+        if (user == null) {
+            Toast.makeText(this, "请先登录", Toast.LENGTH_SHORT).show();
+            finish();
+            return;
+        }
+
+        checkRef = db.collection("users")
+                .document(user.getUid())
+                .collection("prepost_checks");
+
+        // 初始化 RecyclerView
+        adapter = new PrePostCheckAdapter();
+        rvCheckHistory.setAdapter(adapter);
+        rvCheckHistory.setLayoutManager(new LinearLayoutManager(this));
+
+        // 读取历史记录
+        checkRef.orderBy("timestamp").limit(50).get()
+                .addOnSuccessListener(queryDocumentSnapshots -> adapter.setChecks(queryDocumentSnapshots.getDocuments()))
+                .addOnFailureListener(e -> Toast.makeText(this, "读取历史失败: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+
+        btnSubmit.setOnClickListener(view -> submitCheck());
+    }
+
+    private void submitCheck() {
+        int whenId = rgWhen.getCheckedRadioButtonId();
+        int resId = rgResult.getCheckedRadioButtonId();
+        if (whenId == -1 || resId == -1) {
+            Toast.makeText(this, "请选择 Before/After 和 Better/Same/Worse", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        String when = ((RadioButton) findViewById(whenId)).getText().toString();
+        String result = ((RadioButton) findViewById(resId)).getText().toString();
+        float rating = ratingBar.getRating();
+        String note = etNote.getText().toString();
+
+        String uid = user.getUid();
+        String email = user.getEmail();
+        long now = System.currentTimeMillis();
+
+        HashMap<String, Object> data = new HashMap<>();
+        data.put("uid", uid);
+        data.put("email", email);
+        data.put("when", when);
+        data.put("result", result);
+        data.put("rating", rating);
+        data.put("note", note);
+        data.put("timestamp", now);
+
+        btnSubmit.setEnabled(false);
+        checkRef.add(data).addOnSuccessListener(documentReference -> {
+            btnSubmit.setEnabled(true);
+            Toast.makeText(this, "评估已保存", Toast.LENGTH_SHORT).show();
+
+            // 自动检查徽章
+            checkAndUnlockBadge(uid);
+
+            // 将刚提交的数据直接插入 RecyclerView
+            documentReference.get().addOnSuccessListener(doc -> adapter.addCheck(doc));
+
+            ratingBar.setRating(0);
+            etNote.setText("");
+        }).addOnFailureListener(e -> {
+            btnSubmit.setEnabled(true);
+            Toast.makeText(this, "保存失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+        });
+    }
+
+    private void checkAndUnlockBadge(String uid) {
+        db.collection("users")
+                .document(uid)
+                .collection("prepost_checks")
+                .whereGreaterThanOrEqualTo("rating", 4)
+                .get()
+                .addOnSuccessListener(snap -> {
+                    if (snap.size() >= 5) {
+                        unlockBadge(uid);
+                    }
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "检查徽章失败: " + e.getMessage(), Toast.LENGTH_SHORT).show()
+                );
+    }
+
+    private void unlockBadge(String uid) {
+        db.collection("users")
+                .document(uid)
+                .collection("badges")
+                .document("badge_1")
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (doc.exists()) return; // 已经解锁过，不重复弹窗
+
+                    HashMap<String, Object> data = new HashMap<>();
+                    data.put("unlocked", true);
+                    data.put("timestamp", System.currentTimeMillis());
+                    data.put("description", "有 5 次呼吸评分都达到 4 分以上，说明你越来越懂得照顾自己了！");
+
+                    db.collection("users")
+                            .document(uid)
+                            .collection("badges")
+                            .document("badge_1")
+                            .set(data);
+
+                    showBadgePopup();
+                });
+    }
+
+    private void showBadgePopup() {
+        AlertDialog.Builder builder = new AlertDialog.Builder(this);
+        builder.setTitle("🎉 恭喜获得徽章！");
+        builder.setMessage("你已经连续获得 5 次高评分呼吸记录！");
+
+        builder.setPositiveButton("查看徽章", (dialog, which) -> {
+            Intent intent = new Intent(this, BadgeActivity.class);
+            intent.putExtra("newBadge", "badge_2");
+            startActivity(intent);
+        });
+
+        builder.setNegativeButton("关闭", null);
+        builder.show();
+    }
+}
Index: app/src/main/res/layout/activity_add_child.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_add_child.xml b/app/src/main/res/layout/activity_add_child.xml
new file mode 100644
--- /dev/null	(date 1763918002226)
+++ b/app/src/main/res/layout/activity_add_child.xml	(date 1763918002226)
@@ -0,0 +1,95 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp">
+
+    <!-- Username -->
+    <EditText
+        android:id="@+id/editChildUsername"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:hint="Child Username"
+        android:minHeight="48dp"
+        android:padding="12dp"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+    <!-- Password -->
+    <EditText
+        android:id="@+id/editChildPassword"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:hint="Child Password"
+        android:inputType="textPassword"
+        android:minHeight="48dp"
+        android:padding="12dp"
+        app:layout_constraintTop_toBottomOf="@id/editChildUsername"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+    <!-- Child Name -->
+    <EditText
+        android:id="@+id/editChildName"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:hint="Child Name"
+        android:minHeight="48dp"
+        android:padding="12dp"
+        android:layout_marginTop="16dp"
+        app:layout_constraintTop_toBottomOf="@id/editChildPassword"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+    <!-- DOB Label -->
+    <TextView
+        android:id="@+id/textDOB"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="Date of Birth: Not Set"
+        android:textSize="18sp"
+        android:paddingTop="12dp"
+        android:paddingBottom="12dp"
+        app:layout_constraintTop_toBottomOf="@id/editChildName"
+        app:layout_constraintStart_toStartOf="parent"/>
+
+    <!-- DOB Button -->
+    <Button
+        android:id="@+id/btnPickDate"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="Select Date"
+        android:layout_marginStart="16dp"
+        app:layout_constraintTop_toBottomOf="@id/editChildName"
+        app:layout_constraintStart_toEndOf="@id/textDOB"/>
+
+    <!-- Notes -->
+    <EditText
+        android:id="@+id/editChildNotes"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:hint="Notes"
+        android:minHeight="48dp"
+        android:padding="12dp"
+        android:layout_marginTop="16dp"
+        app:layout_constraintTop_toBottomOf="@id/btnPickDate"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+    <!-- Add Child Button -->
+    <Button
+        android:id="@+id/btnAddChild"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:text="Add Child"
+        android:minHeight="48dp"
+        android:padding="16dp"
+        android:layout_marginTop="24dp"
+        app:layout_constraintTop_toBottomOf="@id/editChildNotes"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
Index: app/src/main/res/layout/activity_enter_invite_code.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_enter_invite_code.xml b/app/src/main/res/layout/activity_enter_invite_code.xml
new file mode 100644
--- /dev/null	(date 1763918002228)
+++ b/app/src/main/res/layout/activity_enter_invite_code.xml	(date 1763918002228)
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical"
+    android:padding="24dp"
+    android:gravity="center_horizontal">
+
+    <TextView
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Enter Invite Code"
+        android:textSize="24sp"
+        android:textColor="#000"
+        android:textStyle="bold"
+        android:gravity="center"
+        android:paddingBottom="16dp" />
+
+    <EditText
+        android:id="@+id/editInviteCode"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:hint="6-digit code"
+        android:inputType="number"
+        android:padding="12dp"
+        android:background="@android:drawable/editbox_background"
+        android:textSize="18sp" />
+
+    <Button
+        android:id="@+id/btnRedeem"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Redeem Code"
+        android:textSize="18sp"
+        android:padding="16dp"
+        android:layout_marginTop="24dp" />
+
+</LinearLayout>
Index: app/src/main/res/layout/activity_choose_child_for_sharing.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_choose_child_for_sharing.xml b/app/src/main/res/layout/activity_choose_child_for_sharing.xml
new file mode 100644
--- /dev/null	(date 1763918002228)
+++ b/app/src/main/res/layout/activity_choose_child_for_sharing.xml	(date 1763918002228)
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical"
+    tools:context=".ChooseChildForSharingActivity">
+
+    <TextView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="Choose a Child"
+        android:textSize="24sp"
+        android:textStyle="bold"
+        android:padding="16dp"/>
+
+    <ProgressBar
+        android:id="@+id/loadingIndicator"
+        style="?android:attr/progressBarStyle"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:visibility="gone"
+        tools:visibility="visible"/>
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/recyclerChildren"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager"
+        tools:listitem="@layout/item_child" />
+
+</LinearLayout>
\ No newline at end of file
Index: app/src/main/res/layout/activity_sign_up.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_sign_up.xml b/app/src/main/res/layout/activity_sign_up.xml
new file mode 100644
--- /dev/null	(date 1763918002232)
+++ b/app/src/main/res/layout/activity_sign_up.xml	(date 1763918002232)
@@ -0,0 +1,62 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp">
+
+    <LinearLayout
+        android:orientation="vertical"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <EditText
+            android:id="@+id/etEmail"
+            android:hint="Email"
+            android:inputType="textEmailAddress"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <EditText
+            android:id="@+id/etPassword"
+            android:hint="Password"
+            android:inputType="textPassword"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"/>
+
+        <TextView
+            android:text="Select Role:"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"/>
+
+        <RadioGroup
+            android:id="@+id/rgRole"
+            android:orientation="vertical"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content">
+            <RadioButton
+                android:id="@+id/rbChild"
+                android:text="Child"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+            <RadioButton
+                android:id="@+id/rbParent"
+                android:text="Parent"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+            <RadioButton
+                android:id="@+id/rbProvider"
+                android:text="Provider"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+        </RadioGroup>
+
+        <Button
+            android:id="@+id/btnRegister"
+            android:text="Register"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="24dp"/>
+    </LinearLayout>
+</ScrollView>
Index: app/src/main/res/layout/activity_badge.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_badge.xml b/app/src/main/res/layout/activity_badge.xml
new file mode 100644
--- /dev/null	(date 1763918002226)
+++ b/app/src/main/res/layout/activity_badge.xml	(date 1763918002226)
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:orientation="vertical"
+    android:padding="16dp"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/rvBadges"
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_weight="1"/>
+
+    <TextView
+        android:id="@+id/tvMoreComing"
+        android:text="更多徽章即将推出，继续加油哦！"
+        android:textSize="16sp"
+        android:textAlignment="center"
+        android:paddingTop="16dp"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"/>
+
+</LinearLayout>
Index: app/src/main/res/layout/activity_homepage.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_homepage.xml b/app/src/main/res/layout/activity_homepage.xml
new file mode 100644
--- /dev/null	(date 1763918002228)
+++ b/app/src/main/res/layout/activity_homepage.xml	(date 1763918002228)
@@ -0,0 +1,74 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp"
+    android:background="#FFFFFF">
+
+    <LinearLayout
+        android:orientation="vertical"
+        android:gravity="center"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+
+
+        <!-- Existing Features -->
+        <Button
+            android:id="@+id/btnLogMedicine"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Log Medicine"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnTechnique"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Technique Helper"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnPrePostCheck"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Pre/Post Check"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+
+        <Button
+            android:id="@+id/btnBadges"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Badges"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnCheckPeakFlow"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Check Peak Flow"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnCheckSymptom"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Check Symptom"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+    </LinearLayout>
+
+</ScrollView>
Index: app/src/main/res/layout/activity_homepage_parents.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_homepage_parents.xml b/app/src/main/res/layout/activity_homepage_parents.xml
new file mode 100644
--- /dev/null	(date 1763918002228)
+++ b/app/src/main/res/layout/activity_homepage_parents.xml	(date 1763918002228)
@@ -0,0 +1,99 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp"
+    android:background="#FFFFFF">
+
+    <LinearLayout
+        android:orientation="vertical"
+        android:gravity="center"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <!-- 父母相关按钮 -->
+        <Button
+            android:id="@+id/btnAddChild"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Add Child"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnViewChildren"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="View Children"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnManageChild"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Manage Child Activity"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnManageSharing"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Manage Sharing"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnManagePB"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Manage PB"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <!-- 其他功能按钮（可选，如果想和父母主页共用）-->
+        <!--
+        <Button
+            android:id="@+id/btnLogMedicine"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Log Medicine"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnTechnique"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Technique Helper"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnPrePostCheck"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Pre/Post Check"
+            android:textSize="18sp"
+            android:layout_marginBottom="16dp"
+            android:padding="12dp" />
+
+        <Button
+            android:id="@+id/btnBadges"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Badges"
+            android:textSize="18sp"
+            android:padding="12dp" />
+        -->
+
+    </LinearLayout>
+</ScrollView>
Index: app/src/main/res/layout/activity_child_triage.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_child_triage.xml b/app/src/main/res/layout/activity_child_triage.xml
new file mode 100644
--- /dev/null	(date 1763918002226)
+++ b/app/src/main/res/layout/activity_child_triage.xml	(date 1763918002226)
@@ -0,0 +1,141 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fillViewport="true">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/triage_title"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_title"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <TextView
+            android:id="@+id/triage_intro_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_intro"
+            android:textSize="16sp"
+            android:layout_marginTop="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@id/triage_title" />
+
+        <TextView
+            android:id="@+id/triage_safety_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_safety_note"
+            android:textColor="?android:attr/textColorSecondary"
+            android:textSize="14sp"
+            android:layout_marginTop="12dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@id/triage_intro_text" />
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/questions_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            app:cardCornerRadius="12dp"
+            app:cardElevation="2dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@id/triage_safety_text">
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:padding="16dp">
+
+                <androidx.appcompat.widget.AppCompatCheckBox
+                    android:id="@+id/check_speech"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/triage_question_speech"
+                    android:textSize="16sp" />
+
+                <androidx.appcompat.widget.AppCompatCheckBox
+                    android:id="@+id/check_chest"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/triage_question_chest"
+                    android:textSize="16sp" />
+
+                <androidx.appcompat.widget.AppCompatCheckBox
+                    android:id="@+id/check_color"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/triage_question_color"
+                    android:textSize="16sp" />
+
+            </LinearLayout>
+
+        </com.google.android.material.card.MaterialCardView>
+
+        <com.google.android.material.button.MaterialButton
+            android:id="@+id/check_triage_button"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_check_next_steps"
+            android:textAllCaps="false"
+            android:layout_marginTop="16dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@id/questions_card" />
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/result_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:layout_marginBottom="32dp"
+            app:cardCornerRadius="12dp"
+            app:cardElevation="2dp"
+            app:layout_constraintBottom_toBottomOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@id/check_triage_button">
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:padding="16dp">
+
+                <TextView
+                    android:id="@+id/result_title"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/triage_no_flags_hint"
+                    android:textStyle="bold"
+                    android:textSize="18sp" />
+
+                <TextView
+                    android:id="@+id/result_message"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/triage_no_flags_hint"
+                    android:textSize="16sp"
+                    android:layout_marginTop="8dp" />
+
+            </LinearLayout>
+
+        </com.google.android.material.card.MaterialCardView>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</androidx.core.widget.NestedScrollView>
Index: app/src/main/res/layout/activity_homepage_providers.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_homepage_providers.xml b/app/src/main/res/layout/activity_homepage_providers.xml
new file mode 100644
--- /dev/null	(date 1763918002228)
+++ b/app/src/main/res/layout/activity_homepage_providers.xml	(date 1763918002228)
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/main"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".HomepageParentsActivity">
+
+    <TextView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="Homepage for providers"
+        android:textSize="25sp"
+        android:layout_gravity="center" />
+
+</LinearLayout>
\ No newline at end of file
Index: app/src/main/res/layout/item_pre_post_check.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_pre_post_check.xml b/app/src/main/res/layout/item_pre_post_check.xml
new file mode 100644
--- /dev/null	(date 1763918002235)
+++ b/app/src/main/res/layout/item_pre_post_check.xml	(date 1763918002235)
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:orientation="vertical"
+    android:padding="8dp"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="?android:attr/selectableItemBackground">
+
+    <TextView
+        android:id="@+id/tvWhenResult"
+        android:text="Before | Better"
+        android:textStyle="bold"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <TextView
+        android:id="@+id/tvRating"
+        android:text="Rating: 5"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <TextView
+        android:id="@+id/tvNote"
+        android:text="Note: ..."
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:visibility="gone"/>
+
+    <TextView
+        android:id="@+id/tvTimestamp"
+        android:text="2025-11-18 02:00:00"
+        android:textSize="12sp"
+        android:textColor="#888888"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+</LinearLayout>
Index: app/src/main/res/layout/activity_pre_post_check.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_pre_post_check.xml b/app/src/main/res/layout/activity_pre_post_check.xml
new file mode 100644
--- /dev/null	(date 1763918002232)
+++ b/app/src/main/res/layout/activity_pre_post_check.xml	(date 1763918002232)
@@ -0,0 +1,64 @@
+<?xml version="1.0" encoding="utf-8"?>
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:orientation="vertical"
+    android:padding="12dp"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <TextView android:text="When?" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+    <RadioGroup
+        android:id="@+id/rgWhen"
+        android:orientation="horizontal"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <RadioButton android:id="@+id/rbBefore" android:text="Before" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+        <RadioButton android:id="@+id/rbAfter" android:text="After" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+    </RadioGroup>
+
+    <TextView android:text="Result?" android:layout_marginTop="8dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+    <RadioGroup
+        android:id="@+id/rgResult"
+        android:orientation="horizontal"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <RadioButton android:id="@+id/rbBetter" android:text="Better" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+        <RadioButton android:id="@+id/rbSame" android:text="Same" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+        <RadioButton android:id="@+id/rbWorse" android:text="Worse" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+    </RadioGroup>
+
+    <TextView android:text="Breath rating (0-5):" android:layout_marginTop="8dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
+    <RatingBar
+        android:id="@+id/ratingBar"
+        android:numStars="5"
+        android:stepSize="1.0"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <EditText
+        android:id="@+id/etNote"
+        android:hint="Short note (optional)"
+        android:layout_marginTop="8dp"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"/>
+
+    <Button
+        android:id="@+id/btnSubmitCheck"
+        android:layout_marginTop="12dp"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="Submit" />
+
+    <TextView
+        android:text="History"
+        android:layout_marginTop="16dp"
+        android:textStyle="bold"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/rvCheckHistory"
+        android:layout_marginTop="8dp"
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_weight="1"/>
+</LinearLayout>
Index: app/src/main/res/layout/activity_manage_child.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_manage_child.xml b/app/src/main/res/layout/activity_manage_child.xml
new file mode 100644
--- /dev/null	(date 1763918002230)
+++ b/app/src/main/res/layout/activity_manage_child.xml	(date 1763918002230)
@@ -0,0 +1,105 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:padding="24dp">
+
+    <LinearLayout
+        android:orientation="vertical"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <!-- Username -->
+        <EditText
+            android:id="@+id/editChildUsername"
+            android:hint="Child Username"
+            android:minHeight="48dp"
+            android:padding="12dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <!-- Password -->
+        <EditText
+            android:id="@+id/editChildPassword"
+            android:hint="Child Password"
+            android:inputType="textPassword"
+            android:minHeight="48dp"
+            android:padding="12dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <!-- Name -->
+        <EditText
+            android:id="@+id/editChildName"
+            android:hint="Child Name"
+            android:minHeight="48dp"
+            android:padding="12dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <!-- DOB -->
+        <EditText
+            android:id="@+id/editChildDOB"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:hint="Date of Birth"
+            android:padding="12dp"
+            android:minHeight="48dp"
+            android:focusable="false"
+            android:clickable="true"
+            android:inputType="none" />
+
+        <!-- Notes -->
+        <EditText
+            android:id="@+id/editChildNotes"
+            android:hint="Notes"
+            android:minHeight="48dp"
+            android:padding="12dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <!-- Save -->
+        <Button
+            android:id="@+id/btnSave"
+            android:text="Save Changes"
+            android:minHeight="48dp"
+            android:padding="16dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content" />
+
+        <Button
+            android:id="@+id/btnInviteProvider"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Generate Provider Invite"
+            android:backgroundTint="#673AB7"
+            android:textColor="#FFFFFF"
+            android:layout_marginTop="8dp"
+            style="?android:attr/buttonStyleSmall"/>
+
+        <!-- Delete -->
+        <com.google.android.material.button.MaterialButton
+            android:id="@+id/btnDelete"
+            android:text="Delete Child"
+            android:minHeight="48dp"
+            android:padding="16dp"
+            android:layout_marginTop="12dp"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            app:backgroundTint="#B00020"
+            app:cornerRadius="8dp"
+            android:textColor="@android:color/white" />
+
+        <Button
+            android:id="@+id/btnManageSharing"
+            android:text="Manage Sharing Settings"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp" />
+
+
+
+    </LinearLayout>
+
+</ScrollView>
Index: app/src/main/res/layout/view_children_activity.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/view_children_activity.xml b/app/src/main/res/layout/view_children_activity.xml
new file mode 100644
--- /dev/null	(date 1763918002236)
+++ b/app/src/main/res/layout/view_children_activity.xml	(date 1763918002236)
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".ViewChildrenActivity">
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/recyclerChildren"
+        android:layout_width="0dp"
+        android:layout_height="0dp"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent" />
+
+</androidx.constraintlayout.widget.ConstraintLayout>
Index: app/src/main/res/layout/dialog_set_personal_best.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/dialog_set_personal_best.xml b/app/src/main/res/layout/dialog_set_personal_best.xml
new file mode 100644
--- /dev/null	(date 1763918002233)
+++ b/app/src/main/res/layout/dialog_set_personal_best.xml	(date 1763918002233)
@@ -0,0 +1,63 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:padding="24dp">
+
+    <TextView
+        android:id="@+id/child_name_text"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:text="Set Personal Best for Child"
+        android:textSize="18sp"
+        android:textStyle="bold"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <TextView
+        android:id="@+id/current_pb_text"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:text="Current PB: Not Set"
+        android:textSize="14sp"
+        android:textColor="?android:attr/textColorSecondary"
+        android:layout_marginTop="8dp"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@+id/child_name_text" />
+
+    <com.google.android.material.textfield.TextInputLayout
+        android:id="@+id/pb_input_layout"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="24dp"
+        android:hint="Personal Best (L/min)"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@+id/current_pb_text">
+
+        <EditText
+            android:id="@+id/pb_input"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:inputType="number"
+            android:maxLines="1" />
+
+    </com.google.android.material.textfield.TextInputLayout>
+
+    <TextView
+        android:id="@+id/help_text"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="16dp"
+        android:text="Personal Best is the highest healthy Peak Expiratory Flow (PEF) value. This is used to calculate Green, Yellow, and Red zones for your child."
+        android:textSize="12sp"
+        android:textColor="?android:attr/textColorSecondary"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@+id/pb_input_layout" />
+
+</androidx.constraintlayout.widget.ConstraintLayout>
+
Index: app/src/main/res/layout/badge_item.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/badge_item.xml b/app/src/main/res/layout/badge_item.xml
new file mode 100644
--- /dev/null	(date 1763918002233)
+++ b/app/src/main/res/layout/badge_item.xml	(date 1763918002233)
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/cardBadge"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_marginBottom="12dp"
+    android:padding="12dp"
+    android:elevation="4dp">
+
+    <LinearLayout
+        android:orientation="horizontal"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <ImageView
+            android:id="@+id/ivBadge"
+            android:layout_width="64dp"
+            android:layout_height="64dp"
+            android:layout_marginRight="12dp"
+            android:contentDescription="badge"/>
+
+        <LinearLayout
+            android:orientation="vertical"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content">
+
+            <TextView
+                android:id="@+id/tvBadgeTitle"
+                android:textSize="18sp"
+                android:textStyle="bold"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+
+            <TextView
+                android:id="@+id/tvAchieved"
+                android:textSize="14sp"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+
+            <TextView
+                android:id="@+id/tvFirstTime"
+                android:textSize="14sp"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"/>
+
+            <TextView
+                android:id="@+id/tvDescription"
+                android:textSize="14sp"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:paddingTop="4dp"/>
+        </LinearLayout>
+
+    </LinearLayout>
+
+</androidx.cardview.widget.CardView>
Index: app/src/main/res/layout/activity_child_pef.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_child_pef.xml b/app/src/main/res/layout/activity_child_pef.xml
new file mode 100644
--- /dev/null	(date 1763918002226)
+++ b/app/src/main/res/layout/activity_child_pef.xml	(date 1763918002226)
@@ -0,0 +1,344 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fillViewport="true"
+    tools:context=".ui.child.ChildPEFActivity">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/title_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/child_pef_title"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            android:layout_marginBottom="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <TextView
+            android:id="@+id/subtitle_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/child_pef_subtitle"
+            android:textSize="14sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:layout_marginBottom="24dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/title_text" />
+
+        <com.google.android.material.button.MaterialButton
+            android:id="@+id/triage_button"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_button_text"
+            android:textAllCaps="false"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/subtitle_text" />
+
+        <TextView
+            android:id="@+id/triage_safety_note"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/triage_safety_note"
+            android:textColor="?android:attr/textColorSecondary"
+            android:textSize="14sp"
+            android:layout_marginTop="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/triage_button" />
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/personal_best_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginBottom="16dp"
+            app:cardCornerRadius="12dp"
+            app:cardElevation="3dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/triage_safety_note">
+
+            <androidx.constraintlayout.widget.ConstraintLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:padding="16dp">
+
+                <TextView
+                    android:id="@+id/personal_best_label"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="@string/personal_best_title"
+                    android:textSize="18sp"
+                    android:textStyle="bold"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toTopOf="parent" />
+
+                <TextView
+                    android:id="@+id/personal_best_value"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="@string/personal_best_status_missing"
+                    android:textSize="16sp"
+                    android:textColor="?android:attr/textColorPrimary"
+                    android:layout_marginTop="12dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@id/personal_best_label" />
+
+                <TextView
+                    android:id="@+id/personal_best_status_text"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="@string/personal_best_description"
+                    android:textColor="?android:attr/textColorSecondary"
+                    android:textSize="14sp"
+                    android:layout_marginTop="4dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@id/personal_best_value" />
+
+            </androidx.constraintlayout.widget.ConstraintLayout>
+
+        </com.google.android.material.card.MaterialCardView>
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/zone_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginBottom="16dp"
+            app:cardCornerRadius="12dp"
+            app:cardElevation="3dp"
+            app:cardBackgroundColor="@color/zone_neutral_bg"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/personal_best_card">
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:padding="16dp">
+
+                <TextView
+                    android:id="@+id/zone_card_title"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/zone_card_title"
+                    android:textSize="18sp"
+                    android:textStyle="bold" />
+
+                <LinearLayout
+                    android:id="@+id/zone_content_group"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:orientation="vertical"
+                    android:visibility="gone"
+                    android:layout_marginTop="8dp"
+                    tools:visibility="visible">
+
+                    <TextView
+                        android:id="@+id/zone_state_text"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:text="@string/zone_label_unknown"
+                        android:textSize="22sp"
+                        android:textStyle="bold"
+                        tools:text="@string/zone_label_green" />
+
+                    <TextView
+                        android:id="@+id/zone_percent_text"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:text=""
+                        android:textSize="16sp"
+                        android:layout_marginTop="2dp"
+                        tools:text="82% of PB" />
+
+                    <TextView
+                        android:id="@+id/zone_guidance_text"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:text="@string/zone_unknown_guidance"
+                        android:textSize="16sp"
+                        android:layout_marginTop="8dp" />
+
+                    <TextView
+                        android:id="@+id/zone_source_text"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:text="@string/zone_based_on_latest_entry"
+                        android:textSize="14sp"
+                        android:textColor="?android:attr/textColorSecondary"
+                        android:layout_marginTop="4dp" />
+
+                </LinearLayout>
+
+                <TextView
+                    android:id="@+id/zone_empty_text"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:text="@string/zone_missing_pb"
+                    android:textSize="16sp"
+                    android:layout_marginTop="8dp" />
+
+            </LinearLayout>
+
+        </com.google.android.material.card.MaterialCardView>
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/input_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginBottom="24dp"
+            app:cardCornerRadius="8dp"
+            app:cardElevation="4dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/zone_card">
+
+            <androidx.constraintlayout.widget.ConstraintLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:padding="16dp">
+
+                <com.google.android.material.textfield.TextInputLayout
+                    android:id="@+id/pef_input_layout"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:hint="@string/pef_input_hint"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toTopOf="parent">
+
+                    <EditText
+                        android:id="@+id/pef_input"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:inputType="number"
+                        android:maxLines="1" />
+
+                </com.google.android.material.textfield.TextInputLayout>
+
+                <TextView
+                    android:id="@+id/pef_warning_text"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text=""
+                    android:textSize="14sp"
+                    android:visibility="gone"
+                    android:layout_marginTop="8dp"
+                    android:drawablePadding="8dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@+id/pef_input_layout" />
+
+                <TextView
+                    android:id="@+id/medicine_tag_label"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="@string/medicine_tag_label"
+                    android:textSize="16sp"
+                    android:textStyle="bold"
+                    android:layout_marginTop="16dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@+id/pef_warning_text" />
+
+                <RadioGroup
+                    android:id="@+id/medicine_tag_group"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:orientation="vertical"
+                    android:layout_marginTop="8dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@+id/medicine_tag_label">
+
+                    <RadioButton
+                        android:id="@+id/pre_medicine_radio"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/radio_pre_medicine"
+                        android:textSize="14sp" />
+
+                    <RadioButton
+                        android:id="@+id/post_medicine_radio"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/radio_post_medicine"
+                        android:textSize="14sp" />
+
+                    <RadioButton
+                        android:id="@+id/none_radio"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="@string/radio_none"
+                        android:textSize="14sp"
+                        android:checked="true" />
+
+                </RadioGroup>
+
+                <com.google.android.material.button.MaterialButton
+                    android:id="@+id/save_pef_button"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="@string/save_pef_entry"
+                    android:layout_marginTop="16dp"
+                    app:layout_constraintEnd_toEndOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintTop_toBottomOf="@+id/medicine_tag_group" />
+
+            </androidx.constraintlayout.widget.ConstraintLayout>
+
+        </com.google.android.material.card.MaterialCardView>
+
+        <TextView
+            android:id="@+id/history_title"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/recent_entries_title"
+            android:textSize="20sp"
+            android:textStyle="bold"
+            android:layout_marginBottom="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/input_card" />
+
+        <androidx.recyclerview.widget.RecyclerView
+            android:id="@+id/pef_history_recycler_view"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:nestedScrollingEnabled="false"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/history_title" />
+
+        <TextView
+            android:id="@+id/empty_state_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="@string/empty_history_message"
+            android:textAlignment="center"
+            android:textSize="16sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:visibility="gone"
+            android:layout_marginTop="16dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/history_title" />
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</androidx.core.widget.NestedScrollView>
Index: app/src/main/res/layout/fragment_step.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_step.xml b/app/src/main/res/layout/fragment_step.xml
new file mode 100644
--- /dev/null	(date 1763918002233)
+++ b/app/src/main/res/layout/fragment_step.xml	(date 1763918002233)
@@ -0,0 +1,49 @@
+<?xml version="1.0" encoding="utf-8"?>
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:card_view="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="20dp">
+
+    <androidx.cardview.widget.CardView
+        android:id="@+id/card"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        card_view:cardCornerRadius="16dp"
+        card_view:cardElevation="8dp"
+        android:layout_gravity="center"
+        android:padding="14dp"
+        android:backgroundTint="@color/card_bg">
+
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            android:gravity="center_horizontal">
+
+            <ImageView
+                android:id="@+id/stepImage"
+                android:layout_width="match_parent"
+                android:layout_height="0dp"
+                android:adjustViewBounds="true"
+                android:scaleType="centerCrop"
+                android:layout_weight="1"
+                android:contentDescription="@string/step_image_desc"/>
+
+            <TextView
+                android:id="@+id/stepText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_marginTop="12dp"
+                android:layout_marginBottom="8dp"
+                android:textSize="18sp"
+                android:lineSpacingExtra="4dp"
+                android:textColor="@color/text_primary"
+                android:gravity="center"/>
+
+        </LinearLayout>
+
+    </androidx.cardview.widget.CardView>
+
+</FrameLayout>
Index: app/src/main/res/layout/activity_invite_provider.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_invite_provider.xml b/app/src/main/res/layout/activity_invite_provider.xml
new file mode 100644
--- /dev/null	(date 1763918002229)
+++ b/app/src/main/res/layout/activity_invite_provider.xml	(date 1763918002229)
@@ -0,0 +1,90 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="24dp"
+    android:background="@android:color/white">
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical">
+
+        <TextView
+            android:id="@+id/titleInvite"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Invite Provider"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            android:paddingBottom="8dp"
+            android:textColor="#000000" />
+
+        <TextView
+            android:id="@+id/textStatusLabel"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Status: No Active Invite"
+            android:textSize="16sp"
+            android:textColor="#212121"
+            android:background="#EEE"
+            android:padding="12dp"
+            android:layout_marginBottom="32dp"/>
+
+        <TextView
+            android:id="@+id/textDescription"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Generate a secure, one-time invite code your provider can use to link to this child's profile. The code expires in 7 days and can be reused only once."
+            android:textSize="16sp"
+            android:textColor="#444444"
+            android:paddingBottom="24dp" />
+
+        <Button
+            android:id="@+id/btnGenerateCode"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Generate Invite Code"
+            android:textAllCaps="false"
+            android:padding="16dp"
+            android:textSize="18sp" />
+        <Button
+            android:id="@+id/btnRevoke"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Revoke Active Code"
+            android:textColor="#FFFFFF"
+            android:backgroundTint="#D32F2F"
+            android:visibility="gone"
+            android:layout_marginTop="16dp"/>
+
+        <View
+            android:layout_width="match_parent"
+            android:layout_height="32dp" />
+
+        <TextView
+            android:id="@+id/textInviteCode"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text=""
+            android:textAlignment="center"
+            android:textColor="#222222"
+            android:textSize="28sp"
+            android:textStyle="bold"
+            android:visibility="gone"
+            android:paddingTop="12dp"
+            android:paddingBottom="12dp" />
+
+        <TextView
+            android:id="@+id/textHint"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Share this code with your provider. They must enter it in their Provider App."
+            android:textSize="14sp"
+            android:textColor="#666666"
+            android:paddingTop="4dp"
+            android:visibility="gone" />
+
+    </LinearLayout>
+
+</ScrollView>
Index: build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>// Top-level build file where you can add configuration options common to all sub-projects/modules.\r\nplugins {\r\n    alias(libs.plugins.android.application) apply false\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/build.gradle.kts b/build.gradle.kts
--- a/build.gradle.kts	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/build.gradle.kts	(date 1763918002237)
@@ -1,4 +1,5 @@
 // Top-level build file where you can add configuration options common to all sub-projects/modules.
 plugins {
     alias(libs.plugins.android.application) apply false
+    id("com.google.gms.google-services") version "4.4.4" apply false
 }
\ No newline at end of file
Index: app/src/main/res/layout/item_medicine_log.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_medicine_log.xml b/app/src/main/res/layout/item_medicine_log.xml
new file mode 100644
--- /dev/null	(date 1763918002235)
+++ b/app/src/main/res/layout/item_medicine_log.xml	(date 1763918002235)
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="utf-8"?>
+<com.google.android.material.card.MaterialCardView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_margin="8dp"
+    app:cardCornerRadius="8dp"
+    app:cardElevation="2dp">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/type_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Rescue"
+            android:textSize="16sp"
+            android:textStyle="bold"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent"/>
+
+        <TextView
+            android:id="@+id/dose_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Dose: 2 puffs"
+            android:textSize="14sp"
+            android:layout_marginStart="16dp"
+            app:layout_constraintStart_toEndOf="@id/type_text"
+            app:layout_constraintTop_toTopOf="parent"/>
+
+        <TextView
+            android:id="@+id/timestamp_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="2025-11-18 14:00"
+            android:textSize="12sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:layout_marginTop="8dp"
+            app:layout_constraintTop_toBottomOf="@id/type_text"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+</com.google.android.material.card.MaterialCardView>
Index: app/src/main/res/layout/item_pef_entry.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_pef_entry.xml b/app/src/main/res/layout/item_pef_entry.xml
new file mode 100644
--- /dev/null	(date 1763918002235)
+++ b/app/src/main/res/layout/item_pef_entry.xml	(date 1763918002235)
@@ -0,0 +1,64 @@
+<?xml version="1.0" encoding="utf-8"?>
+<com.google.android.material.card.MaterialCardView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_margin="8dp"
+    app:cardCornerRadius="8dp"
+    app:cardElevation="2dp">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/pef_value_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="300 L/min"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            android:textColor="?android:attr/colorPrimary"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <TextView
+            android:id="@+id/medicine_tag_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Before Medicine"
+            android:textSize="14sp"
+            android:textStyle="bold"
+            android:layout_marginStart="16dp"
+            android:layout_marginTop="4dp"
+            app:layout_constraintStart_toEndOf="@+id/pef_value_text"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <TextView
+            android:id="@+id/comparison_text"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Before medicine"
+            android:textSize="12sp"
+            android:layout_marginStart="16dp"
+            android:layout_marginTop="2dp"
+            app:layout_constraintStart_toEndOf="@+id/pef_value_text"
+            app:layout_constraintTop_toBottomOf="@+id/medicine_tag_text" />
+
+        <TextView
+            android:id="@+id/timestamp_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="Jan 01, 2024 at 12:00 PM"
+            android:textSize="12sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:layout_marginTop="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/pef_value_text" />
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</com.google.android.material.card.MaterialCardView>
+
Index: .idea/markdown.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/markdown.xml b/.idea/markdown.xml
new file mode 100644
--- /dev/null	(date 1763918002051)
+++ b/.idea/markdown.xml	(date 1763918002051)
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="MarkdownSettings">
+    <option name="previewPanelProviderInfo">
+      <ProviderInfo name="Compose (experimental)" className="com.intellij.markdown.compose.preview.ComposePanelProvider" />
+    </option>
+  </component>
+</project>
\ No newline at end of file
Index: app/src/main/res/layout/activity_log_medicine.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_log_medicine.xml b/app/src/main/res/layout/activity_log_medicine.xml
new file mode 100644
--- /dev/null	(date 1763918002229)
+++ b/app/src/main/res/layout/activity_log_medicine.xml	(date 1763918002229)
@@ -0,0 +1,164 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fillViewport="true"
+    tools:context=".LogMedicineActivity">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/title_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="Log Medicine Intake"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            app:layout_constraintTop_toTopOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <TextView
+            android:id="@+id/subtitle_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="Track medicine usage and dosage"
+            android:textSize="14sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:layout_marginBottom="24dp"
+            app:layout_constraintTop_toBottomOf="@id/title_text"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <com.google.android.material.card.MaterialCardView
+            android:id="@+id/input_card"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            app:cardCornerRadius="8dp"
+            app:cardElevation="4dp"
+            app:layout_constraintTop_toBottomOf="@id/subtitle_text"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent">
+
+            <androidx.constraintlayout.widget.ConstraintLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:padding="16dp">
+
+                <TextView
+                    android:id="@+id/type_label"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="Select Type:"
+                    android:textSize="16sp"
+                    android:textStyle="bold"
+                    app:layout_constraintTop_toTopOf="parent"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintEnd_toEndOf="parent"/>
+
+                <RadioGroup
+                    android:id="@+id/rgType"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:orientation="horizontal"
+                    android:layout_marginTop="8dp"
+                    app:layout_constraintTop_toBottomOf="@id/type_label"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintEnd_toEndOf="parent">
+
+                    <RadioButton
+                        android:id="@+id/rbRescue"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="Rescue"/>
+                    <RadioButton
+                        android:id="@+id/rbController"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content"
+                        android:text="Controller"/>
+                </RadioGroup>
+
+                <TextView
+                    android:id="@+id/dose_label"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="Dose (puffs):"
+                    android:textSize="16sp"
+                    android:textStyle="bold"
+                    android:layout_marginTop="16dp"
+                    app:layout_constraintTop_toBottomOf="@id/rgType"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintEnd_toEndOf="parent"/>
+
+                <com.google.android.material.textfield.TextInputLayout
+                    android:id="@+id/dose_input_layout"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:layout_marginTop="8dp"
+                    app:layout_constraintTop_toBottomOf="@id/dose_label"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintEnd_toEndOf="parent">
+
+                    <com.google.android.material.textfield.TextInputEditText
+                        android:id="@+id/etDose"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:inputType="number"/>
+                </com.google.android.material.textfield.TextInputLayout>
+
+                <com.google.android.material.button.MaterialButton
+                    android:id="@+id/btnSubmitLog"
+                    android:layout_width="0dp"
+                    android:layout_height="wrap_content"
+                    android:text="Submit"
+                    android:layout_marginTop="16dp"
+                    app:layout_constraintTop_toBottomOf="@id/dose_input_layout"
+                    app:layout_constraintStart_toStartOf="parent"
+                    app:layout_constraintEnd_toEndOf="parent"/>
+
+            </androidx.constraintlayout.widget.ConstraintLayout>
+        </com.google.android.material.card.MaterialCardView>
+
+        <TextView
+            android:id="@+id/history_title"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="History"
+            android:textSize="20sp"
+            android:textStyle="bold"
+            android:layout_marginTop="24dp"
+            app:layout_constraintTop_toBottomOf="@id/input_card"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <androidx.recyclerview.widget.RecyclerView
+            android:id="@+id/rvLogHistory"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:nestedScrollingEnabled="false"
+            android:layout_marginTop="8dp"
+            app:layout_constraintTop_toBottomOf="@id/history_title"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <TextView
+            android:id="@+id/empty_state_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="No logs yet. Enter your first medicine log above."
+            android:textAlignment="center"
+            android:textColor="?android:attr/textColorSecondary"
+            android:layout_marginTop="16dp"
+            android:visibility="gone"
+            app:layout_constraintTop_toBottomOf="@id/history_title"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</androidx.core.widget.NestedScrollView>
Index: app/src/main/res/layout/activity_login.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_login.xml b/app/src/main/res/layout/activity_login.xml
new file mode 100644
--- /dev/null	(date 1763918002229)
+++ b/app/src/main/res/layout/activity_login.xml	(date 1763918002229)
@@ -0,0 +1,118 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:fillViewport="true"
+    android:background="@android:color/white">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="24dp">
+
+        <TextView
+            android:id="@+id/appTitleTextView"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="SmartAir"
+            android:textSize="32sp"
+            android:textStyle="bold"
+            android:textColor="@android:color/black"
+            android:layout_marginTop="48dp"
+            app:layout_constraintTop_toTopOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent" />
+
+        <TextView
+            android:id="@+id/subtitleTextView"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:text="Asthma Management for Families"
+            android:textSize="14sp"
+            android:textColor="@android:color/darker_gray"
+            android:layout_marginTop="8dp"
+            app:layout_constraintTop_toBottomOf="@id/appTitleTextView"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent" />
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/emailInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="48dp"
+            android:hint="Email"
+            app:layout_constraintTop_toBottomOf="@id/subtitleTextView">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/emailEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textEmailAddress"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/passwordInputLayout"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:hint="Password"
+            app:passwordToggleEnabled="true"
+            app:layout_constraintTop_toBottomOf="@id/emailInputLayout">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/passwordEditText"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:inputType="textPassword"
+                android:maxLines="1" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <Button
+            android:id="@+id/loginButton"
+            android:layout_width="match_parent"
+            android:layout_height="56dp"
+            android:text="Login"
+            android:textSize="16sp"
+            android:layout_marginTop="24dp"
+            app:layout_constraintTop_toBottomOf="@id/passwordInputLayout" />
+
+        <ProgressBar
+            android:id="@+id/progressBar"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:visibility="gone"
+            app:layout_constraintTop_toBottomOf="@id/loginButton"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            android:layout_marginTop="16dp" />
+
+        <LinearLayout
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:orientation="horizontal"
+            android:layout_marginTop="24dp"
+            app:layout_constraintTop_toBottomOf="@id/progressBar"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent">
+
+            <TextView
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Don't have an account? "
+                android:textColor="@android:color/darker_gray" />
+
+            <TextView
+                android:id="@+id/registerTextView"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Register"
+                android:textColor="?attr/colorPrimary"
+                android:textStyle="bold"
+                android:clickable="true"
+                android:focusable="true" />
+        </LinearLayout>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+</ScrollView>
\ No newline at end of file
Index: app/src/main/res/layout/activity_technique.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_technique.xml b/app/src/main/res/layout/activity_technique.xml
new file mode 100644
--- /dev/null	(date 1763918002233)
+++ b/app/src/main/res/layout/activity_technique.xml	(date 1763918002233)
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:id="@+id/root"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@color/bg_soft"
+    tools:context=".TechniqueActivity">
+
+    <androidx.viewpager2.widget.ViewPager2
+        android:id="@+id/viewPager"
+        android:layout_width="0dp"
+        android:layout_height="0dp"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
Index: app/src/main/res/layout/activity_parent_home.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_parent_home.xml b/app/src/main/res/layout/activity_parent_home.xml
new file mode 100644
--- /dev/null	(date 1763918002231)
+++ b/app/src/main/res/layout/activity_parent_home.xml	(date 1763918002231)
@@ -0,0 +1,53 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".ui.parent.ParentHomeActivity">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/title_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="My Children"
+            android:textSize="24sp"
+            android:textStyle="bold"
+            android:layout_marginBottom="8dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <LinearLayout
+            android:id="@+id/children_container"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            android:layout_marginTop="16dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/title_text" />
+
+        <TextView
+            android:id="@+id/empty_state_text"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="No children added yet."
+            android:textAlignment="center"
+            android:textSize="16sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:visibility="gone"
+            android:layout_marginTop="32dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/title_text" />
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</androidx.core.widget.NestedScrollView>
+
Index: app/src/main/res/layout/item_child_pb.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/item_child_pb.xml b/app/src/main/res/layout/item_child_pb.xml
new file mode 100644
--- /dev/null	(date 1763918002234)
+++ b/app/src/main/res/layout/item_child_pb.xml	(date 1763918002234)
@@ -0,0 +1,62 @@
+<?xml version="1.0" encoding="utf-8"?>
+<com.google.android.material.card.MaterialCardView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_margin="8dp"
+    app:cardCornerRadius="8dp"
+    app:cardElevation="4dp">
+
+    <androidx.constraintlayout.widget.ConstraintLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:padding="16dp">
+
+        <TextView
+            android:id="@+id/child_name"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="Child Name"
+            android:textSize="20sp"
+            android:textStyle="bold"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toTopOf="parent" />
+
+        <TextView
+            android:id="@+id/child_pb"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="8dp"
+            android:text="Personal Best: Not Set"
+            android:textSize="16sp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/child_name" />
+
+        <TextView
+            android:id="@+id/zone_info"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="4dp"
+            android:text="Zone thresholds will appear here"
+            android:textSize="14sp"
+            android:textColor="?android:attr/textColorSecondary"
+            android:visibility="gone"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/child_pb" />
+
+        <com.google.android.material.button.MaterialButton
+            android:id="@+id/set_pb_button"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:text="Set/Update Personal Best"
+            android:layout_marginTop="16dp"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintTop_toBottomOf="@+id/zone_info" />
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+
+</com.google.android.material.card.MaterialCardView>
\ No newline at end of file
Index: .idea/deploymentTargetSelector.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
--- a/.idea/deploymentTargetSelector.xml	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/.idea/deploymentTargetSelector.xml	(date 1763919351698)
@@ -4,6 +4,22 @@
     <selectionStates>
       <SelectionState runConfigName="app">
         <option name="selectionMode" value="DROPDOWN" />
+        <DropdownSelection timestamp="2025-11-23T17:31:18.980406200Z">
+          <Target type="DEFAULT_BOOT">
+            <handle>
+              <DeviceId pluginId="LocalEmulator" identifier="path=C:\Users\nabil\.android\avd\Pixel_7.avd" />
+            </handle>
+          </Target>
+        </DropdownSelection>
+        <DialogSelection>
+          <targets>
+            <Target type="DEFAULT_BOOT">
+              <handle>
+                <DeviceId pluginId="LocalEmulator" identifier="path=C:\Users\HP\.android\avd\Medium_Phone.avd" />
+              </handle>
+            </Target>
+          </targets>
+        </DialogSelection>
       </SelectionState>
     </selectionStates>
   </component>
Index: app/.gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/build
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.gitignore b/app/.gitignore
--- a/app/.gitignore	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/.gitignore	(date 1763918002055)
@@ -1,1 +1,2 @@
-/build
\ No newline at end of file
+/build
+google-services.json
Index: app/build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>plugins {\r\n    alias(libs.plugins.android.application)\r\n}\r\n\r\nandroid {\r\n    namespace = \"com.example.smartair\"\r\n    compileSdk {\r\n        version = release(36)\r\n    }\r\n\r\n    defaultConfig {\r\n        applicationId = \"com.example.smartair\"\r\n        minSdk = 24\r\n        targetSdk = 36\r\n        versionCode = 1\r\n        versionName = \"1.0\"\r\n\r\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\r\n                \"proguard-rules.pro\"\r\n            )\r\n        }\r\n    }\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_11\r\n        targetCompatibility = JavaVersion.VERSION_11\r\n    }\r\n}\r\n\r\ndependencies {\r\n    implementation(libs.appcompat)\r\n    implementation(libs.material)\r\n    implementation(libs.activity)\r\n    implementation(libs.constraintlayout)\r\n    testImplementation(libs.junit)\r\n    androidTestImplementation(libs.ext.junit)\r\n    androidTestImplementation(libs.espresso.core)\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/build.gradle.kts b/app/build.gradle.kts
--- a/app/build.gradle.kts	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/build.gradle.kts	(date 1763918002058)
@@ -1,12 +1,10 @@
 plugins {
-    alias(libs.plugins.android.application)
+    id("com.android.application")
+    id("com.google.gms.google-services")
 }
-
 android {
     namespace = "com.example.smartair"
-    compileSdk {
-        version = release(36)
-    }
+    compileSdk = 36
 
     defaultConfig {
         applicationId = "com.example.smartair"
@@ -27,6 +25,7 @@
             )
         }
     }
+
     compileOptions {
         sourceCompatibility = JavaVersion.VERSION_11
         targetCompatibility = JavaVersion.VERSION_11
@@ -34,11 +33,24 @@
 }
 
 dependencies {
-    implementation(libs.appcompat)
-    implementation(libs.material)
-    implementation(libs.activity)
-    implementation(libs.constraintlayout)
-    testImplementation(libs.junit)
-    androidTestImplementation(libs.ext.junit)
-    androidTestImplementation(libs.espresso.core)
-}
\ No newline at end of file
+    // ---- Firebase ----
+    implementation(platform("com.google.firebase:firebase-bom:34.5.0"))
+    implementation("com.google.firebase:firebase-analytics")
+    implementation("com.google.firebase:firebase-auth")
+    implementation("com.google.firebase:firebase-firestore")
+
+    // ---- AndroidX ----
+    implementation("androidx.appcompat:appcompat:1.7.0")
+    implementation("com.google.android.material:material:1.12.0")
+    implementation("androidx.constraintlayout:constraintlayout:2.1.4")
+    implementation("androidx.activity:activity:1.8.0")
+    implementation("androidx.fragment:fragment-ktx:1.6.2")
+    implementation("androidx.viewpager2:viewpager2:1.1.0")
+    implementation("androidx.cardview:cardview:1.0.0")
+    implementation("androidx.recyclerview:recyclerview:1.3.2")
+
+    // ---- Tests ----
+    testImplementation("junit:junit:4.13.2")
+    androidTestImplementation("androidx.test.ext:junit:1.1.5")
+    androidTestImplementation("androidx.test.espresso:espresso-core:3.5.1")
+}
Index: gradle/libs.versions.toml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>[versions]\r\nagp = \"8.13.0\"\r\njunit = \"4.13.2\"\r\njunitVersion = \"1.1.5\"\r\nespressoCore = \"3.5.1\"\r\nappcompat = \"1.6.1\"\r\nmaterial = \"1.10.0\"\r\nactivity = \"1.8.0\"\r\nconstraintlayout = \"2.1.4\"\r\n\r\n[libraries]\r\njunit = { group = \"junit\", name = \"junit\", version.ref = \"junit\" }\r\next-junit = { group = \"androidx.test.ext\", name = \"junit\", version.ref = \"junitVersion\" }\r\nespresso-core = { group = \"androidx.test.espresso\", name = \"espresso-core\", version.ref = \"espressoCore\" }\r\nappcompat = { group = \"androidx.appcompat\", name = \"appcompat\", version.ref = \"appcompat\" }\r\nmaterial = { group = \"com.google.android.material\", name = \"material\", version.ref = \"material\" }\r\nactivity = { group = \"androidx.activity\", name = \"activity\", version.ref = \"activity\" }\r\nconstraintlayout = { group = \"androidx.constraintlayout\", name = \"constraintlayout\", version.ref = \"constraintlayout\" }\r\n\r\n[plugins]\r\nandroid-application = { id = \"com.android.application\", version.ref = \"agp\" }\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
--- a/gradle/libs.versions.toml	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/gradle/libs.versions.toml	(date 1763918002237)
@@ -1,5 +1,6 @@
 [versions]
 agp = "8.13.0"
+firebaseBom = "34.5.0"
 junit = "4.13.2"
 junitVersion = "1.1.5"
 espressoCore = "3.5.1"
@@ -7,8 +8,10 @@
 material = "1.10.0"
 activity = "1.8.0"
 constraintlayout = "2.1.4"
+firebaseAuth = "24.0.1"
 
 [libraries]
+firebase-bom = { module = "com.google.firebase:firebase-bom", version.ref = "firebaseBom" }
 junit = { group = "junit", name = "junit", version.ref = "junit" }
 ext-junit = { group = "androidx.test.ext", name = "junit", version.ref = "junitVersion" }
 espresso-core = { group = "androidx.test.espresso", name = "espresso-core", version.ref = "espressoCore" }
@@ -16,7 +19,7 @@
 material = { group = "com.google.android.material", name = "material", version.ref = "material" }
 activity = { group = "androidx.activity", name = "activity", version.ref = "activity" }
 constraintlayout = { group = "androidx.constraintlayout", name = "constraintlayout", version.ref = "constraintlayout" }
+firebase-auth = { group = "com.google.firebase", name = "firebase-auth", version.ref = "firebaseAuth" }
 
 [plugins]
 android-application = { id = "com.android.application", version.ref = "agp" }
-
Index: app/.idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/misc.xml b/app/.idea/misc.xml
new file mode 100644
--- /dev/null	(date 1763918002057)
+++ b/app/.idea/misc.xml	(date 1763918002057)
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="ExternalStorageConfigurationManager" enabled="true" />
+  <component name="ProjectRootManager">
+    <output url="file://$PROJECT_DIR$/build/classes" />
+  </component>
+  <component name="ProjectType">
+    <option name="id" value="Android" />
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/migrations.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/migrations.xml b/app/.idea/migrations.xml
new file mode 100644
--- /dev/null	(date 1763918002057)
+++ b/app/.idea/migrations.xml	(date 1763918002057)
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="ProjectMigrations">
+    <option name="MigrateToGradleLocalJavaHome">
+      <set>
+        <option value="$PROJECT_DIR$" />
+      </set>
+    </option>
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/vcs.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/vcs.xml b/app/.idea/vcs.xml
new file mode 100644
--- /dev/null	(date 1763918002058)
+++ b/app/.idea/vcs.xml	(date 1763918002058)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="VcsDirectoryMappings">
+    <mapping directory="$PROJECT_DIR$/.." vcs="Git" />
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/runConfigurations.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/runConfigurations.xml b/app/.idea/runConfigurations.xml
new file mode 100644
--- /dev/null	(date 1763918002057)
+++ b/app/.idea/runConfigurations.xml	(date 1763918002057)
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="RunConfigurationProducerService">
+    <option name="ignoredProducers">
+      <set>
+        <option value="com.intellij.execution.junit.AbstractAllInDirectoryConfigurationProducer" />
+        <option value="com.intellij.execution.junit.AllInPackageConfigurationProducer" />
+        <option value="com.intellij.execution.junit.PatternConfigurationProducer" />
+        <option value="com.intellij.execution.junit.TestInClassConfigurationProducer" />
+        <option value="com.intellij.execution.junit.UniqueIdConfigurationProducer" />
+        <option value="com.intellij.execution.junit.testDiscovery.JUnitTestDiscoveryConfigurationProducer" />
+        <option value="org.jetbrains.kotlin.idea.junit.KotlinJUnitRunConfigurationProducer" />
+        <option value="org.jetbrains.kotlin.idea.junit.KotlinPatternConfigurationProducer" />
+      </set>
+    </option>
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/AndroidProjectSystem.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/AndroidProjectSystem.xml b/app/.idea/AndroidProjectSystem.xml
new file mode 100644
--- /dev/null	(date 1763918002055)
+++ b/app/.idea/AndroidProjectSystem.xml	(date 1763918002055)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="AndroidProjectSystem">
+    <option name="providerId" value="com.android.tools.idea.GradleProjectSystem" />
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/.gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/.gitignore b/app/.idea/.gitignore
new file mode 100644
--- /dev/null	(date 1763918002055)
+++ b/app/.idea/.gitignore	(date 1763918002055)
@@ -0,0 +1,3 @@
+# Default ignored files
+/shelf/
+/workspace.xml
Index: app/.idea/gradle.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/gradle.xml b/app/.idea/gradle.xml
new file mode 100644
--- /dev/null	(date 1763918002056)
+++ b/app/.idea/gradle.xml	(date 1763918002056)
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="GradleSettings">
+    <option name="linkedExternalProjectsSettings">
+      <GradleProjectSettings>
+        <option name="testRunner" value="CHOOSE_PER_TEST" />
+        <option name="externalProjectPath" value="$PROJECT_DIR$" />
+        <option name="gradleJvm" value="#GRADLE_LOCAL_JAVA_HOME" />
+      </GradleProjectSettings>
+    </option>
+  </component>
+</project>
\ No newline at end of file
Index: app/.idea/caches/deviceStreaming.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/.idea/caches/deviceStreaming.xml b/app/.idea/caches/deviceStreaming.xml
new file mode 100644
--- /dev/null	(date 1763918002056)
+++ b/app/.idea/caches/deviceStreaming.xml	(date 1763918002056)
@@ -0,0 +1,1029 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="DeviceStreaming">
+    <option name="deviceSelectionList">
+      <list>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="Sony" />
+          <option name="codename" value="A402SO" />
+          <option name="id" value="A402SO" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Sony" />
+          <option name="name" value="Xperia 10" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2520" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="27" />
+          <option name="brand" value="DOCOMO" />
+          <option name="codename" value="F01L" />
+          <option name="id" value="F01L" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="FUJITSU" />
+          <option name="name" value="F-01L" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1280" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="OnePlus" />
+          <option name="codename" value="OP535DL1" />
+          <option name="id" value="OP535DL1" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="OnePlus" />
+          <option name="name" value="CPH2409" />
+          <option name="screenDensity" value="401" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2412" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="OnePlus" />
+          <option name="codename" value="OP5552L1" />
+          <option name="id" value="OP5552L1" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="OnePlus" />
+          <option name="name" value="CPH2415" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2412" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="OnePlus" />
+          <option name="codename" value="OP5552L1" />
+          <option name="id" value="OP5552L1" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="OnePlus" />
+          <option name="name" value="CPH2415" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2412" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="OPPO" />
+          <option name="codename" value="OP573DL1" />
+          <option name="id" value="OP573DL1" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="OPPO" />
+          <option name="name" value="CPH2557" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="28" />
+          <option name="brand" value="DOCOMO" />
+          <option name="codename" value="SH-01L" />
+          <option name="id" value="SH-01L" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="SHARP" />
+          <option name="name" value="AQUOS sense2 SH-01L" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2160" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="Lenovo" />
+          <option name="codename" value="TB330FU" />
+          <option name="formFactor" value="Tablet" />
+          <option name="id" value="TB330FU" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Lenovo" />
+          <option name="name" value="Tab M11" />
+          <option name="screenDensity" value="240" />
+          <option name="screenX" value="1200" />
+          <option name="screenY" value="1920" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a06" />
+          <option name="id" value="a06" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy A06" />
+          <option name="screenDensity" value="300" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a14m" />
+          <option name="id" value="a14m" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-A145R" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2408" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a15" />
+          <option name="id" value="a15" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="A15" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a15x" />
+          <option name="id" value="a15x" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="A15 5G" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a16" />
+          <option name="id" value="a16" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-A165M" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a16x" />
+          <option name="id" value="a16x" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="A16 5G" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a26x" />
+          <option name="id" value="a26x" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-A266B" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a35x" />
+          <option name="id" value="a35x" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="A35" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a36xq" />
+          <option name="id" value="a36xq" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-A366E" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="a56x" />
+          <option name="id" value="a56x" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-A566E" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="akita" />
+          <option name="id" value="akita" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 8a" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="akita" />
+          <option name="id" value="akita" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 8a" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="arcfox" />
+          <option name="id" value="arcfox" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="razr plus 2024" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="1272" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="austin" />
+          <option name="id" value="austin" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g 5G (2022)" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="b0q" />
+          <option name="id" value="b0q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S22 Ultra" />
+          <option name="screenDensity" value="600" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="3088" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="b6q" />
+          <option name="id" value="b6q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Flip 6" />
+          <option name="screenDensity" value="340" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2640" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="google" />
+          <option name="codename" value="blazer" />
+          <option name="id" value="blazer" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 10 Pro" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2410" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="32" />
+          <option name="brand" value="google" />
+          <option name="codename" value="bluejay" />
+          <option name="id" value="bluejay" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 6a" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="caiman" />
+          <option name="id" value="caiman" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="960" />
+          <option name="screenY" value="2142" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="caiman" />
+          <option name="id" value="caiman" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="960" />
+          <option name="screenY" value="2142" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="comet" />
+          <option name="default" value="true" />
+          <option name="id" value="comet" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro Fold" />
+          <option name="screenDensity" value="390" />
+          <option name="screenX" value="2076" />
+          <option name="screenY" value="2152" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="comet" />
+          <option name="default" value="true" />
+          <option name="id" value="comet" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro Fold" />
+          <option name="screenDensity" value="390" />
+          <option name="screenX" value="2076" />
+          <option name="screenY" value="2152" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="29" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="crownqlteue" />
+          <option name="id" value="crownqlteue" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Note9" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="2220" />
+          <option name="screenY" value="1080" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="dm1q" />
+          <option name="id" value="dm1q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="S23" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="dm2q" />
+          <option name="id" value="dm2q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="S23 Plus" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="dm3q" />
+          <option name="id" value="dm3q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S23 Ultra" />
+          <option name="screenDensity" value="600" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="3088" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="dubai" />
+          <option name="id" value="dubai" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="edge 30" />
+          <option name="screenDensity" value="405" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="e1q" />
+          <option name="default" value="true" />
+          <option name="id" value="e1q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S24" />
+          <option name="screenDensity" value="480" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="e3q" />
+          <option name="id" value="e3q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S24 Ultra" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="3120" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="eos" />
+          <option name="id" value="eos" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Eos" />
+          <option name="screenDensity" value="320" />
+          <option name="screenX" value="384" />
+          <option name="screenY" value="384" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="felix" />
+          <option name="id" value="felix" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel Fold" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="2208" />
+          <option name="screenY" value="1840" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="felix" />
+          <option name="id" value="felix" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel Fold" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="2208" />
+          <option name="screenY" value="1840" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="felix_camera" />
+          <option name="id" value="felix_camera" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel Fold (Camera-enabled)" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="2208" />
+          <option name="screenY" value="1840" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="fogona" />
+          <option name="id" value="fogona" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g play - 2024" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="fogos" />
+          <option name="id" value="fogos" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g34 5G" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="google" />
+          <option name="codename" value="frankel" />
+          <option name="id" value="frankel" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 10" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2424" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="g0q" />
+          <option name="id" value="g0q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-S906U1" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gta9pwifi" />
+          <option name="id" value="gta9pwifi" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-X210" />
+          <option name="screenDensity" value="240" />
+          <option name="screenX" value="1200" />
+          <option name="screenY" value="1920" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts7lwifi" />
+          <option name="id" value="gts7lwifi" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-T870" />
+          <option name="screenDensity" value="340" />
+          <option name="screenX" value="1600" />
+          <option name="screenY" value="2560" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts7xllite" />
+          <option name="id" value="gts7xllite" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-T738U" />
+          <option name="screenDensity" value="340" />
+          <option name="screenX" value="1600" />
+          <option name="screenY" value="2560" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts8uwifi" />
+          <option name="formFactor" value="Tablet" />
+          <option name="id" value="gts8uwifi" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Tab S8 Ultra" />
+          <option name="screenDensity" value="320" />
+          <option name="screenX" value="1848" />
+          <option name="screenY" value="2960" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts8wifi" />
+          <option name="formFactor" value="Tablet" />
+          <option name="id" value="gts8wifi" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Tab S8" />
+          <option name="screenDensity" value="274" />
+          <option name="screenX" value="1600" />
+          <option name="screenY" value="2560" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts9fe" />
+          <option name="id" value="gts9fe" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Tab S9 FE 5G" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="2304" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="gts9wifi" />
+          <option name="id" value="gts9wifi" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-X710" />
+          <option name="screenDensity" value="340" />
+          <option name="screenX" value="1600" />
+          <option name="screenY" value="2560" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="husky" />
+          <option name="id" value="husky" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 8 Pro" />
+          <option name="screenDensity" value="390" />
+          <option name="screenX" value="1008" />
+          <option name="screenY" value="2244" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="30" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="java" />
+          <option name="id" value="java" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="G20" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="kansas" />
+          <option name="id" value="kansas" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g - 2025" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1604" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="komodo" />
+          <option name="id" value="komodo" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro XL" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="1008" />
+          <option name="screenY" value="2244" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="komodo" />
+          <option name="id" value="komodo" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9 Pro XL" />
+          <option name="screenDensity" value="360" />
+          <option name="screenX" value="1008" />
+          <option name="screenY" value="2244" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="lamul" />
+          <option name="id" value="lamul" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g05" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1604" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="lion" />
+          <option name="id" value="lion" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g04" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1612" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="lynx" />
+          <option name="id" value="lynx" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 7a" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="lyriq" />
+          <option name="id" value="lyriq" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="edge 40" />
+          <option name="screenDensity" value="400" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="manaus" />
+          <option name="id" value="manaus" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="edge 40 neo" />
+          <option name="screenDensity" value="400" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="motorola" />
+          <option name="codename" value="maui" />
+          <option name="id" value="maui" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Motorola" />
+          <option name="name" value="moto g play - 2023" />
+          <option name="screenDensity" value="280" />
+          <option name="screenX" value="720" />
+          <option name="screenY" value="1600" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="google" />
+          <option name="codename" value="mustang" />
+          <option name="id" value="mustang" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 10 Pro XL" />
+          <option name="screenDensity" value="390" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2404" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="o1q" />
+          <option name="id" value="o1q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S21" />
+          <option name="screenDensity" value="421" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="31" />
+          <option name="brand" value="google" />
+          <option name="codename" value="oriole" />
+          <option name="id" value="oriole" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 6" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="pa2q" />
+          <option name="id" value="pa2q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="S25+" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="pa3q" />
+          <option name="id" value="pa3q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S25 Ultra" />
+          <option name="screenDensity" value="600" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="3120" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="panther" />
+          <option name="id" value="panther" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 7" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="psq" />
+          <option name="id" value="psq" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S25 Edge" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1440" />
+          <option name="screenY" value="3120" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="q5q" />
+          <option name="id" value="q5q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Z Fold5" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1812" />
+          <option name="screenY" value="2176" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="q6q" />
+          <option name="id" value="q6q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy Z Fold6" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1856" />
+          <option name="screenY" value="2160" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="30" />
+          <option name="brand" value="google" />
+          <option name="codename" value="r11" />
+          <option name="formFactor" value="Wear OS" />
+          <option name="id" value="r11" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel Watch" />
+          <option name="screenDensity" value="320" />
+          <option name="screenX" value="384" />
+          <option name="screenY" value="384" />
+          <option name="type" value="WEAR_OS" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="r11q" />
+          <option name="id" value="r11q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-S711U" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="google" />
+          <option name="codename" value="rango" />
+          <option name="id" value="rango" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 10 Pro Fold" />
+          <option name="screenDensity" value="390" />
+          <option name="screenX" value="2076" />
+          <option name="screenY" value="2152" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="30" />
+          <option name="brand" value="google" />
+          <option name="codename" value="redfin" />
+          <option name="id" value="redfin" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 5" />
+          <option name="screenDensity" value="440" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2340" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="shiba" />
+          <option name="id" value="shiba" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 8" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="t2q" />
+          <option name="id" value="t2q" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="Galaxy S21 Plus" />
+          <option name="screenDensity" value="394" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2400" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="33" />
+          <option name="brand" value="google" />
+          <option name="codename" value="tangorpro" />
+          <option name="formFactor" value="Tablet" />
+          <option name="id" value="tangorpro" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel Tablet" />
+          <option name="screenDensity" value="320" />
+          <option name="screenX" value="1600" />
+          <option name="screenY" value="2560" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="tegu" />
+          <option name="id" value="tegu" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9a" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2424" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="google" />
+          <option name="codename" value="tokay" />
+          <option name="default" value="true" />
+          <option name="id" value="tokay" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2424" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="35" />
+          <option name="brand" value="google" />
+          <option name="codename" value="tokay" />
+          <option name="default" value="true" />
+          <option name="id" value="tokay" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2424" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="36" />
+          <option name="brand" value="google" />
+          <option name="codename" value="tokay" />
+          <option name="default" value="true" />
+          <option name="id" value="tokay" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Google" />
+          <option name="name" value="Pixel 9" />
+          <option name="screenDensity" value="420" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2424" />
+        </PersistentDeviceSelectionData>
+        <PersistentDeviceSelectionData>
+          <option name="api" value="34" />
+          <option name="brand" value="samsung" />
+          <option name="codename" value="xcover7" />
+          <option name="id" value="xcover7" />
+          <option name="labId" value="google" />
+          <option name="manufacturer" value="Samsung" />
+          <option name="name" value="SM-G556B" />
+          <option name="screenDensity" value="450" />
+          <option name="screenX" value="1080" />
+          <option name="screenY" value="2408" />
+        </PersistentDeviceSelectionData>
+      </list>
+    </option>
+  </component>
+</project>
\ No newline at end of file
Index: app/src/main/res/drawable/tag_background.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/tag_background.xml b/app/src/main/res/drawable/tag_background.xml
new file mode 100644
--- /dev/null	(date 1763918002225)
+++ b/app/src/main/res/drawable/tag_background.xml	(date 1763918002225)
@@ -0,0 +1,5 @@
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <solid android:color="#E8F5E9"/>
+    <corners android:radius="8dp"/>
+</shape>
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1763918002053)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]/shelved.patch	(date 1763918002053)
@@ -0,0 +1,566 @@
+Index: app/src/main/java/com/example/smartair/TechniqueActivity.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.example.smartair;\n\nimport android.net.Uri;\nimport android.os.Bundle;\nimport android.widget.MediaController;\nimport android.widget.TextView;\nimport android.widget.VideoView;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\npublic class TechniqueActivity extends AppCompatActivity {\n\n    private VideoView videoView;\n    private TextView tvSteps;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_technique);\n\n        videoView = findViewById(R.id.videoView);\n        tvSteps = findViewById(R.id.tvSteps);\n\n        // 示例视频 URL（你可以换成 Firebase Storage 的下载URL 或本地 raw 资源）\n        String sampleVideo = \"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4\";\n\n        videoView.setVideoURI(Uri.parse(sampleVideo));\n        MediaController mediaController = new MediaController(this);\n        mediaController.setAnchorView(videoView);\n        videoView.setMediaController(mediaController);\n        videoView.requestFocus();\n\n        // 技巧步骤\n        String steps = \"1. Seal lips around mouthpiece.\\n\"\n                + \"2. Take a slow, deep breath in.\\n\"\n                + \"3. Hold your breath for ~10 seconds.\\n\"\n                + \"4. If multiple puffs: wait 30–60s between puffs.\\n\"\n                + \"5. If using spacer/mask: attach properly, breathe slowly.\\n\\n\"\n                + \"（点击视频播放按钮查看演示）\";\n        tvSteps.setText(steps);\n    }\n\n    @Override\n    protected void onPause() {\n        super.onPause();\n        if (videoView.isPlaying()) videoView.pause();\n    }\n}\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/TechniqueActivity.java b/app/src/main/java/com/example/smartair/TechniqueActivity.java
+--- a/app/src/main/java/com/example/smartair/TechniqueActivity.java	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/app/src/main/java/com/example/smartair/TechniqueActivity.java	(date 1763564693482)
+@@ -8,41 +8,45 @@
+ 
+ import androidx.appcompat.app.AppCompatActivity;
+ 
++
++import android.os.Bundle;
++
++import androidx.annotation.Nullable;
++import androidx.appcompat.app.AppCompatActivity;
++import androidx.viewpager2.widget.ViewPager2;
++
++import java.util.ArrayList;
++import java.util.List;
++
+ public class TechniqueActivity extends AppCompatActivity {
+ 
+-    private VideoView videoView;
+-    private TextView tvSteps;
++    private ViewPager2 viewPager;
++    private StepsAdapter adapter;
+ 
+     @Override
+-    protected void onCreate(Bundle savedInstanceState) {
++    protected void onCreate(@Nullable Bundle savedInstanceState) {
+         super.onCreate(savedInstanceState);
+         setContentView(R.layout.activity_technique);
+ 
+-        videoView = findViewById(R.id.videoView);
+-        tvSteps = findViewById(R.id.tvSteps);
++        viewPager = findViewById(R.id.viewPager);
+ 
+-        // 示例视频 URL（你可以换成 Firebase Storage 的下载URL 或本地 raw 资源）
+-        String sampleVideo = "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4";
++        // prepare pages: 5 steps + 1 youtube page
++        List<PageItem> pages = new ArrayList<>();
+ 
+-        videoView.setVideoURI(Uri.parse(sampleVideo));
+-        MediaController mediaController = new MediaController(this);
+-        mediaController.setAnchorView(videoView);
+-        videoView.setMediaController(mediaController);
+-        videoView.requestFocus();
++        // step images should be in res/drawable/step1.jpg ... step5.jpg
++        pages.add(new PageItem(R.drawable.step1, "Step 1 — Get ready: Seal the mouthpiece\n\nImagine your little rocket would leak if air slips out. Put your lips tightly around the mouthpiece—no gaps."));
++        pages.add(new PageItem(R.drawable.step2, "Step 2 — Empty your lungs: Blow out slowly\n\nBefore pressing your rocket, breathe out all the air like blowing out a birthday candle."));
++        pages.add(new PageItem(R.drawable.step3, "Step 3 — Fire! Inhale deeply while pressing\n\nPress the inhaler quickly and deeply breathe in for 3–5 seconds so the medicine reaches the lungs."));
++        pages.add(new PageItem(R.drawable.step4, "Step 4 — Hold the breath\n\nHold your breath for about 10 seconds if you can — this helps the medicine work. If not, hold as long as comfortable (at least 4–5s)."));
++        pages.add(new PageItem(R.drawable.step5, "Step 5 — Wait before the next puff\n\nIf another puff is needed, wait 30–60 seconds (sing a short song!) then repeat the steps."));
+ 
+-        // 技巧步骤
+-        String steps = "1. Seal lips around mouthpiece.\n"
+-                + "2. Take a slow, deep breath in.\n"
+-                + "3. Hold your breath for ~10 seconds.\n"
+-                + "4. If multiple puffs: wait 30–60s between puffs.\n"
+-                + "5. If using spacer/mask: attach properly, breathe slowly.\n\n"
+-                + "（点击视频播放按钮查看演示）";
+-        tvSteps.setText(steps);
+-    }
++        // youtube page special: imageResId = 0 means youtube page (adapter will detect)
++        pages.add(new PageItem(0, "youtube:Br9irulpbsc"));
+ 
+-    @Override
+-    protected void onPause() {
+-        super.onPause();
+-        if (videoView.isPlaying()) videoView.pause();
++        adapter = new StepsAdapter(this, pages);
++        viewPager.setAdapter(adapter);
++
++        // Optional: set orientation and offscreen limit
++        viewPager.setOffscreenPageLimit(1);
+     }
+ }
+Index: app/src/main/res/layout/fragment_step.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/layout/fragment_step.xml b/app/src/main/res/layout/fragment_step.xml
+new file mode 100644
+--- /dev/null	(date 1763564539259)
++++ b/app/src/main/res/layout/fragment_step.xml	(date 1763564539259)
+@@ -0,0 +1,49 @@
++<?xml version="1.0" encoding="utf-8"?>
++<FrameLayout
++    xmlns:android="http://schemas.android.com/apk/res/android"
++    xmlns:card_view="http://schemas.android.com/apk/res-auto"
++    android:layout_width="match_parent"
++    android:layout_height="match_parent"
++    android:padding="20dp">
++
++    <androidx.cardview.widget.CardView
++        android:id="@+id/card"
++        android:layout_width="match_parent"
++        android:layout_height="wrap_content"
++        card_view:cardCornerRadius="16dp"
++        card_view:cardElevation="8dp"
++        android:layout_gravity="center"
++        android:padding="14dp"
++        android:backgroundTint="@color/card_bg">
++
++        <LinearLayout
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:orientation="vertical"
++            android:gravity="center_horizontal">
++
++            <ImageView
++                android:id="@+id/stepImage"
++                android:layout_width="match_parent"
++                android:layout_height="0dp"
++                android:adjustViewBounds="true"
++                android:scaleType="centerCrop"
++                android:layout_weight="1"
++                android:contentDescription="@string/step_image_desc"/>
++
++            <TextView
++                android:id="@+id/stepText"
++                android:layout_width="match_parent"
++                android:layout_height="wrap_content"
++                android:layout_marginTop="12dp"
++                android:layout_marginBottom="8dp"
++                android:textSize="18sp"
++                android:lineSpacingExtra="4dp"
++                android:textColor="@color/text_primary"
++                android:gravity="center"/>
++
++        </LinearLayout>
++
++    </androidx.cardview.widget.CardView>
++
++</FrameLayout>
+Index: app/src/main/res/layout/fragment_youtube.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/layout/fragment_youtube.xml b/app/src/main/res/layout/fragment_youtube.xml
+new file mode 100644
+--- /dev/null	(date 1763570529076)
++++ b/app/src/main/res/layout/fragment_youtube.xml	(date 1763570529076)
+@@ -0,0 +1,23 @@
++<?xml version="1.0" encoding="utf-8"?>
++<FrameLayout
++    xmlns:android="http://schemas.android.com/apk/res/android"
++    xmlns:app="http://schemas.android.com/apk/res-auto"
++    android:layout_width="match_parent"
++    android:layout_height="match_parent"
++    android:padding="16dp">
++
++    <androidx.cardview.widget.CardView
++        android:layout_width="match_parent"
++        android:layout_height="match_parent"
++        app:cardCornerRadius="16dp"
++        app:cardElevation="8dp"
++        android:backgroundTint="@color/card_bg">
++
++        <WebView
++            android:id="@+id/youtubeWebView"
++            android:layout_width="match_parent"
++            android:layout_height="match_parent"/>
++
++    </androidx.cardview.widget.CardView>
++
++</FrameLayout>
+Index: app/src/main/java/com/example/smartair/PageItem.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/PageItem.java b/app/src/main/java/com/example/smartair/PageItem.java
+new file mode 100644
+--- /dev/null	(date 1763564726356)
++++ b/app/src/main/java/com/example/smartair/PageItem.java	(date 1763564726356)
+@@ -0,0 +1,11 @@
++package com.example.smartair;
++
++public class PageItem {
++    public int imageRes; // 0 => special (youtube)
++    public String text;  // for youtube page we store "youtube:VIDEO_ID"
++
++    public PageItem(int imageRes, String text) {
++        this.imageRes = imageRes;
++        this.text = text;
++    }
++}
+Index: app/src/main/java/com/example/smartair/StepsAdapter.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/StepsAdapter.java b/app/src/main/java/com/example/smartair/StepsAdapter.java
+new file mode 100644
+--- /dev/null	(date 1763564759784)
++++ b/app/src/main/java/com/example/smartair/StepsAdapter.java	(date 1763564759784)
+@@ -0,0 +1,38 @@
++package com.example.smartair;
++
++import android.content.Context;
++
++import androidx.annotation.NonNull;
++import androidx.fragment.app.Fragment;
++import androidx.fragment.app.FragmentActivity;
++import androidx.viewpager2.adapter.FragmentStateAdapter;
++
++import java.util.List;
++
++public class StepsAdapter extends FragmentStateAdapter {
++
++    private List<PageItem> pages;
++
++    public StepsAdapter(@NonNull FragmentActivity fragmentActivity, List<PageItem> pages) {
++        super(fragmentActivity);
++        this.pages = pages;
++    }
++
++    @NonNull
++    @Override
++    public Fragment createFragment(int position) {
++        PageItem item = pages.get(position);
++        if (item.imageRes == 0 && item.text != null && item.text.startsWith("youtube:")) {
++            String videoId = item.text.substring("youtube:".length());
++            return YoutubePageFragment.newInstance(videoId);
++        } else {
++            return StepFragment.newInstance(item.imageRes, item.text);
++        }
++    }
++
++    @Override
++    public int getItemCount() {
++        return pages.size();
++    }
++}
++
+Index: app/src/main/java/com/example/smartair/StepFragment.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/StepFragment.java b/app/src/main/java/com/example/smartair/StepFragment.java
+new file mode 100644
+--- /dev/null	(date 1763564827419)
++++ b/app/src/main/java/com/example/smartair/StepFragment.java	(date 1763564827419)
+@@ -0,0 +1,57 @@
++package com.example.smartair;
++
++
++import android.os.Bundle;
++import android.view.LayoutInflater;
++import android.view.View;
++import android.view.ViewGroup;
++import android.widget.ImageView;
++import android.widget.TextView;
++
++import androidx.annotation.NonNull;
++import androidx.annotation.Nullable;
++import androidx.fragment.app.Fragment;
++
++public class StepFragment extends Fragment {
++
++    private static final String ARG_IMG = "arg_img";
++    private static final String ARG_TEXT = "arg_text";
++
++    public static StepFragment newInstance(int imgRes, String text) {
++        StepFragment f = new StepFragment();
++        Bundle b = new Bundle();
++        b.putInt(ARG_IMG, imgRes);
++        b.putString(ARG_TEXT, text);
++        f.setArguments(b);
++        return f;
++    }
++
++    private int imgRes;
++    private String text;
++
++    @Override
++    public void onCreate(@Nullable Bundle savedInstanceState) {
++        super.onCreate(savedInstanceState);
++        if (getArguments() != null) {
++            imgRes = getArguments().getInt(ARG_IMG);
++            text = getArguments().getString(ARG_TEXT);
++        }
++    }
++
++    @Nullable
++    @Override
++    public View onCreateView(@NonNull LayoutInflater inflater,
++                             @Nullable ViewGroup container,
++                             @Nullable Bundle savedInstanceState) {
++        View v = inflater.inflate(R.layout.fragment_step, container, false);
++        ImageView img = v.findViewById(R.id.stepImage);
++        TextView txt = v.findViewById(R.id.stepText);
++
++        if (imgRes != 0) {
++            img.setImageResource(imgRes);
++        }
++        txt.setText(text);
++
++        return v;
++    }
++}
+Index: app/src/main/java/com/example/smartair/YoutubePageFragment.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/YoutubePageFragment.java b/app/src/main/java/com/example/smartair/YoutubePageFragment.java
+new file mode 100644
+--- /dev/null	(date 1763564890495)
++++ b/app/src/main/java/com/example/smartair/YoutubePageFragment.java	(date 1763564890495)
+@@ -0,0 +1,58 @@
++package com.example.smartair;
++
++import android.annotation.SuppressLint;
++import android.os.Bundle;
++import android.view.LayoutInflater;
++import android.view.View;
++import android.view.ViewGroup;
++import android.webkit.WebSettings;
++import android.webkit.WebView;
++import android.webkit.WebViewClient;
++
++import androidx.annotation.NonNull;
++import androidx.annotation.Nullable;
++import androidx.fragment.app.Fragment;
++
++public class YoutubePageFragment extends Fragment {
++
++    private static final String ARG_VIDEO = "arg_video";
++    private String videoId;
++
++    public static YoutubePageFragment newInstance(String videoId) {
++        YoutubePageFragment f = new YoutubePageFragment();
++        Bundle b = new Bundle();
++        b.putString(ARG_VIDEO, videoId);
++        f.setArguments(b);
++        return f;
++    }
++
++    @Override
++    public void onCreate(@Nullable Bundle savedInstanceState) {
++        super.onCreate(savedInstanceState);
++        if (getArguments() != null) videoId = getArguments().getString(ARG_VIDEO);
++    }
++
++    @SuppressLint("SetJavaScriptEnabled")
++    @Nullable
++    @Override
++    public View onCreateView(@NonNull LayoutInflater inflater,
++                             @Nullable ViewGroup container,
++                             @Nullable Bundle savedInstanceState) {
++        View v = inflater.inflate(R.layout.fragment_youtube, container, false);
++        WebView webView = v.findViewById(R.id.youtubeWebView);
++
++        WebSettings ws = webView.getSettings();
++        ws.setJavaScriptEnabled(true);
++        ws.setDomStorageEnabled(true);
++        webView.setWebViewClient(new WebViewClient());
++
++        // Use YouTube embed (responsive)
++        String html = "<html><body style='margin:0;padding:0;'><iframe width='100%' height='100%' " +
++                "src='https://www.youtube.com/embed/" + videoId + "?rel=0&autoplay=0' " +
++                "frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></body></html>";
++
++        webView.loadData(html, "text/html", "utf-8");
++        return v;
++    }
++}
++
+Index: gradle/libs.versions.toml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>[versions]\nagp = \"8.13.0\"\nfirebaseBom = \"34.5.0\"\njunit = \"4.13.2\"\njunitVersion = \"1.1.5\"\nespressoCore = \"3.5.1\"\nappcompat = \"1.6.1\"\nmaterial = \"1.10.0\"\nactivity = \"1.8.0\"\nconstraintlayout = \"2.1.4\"\nfirebaseAuth = \"24.0.1\"\n\n[libraries]\nfirebase-bom = { module = \"com.google.firebase:firebase-bom\", version.ref = \"firebaseBom\" }\njunit = { group = \"junit\", name = \"junit\", version.ref = \"junit\" }\next-junit = { group = \"androidx.test.ext\", name = \"junit\", version.ref = \"junitVersion\" }\nespresso-core = { group = \"androidx.test.espresso\", name = \"espresso-core\", version.ref = \"espressoCore\" }\nappcompat = { group = \"androidx.appcompat\", name = \"appcompat\", version.ref = \"appcompat\" }\nmaterial = { group = \"com.google.android.material\", name = \"material\", version.ref = \"material\" }\nactivity = { group = \"androidx.activity\", name = \"activity\", version.ref = \"activity\" }\nconstraintlayout = { group = \"androidx.constraintlayout\", name = \"constraintlayout\", version.ref = \"constraintlayout\" }\nfirebase-auth = { group = \"com.google.firebase\", name = \"firebase-auth\", version.ref = \"firebaseAuth\" }\n\n[plugins]\nandroid-application = { id = \"com.android.application\", version.ref = \"agp\" }\n\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
+--- a/gradle/libs.versions.toml	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/gradle/libs.versions.toml	(date 1763567384496)
+@@ -1,5 +1,5 @@
+ [versions]
+-agp = "8.13.0"
++agp = "8.13.1"
+ firebaseBom = "34.5.0"
+ junit = "4.13.2"
+ junitVersion = "1.1.5"
+Index: app/src/main/res/layout/activity_technique.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<ScrollView xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:padding=\"12dp\">\n\n    <LinearLayout\n        android:orientation=\"vertical\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\">\n\n        <VideoView\n            android:id=\"@+id/videoView\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"220dp\"\n            android:layout_marginBottom=\"12dp\" />\n\n        <TextView\n            android:id=\"@+id/tvSteps\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:textSize=\"16sp\"/>\n    </LinearLayout>\n</ScrollView>\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/layout/activity_technique.xml b/app/src/main/res/layout/activity_technique.xml
+--- a/app/src/main/res/layout/activity_technique.xml	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/app/src/main/res/layout/activity_technique.xml	(date 1763564532323)
+@@ -1,24 +1,21 @@
+ <?xml version="1.0" encoding="utf-8"?>
+-<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
++<androidx.constraintlayout.widget.ConstraintLayout
++    xmlns:android="http://schemas.android.com/apk/res/android"
++    xmlns:tools="http://schemas.android.com/tools"
++    xmlns:app="http://schemas.android.com/apk/res-auto"
++    android:id="@+id/root"
+     android:layout_width="match_parent"
+     android:layout_height="match_parent"
+-    android:padding="12dp">
++    android:background="@color/bg_soft"
++    tools:context=".TechniqueActivity">
+ 
+-    <LinearLayout
+-        android:orientation="vertical"
+-        android:layout_width="match_parent"
+-        android:layout_height="wrap_content">
++    <androidx.viewpager2.widget.ViewPager2
++        android:id="@+id/viewPager"
++        android:layout_width="0dp"
++        android:layout_height="0dp"
++        app:layout_constraintTop_toTopOf="parent"
++        app:layout_constraintBottom_toBottomOf="parent"
++        app:layout_constraintStart_toStartOf="parent"
++        app:layout_constraintEnd_toEndOf="parent"/>
+ 
+-        <VideoView
+-            android:id="@+id/videoView"
+-            android:layout_width="match_parent"
+-            android:layout_height="220dp"
+-            android:layout_marginBottom="12dp" />
+-
+-        <TextView
+-            android:id="@+id/tvSteps"
+-            android:layout_width="match_parent"
+-            android:layout_height="wrap_content"
+-            android:textSize="16sp"/>
+-    </LinearLayout>
+-</ScrollView>
++</androidx.constraintlayout.widget.ConstraintLayout>
+Index: app/build.gradle.kts
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>plugins {\n    id(\"com.android.application\")\n    id(\"com.google.gms.google-services\")\n}\n\nandroid {\n    namespace = \"com.example.smartair\"\n    compileSdk = 36\n\n    defaultConfig {\n        applicationId = \"com.example.smartair\"\n        minSdk = 24\n        targetSdk = 36\n        versionCode = 1\n        versionName = \"1.0\"\n\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\n    }\n\n    buildTypes {\n        release {\n            isMinifyEnabled = false\n            proguardFiles(\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\n                \"proguard-rules.pro\"\n            )\n        }\n    }\n\n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n}\n\ndependencies {\n    implementation(libs.appcompat)\n    implementation(libs.material)\n    implementation(libs.activity)\n    implementation(libs.constraintlayout)\n    implementation(libs.firebase.auth)\n    testImplementation(libs.junit)\n    androidTestImplementation(libs.ext.junit)\n    androidTestImplementation(libs.espresso.core)\n\n    implementation(platform(\"com.google.firebase:firebase-bom:34.5.0\"))\n    implementation(\"com.google.firebase:firebase-analytics\")\n    // module: app/build.gradle.kts - 在 dependencies {} 里加入\n    implementation(\"com.google.firebase:firebase-auth:23.1.0\")\n    implementation(\"com.google.firebase:firebase-firestore:24.7.0\")\n    implementation(\"com.google.android.material:material:1.12.0\")\n\n}\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/build.gradle.kts b/app/build.gradle.kts
+--- a/app/build.gradle.kts	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/app/build.gradle.kts	(date 1763567926608)
+@@ -5,12 +5,12 @@
+ 
+ android {
+     namespace = "com.example.smartair"
+-    compileSdk = 36
++    compileSdk = 34     // 推荐 34，36 太新稳定性不足
+ 
+     defaultConfig {
+         applicationId = "com.example.smartair"
+         minSdk = 24
+-        targetSdk = 36
++        targetSdk = 34
+         versionCode = 1
+         versionName = "1.0"
+ 
+@@ -34,20 +34,24 @@
+ }
+ 
+ dependencies {
+-    implementation(libs.appcompat)
+-    implementation(libs.material)
+-    implementation(libs.activity)
+-    implementation(libs.constraintlayout)
+-    implementation(libs.firebase.auth)
+-    testImplementation(libs.junit)
+-    androidTestImplementation(libs.ext.junit)
+-    androidTestImplementation(libs.espresso.core)
+ 
++    // ---- 基础 AndroidX ----
++    implementation("androidx.appcompat:appcompat:1.7.0")
++    implementation("com.google.android.material:material:1.12.0")
++    implementation("androidx.constraintlayout:constraintlayout:2.1.4")
++    implementation("androidx.activity:activity:1.8.0")
++    implementation("androidx.fragment:fragment-ktx:1.6.2")
++    implementation("androidx.viewpager2:viewpager2:1.1.0")
++    implementation("androidx.cardview:cardview:1.0.0")
++
++    // ---- Firebase ----
+     implementation(platform("com.google.firebase:firebase-bom:34.5.0"))
+     implementation("com.google.firebase:firebase-analytics")
+-    // module: app/build.gradle.kts - 在 dependencies {} 里加入
+-    implementation("com.google.firebase:firebase-auth:23.1.0")
+-    implementation("com.google.firebase:firebase-firestore:24.7.0")
+-    implementation("com.google.android.material:material:1.12.0")
++    implementation("com.google.firebase:firebase-auth")
++    implementation("com.google.firebase:firebase-firestore")
+ 
++    // ---- Unit tests ----
++    testImplementation("junit:junit:4.13.2")
++    androidTestImplementation("androidx.test.ext:junit:1.1.5")
++    androidTestImplementation("androidx.test.espresso:espresso-core:3.5.1")
+ }
+Index: .idea/deploymentTargetSelector.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"deploymentTargetSelector\">\n    <selectionStates>\n      <SelectionState runConfigName=\"app\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n    </selectionStates>\n  </component>\n</project>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
+--- a/.idea/deploymentTargetSelector.xml	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/.idea/deploymentTargetSelector.xml	(date 1763567267347)
+@@ -5,6 +5,12 @@
+       <SelectionState runConfigName="app">
+         <option name="selectionMode" value="DROPDOWN" />
+       </SelectionState>
++      <SelectionState runConfigName="MainActivity">
++        <option name="selectionMode" value="DROPDOWN" />
++      </SelectionState>
++      <SelectionState runConfigName="MainActivity (1)">
++        <option name="selectionMode" value="DROPDOWN" />
++      </SelectionState>
+     </selectionStates>
+   </component>
+ </project>
+\ No newline at end of file
+Index: app/src/main/res/values/strings.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><resources>\n    <string name=\"app_name\">SmartAir</string>\n</resources>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
+--- a/app/src/main/res/values/strings.xml	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/app/src/main/res/values/strings.xml	(date 1763566917275)
+@@ -1,3 +1,4 @@
+ <resources>
+     <string name="app_name">SmartAir</string>
++    <string name="step_image_desc">Step image</string>
+ </resources>
+\ No newline at end of file
+Index: app/src/main/res/values/colors.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<resources>\n    <color name=\"black\">#FF000000</color>\n    <color name=\"white\">#FFFFFFFF</color>\n</resources>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/values/colors.xml b/app/src/main/res/values/colors.xml
+--- a/app/src/main/res/values/colors.xml	(revision 76460b8824ba416f793a4b831928ae0517a483d5)
++++ b/app/src/main/res/values/colors.xml	(date 1763564584538)
+@@ -2,4 +2,7 @@
+ <resources>
+     <color name="black">#FF000000</color>
+     <color name="white">#FFFFFFFF</color>
++    <color name="bg_soft">#FFF7F2</color> <!-- page background -->
++    <color name="card_bg">#FFFFFFFF</color> <!-- card background -->
++    <color name="text_primary">#333333</color>
+ </resources>
+\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20__04_00__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20__04_00__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20__04_00__Changes_.xml
new file mode 100644
--- /dev/null	(date 1763918002053)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20__04_00__Changes_.xml	(date 1763918002053)
@@ -0,0 +1,4 @@
+<changelist name="Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]" date="1763582451542" recycled="false" toDelete="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-20,_04_00_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2025-11-20, 04:00 [Changes]" />
+</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23__03_54__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23__03_54__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23__03_54__Changes_.xml
new file mode 100644
--- /dev/null	(date 1763918002055)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23__03_54__Changes_.xml	(date 1763918002055)
@@ -0,0 +1,4 @@
+<changelist name="Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]" date="1763841504553" recycled="true" deleted="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2025-11-23, 03:54 [Changes]" />
+</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1763918002054)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_2025-11-23,_03_54_[Changes]/shelved.patch	(date 1763918002054)
@@ -0,0 +1,2888 @@
+Index: app/src/main/java/com/example/smartair/auth/RegisterActivity.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.example.smartair.auth;\n\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.os.Looper;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ProgressBar;\nimport android.widget.RadioGroup;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.example.smartair.R;\nimport com.example.smartair.models.UserRole;\n\npublic class RegisterActivity extends AppCompatActivity {\n\n    private EditText nameEditText;\n    private EditText emailEditText;\n    private EditText passwordEditText;\n    private EditText confirmPasswordEditText;\n    private RadioGroup roleRadioGroup;\n    private Button registerButton;\n    private ProgressBar progressBar;\n    private TextView backToLoginTextView;\n\n    private AuthModel authModel;\n    private final Handler timeoutHandler = new Handler(Looper.getMainLooper());\n    private Runnable timeoutRunnable;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_register);\n\n        nameEditText = findViewById(R.id.nameEditText);\n        emailEditText = findViewById(R.id.emailEditText);\n        passwordEditText = findViewById(R.id.passwordEditText);\n        confirmPasswordEditText = findViewById(R.id.confirmPasswordEditText);\n        roleRadioGroup = findViewById(R.id.roleRadioGroup);\n        registerButton = findViewById(R.id.registerButton);\n        progressBar = findViewById(R.id.progressBar);\n        backToLoginTextView = findViewById(R.id.backToLoginTextView);\n\n        authModel = new AuthModel();\n\n        registerButton.setOnClickListener(v -> register());\n        backToLoginTextView.setOnClickListener(v -> finish());\n    }\n\n    private void register() {\n        String name = nameEditText.getText().toString().trim();\n        String email = emailEditText.getText().toString().trim();\n        String password = passwordEditText.getText().toString().trim();\n        String confirmPassword = confirmPasswordEditText.getText().toString().trim();\n\n        if (name.isEmpty() || email.isEmpty() || password.isEmpty() || confirmPassword.isEmpty()) {\n            Toast.makeText(this, \"All fields are required.\", Toast.LENGTH_LONG).show();\n            return;\n        }\n\n        if (!android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches()) {\n            Toast.makeText(this, \"Please enter a valid email address.\", Toast.LENGTH_LONG).show();\n            return;\n        }\n\n        if (password.length() < 6) {\n            Toast.makeText(this, \"Password must be at least 6 characters.\", Toast.LENGTH_LONG).show();\n            return;\n        }\n\n        if (!password.equals(confirmPassword)) {\n            Toast.makeText(this, \"Passwords do not match.\", Toast.LENGTH_LONG).show();\n            return;\n        }\n\n        int checkedId = roleRadioGroup.getCheckedRadioButtonId();\n        if (checkedId == -1) {\n            Toast.makeText(this, \"Please select a role.\", Toast.LENGTH_LONG).show();\n            return;\n        }\n\n        UserRole role;\n        if (checkedId == R.id.radioParent) {\n            role = UserRole.PARENT;\n        } else if (checkedId == R.id.radioProvider) {\n            role = UserRole.PROVIDER;\n        } else {\n            role = UserRole.CHILD;\n        }\n\n        progressBar.setVisibility(View.VISIBLE);\n        registerButton.setEnabled(false);\n\n        timeoutRunnable = () -> {\n            progressBar.setVisibility(View.GONE);\n            registerButton.setEnabled(true);\n            Toast.makeText(RegisterActivity.this, \"Request timed out. Check your connection or Firebase config.\", Toast.LENGTH_LONG).show();\n        };\n        timeoutHandler.postDelayed(timeoutRunnable, 15000);\n\n        authModel.register(email, password, role, new AuthModel.AuthCallback() {\n            @Override\n            public void onSuccess(UserRole r) {\n                timeoutHandler.removeCallbacks(timeoutRunnable);\n                progressBar.setVisibility(View.GONE);\n                registerButton.setEnabled(true);\n                Toast.makeText(RegisterActivity.this, \"Sign up successful.\", Toast.LENGTH_LONG).show();\n                finish();\n            }\n\n            @Override\n            public void onError(String message) {\n                timeoutHandler.removeCallbacks(timeoutRunnable);\n                progressBar.setVisibility(View.GONE);\n                registerButton.setEnabled(true);\n                Toast.makeText(RegisterActivity.this, \"Sign up failed: \" + message, Toast.LENGTH_LONG).show();\n            }\n        });\n    }\n\n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        timeoutHandler.removeCallbacksAndMessages(null);\n    }\n}\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/auth/RegisterActivity.java b/app/src/main/java/com/example/smartair/auth/RegisterActivity.java
+--- a/app/src/main/java/com/example/smartair/auth/RegisterActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/java/com/example/smartair/auth/RegisterActivity.java	(date 1763837644194)
+@@ -15,20 +15,22 @@
+ 
+ import com.example.smartair.R;
+ import com.example.smartair.models.UserRole;
++import com.google.firebase.firestore.FirebaseFirestore;
++
++import java.util.HashMap;
++import java.util.Map;
+ 
+ public class RegisterActivity extends AppCompatActivity {
+ 
+-    private EditText nameEditText;
+-    private EditText emailEditText;
+-    private EditText passwordEditText;
+-    private EditText confirmPasswordEditText;
++    private EditText nameEditText, emailEditText, passwordEditText, confirmPasswordEditText;
+     private RadioGroup roleRadioGroup;
+     private Button registerButton;
+     private ProgressBar progressBar;
+     private TextView backToLoginTextView;
+ 
+     private AuthModel authModel;
+-    private final Handler timeoutHandler = new Handler(Looper.getMainLooper());
++    private FirebaseFirestore db;
++    private Handler timeoutHandler = new Handler(Looper.getMainLooper());
+     private Runnable timeoutRunnable;
+ 
+     @Override
+@@ -46,6 +48,7 @@
+         backToLoginTextView = findViewById(R.id.backToLoginTextView);
+ 
+         authModel = new AuthModel();
++        db = FirebaseFirestore.getInstance();
+ 
+         registerButton.setOnClickListener(v -> register());
+         backToLoginTextView.setOnClickListener(v -> finish());
+@@ -63,12 +66,7 @@
+         }
+ 
+         if (!android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
+-            Toast.makeText(this, "Please enter a valid email address.", Toast.LENGTH_LONG).show();
+-            return;
+-        }
+-
+-        if (password.length() < 6) {
+-            Toast.makeText(this, "Password must be at least 6 characters.", Toast.LENGTH_LONG).show();
++            Toast.makeText(this, "Invalid email address.", Toast.LENGTH_LONG).show();
+             return;
+         }
+ 
+@@ -77,28 +75,20 @@
+             return;
+         }
+ 
++        // 固定写死 role，也可以按界面选择
++        UserRole role = UserRole.CHILD;
+         int checkedId = roleRadioGroup.getCheckedRadioButtonId();
+-        if (checkedId == -1) {
+-            Toast.makeText(this, "Please select a role.", Toast.LENGTH_LONG).show();
+-            return;
+-        }
++        if (checkedId == R.id.radioParent) role = UserRole.PARENT;
++        else if (checkedId == R.id.radioProvider) role = UserRole.PROVIDER;
+ 
+-        UserRole role;
+-        if (checkedId == R.id.radioParent) {
+-            role = UserRole.PARENT;
+-        } else if (checkedId == R.id.radioProvider) {
+-            role = UserRole.PROVIDER;
+-        } else {
+-            role = UserRole.CHILD;
+-        }
+-
+-        progressBar.setVisibility(View.VISIBLE);
++        progressBar.setVisibility(android.view.View.VISIBLE);
+         registerButton.setEnabled(false);
+ 
++        // 超时处理
+         timeoutRunnable = () -> {
+-            progressBar.setVisibility(View.GONE);
++            progressBar.setVisibility(android.view.View.GONE);
+             registerButton.setEnabled(true);
+-            Toast.makeText(RegisterActivity.this, "Request timed out. Check your connection or Firebase config.", Toast.LENGTH_LONG).show();
++            Toast.makeText(RegisterActivity.this, "Request timed out.", Toast.LENGTH_LONG).show();
+         };
+         timeoutHandler.postDelayed(timeoutRunnable, 15000);
+ 
+@@ -106,18 +96,35 @@
+             @Override
+             public void onSuccess(UserRole r) {
+                 timeoutHandler.removeCallbacks(timeoutRunnable);
+-                progressBar.setVisibility(View.GONE);
+-                registerButton.setEnabled(true);
+-                Toast.makeText(RegisterActivity.this, "Sign up successful.", Toast.LENGTH_LONG).show();
+-                finish();
++
++                // 注册成功后把用户信息写入 Firestore
++                String uid = authModel.mAuth.getCurrentUser().getUid();
++                Map<String, Object> userMap = new HashMap<>();
++                userMap.put("name", name);
++                userMap.put("email", email);
++                userMap.put("role", r.getValue()); // ✅ 用枚举 getValue 写入 Firestore
++
++                db.collection("users").document(uid)
++                        .set(userMap)
++                        .addOnSuccessListener(aVoid -> {
++                            progressBar.setVisibility(android.view.View.GONE);
++                            registerButton.setEnabled(true);
++                            Toast.makeText(RegisterActivity.this, "Registration successful!", Toast.LENGTH_LONG).show();
++                            finish(); // 返回登录页
++                        })
++                        .addOnFailureListener(e -> {
++                            progressBar.setVisibility(android.view.View.GONE);
++                            registerButton.setEnabled(true);
++                            Toast.makeText(RegisterActivity.this, "Failed to save user: " + e.getMessage(), Toast.LENGTH_LONG).show();
++                        });
+             }
+ 
+             @Override
+             public void onError(String message) {
+                 timeoutHandler.removeCallbacks(timeoutRunnable);
+-                progressBar.setVisibility(View.GONE);
++                progressBar.setVisibility(android.view.View.GONE);
+                 registerButton.setEnabled(true);
+-                Toast.makeText(RegisterActivity.this, "Sign up failed: " + message, Toast.LENGTH_LONG).show();
++                Toast.makeText(RegisterActivity.this, "Registration failed: " + message, Toast.LENGTH_LONG).show();
+             }
+         });
+     }
+@@ -127,4 +134,4 @@
+         super.onDestroy();
+         timeoutHandler.removeCallbacksAndMessages(null);
+     }
+-}
++}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/HomepageActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/HomepageActivity.java b/app/src/main/java/com/example/smartair/HomepageActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/HomepageActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,61 +0,0 @@
+-package com.example.smartair;
+-
+-import android.content.Intent;
+-import android.os.Bundle;
+-import android.view.View;
+-import android.widget.Button;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-public class HomepageActivity extends AppCompatActivity {
+-
+-    private Button btnLogMedicine;
+-    private Button btnTechnique;
+-    private Button btnPrePostCheck;
+-    private Button btnAddChild;
+-    private Button btnViewChildren;
+-    private Button btnManageChild;
+-    private Button btnManageSharing;
+-    private Button btnBadge; // 只声明，不初始化
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_homepage); // 确保布局文件存在
+-
+-        // 初始化按钮
+-        btnLogMedicine = findViewById(R.id.btnLogMedicine);
+-        btnTechnique = findViewById(R.id.btnTechnique);
+-        btnPrePostCheck = findViewById(R.id.btnPrePostCheck);
+-        btnAddChild = findViewById(R.id.btnAddChild);
+-        btnViewChildren = findViewById(R.id.btnViewChildren);
+-        btnManageChild = findViewById(R.id.btnManageChild);
+-        btnManageSharing = findViewById(R.id.btnManageSharing);
+-        btnBadge = findViewById(R.id.btnBadges); // ✅ 放到这里初始化
+-
+-        // 设置点击事件
+-        btnAddChild.setOnClickListener(v ->
+-                startActivity(new Intent(this, AddChildActivity.class)));
+-
+-        btnViewChildren.setOnClickListener(v ->
+-                startActivity(new Intent(this, ViewChildrenActivity.class)));
+-
+-        btnManageChild.setOnClickListener(v ->
+-                startActivity(new Intent(this, ManageChildActivity.class)));
+-
+-        btnManageSharing.setOnClickListener(v ->
+-                startActivity(new Intent(this, ChooseChildForSharingActivity.class)));
+-
+-        btnLogMedicine.setOnClickListener(v ->
+-                startActivity(new Intent(this, LogMedicineActivity.class)));
+-
+-        btnTechnique.setOnClickListener(v ->
+-                startActivity(new Intent(this, TechniqueActivity.class)));
+-
+-        btnPrePostCheck.setOnClickListener(v ->
+-                startActivity(new Intent(this, PrePostCheckActivity.class)));
+-
+-        btnBadge.setOnClickListener(v ->
+-                startActivity(new Intent(this, BadgeActivity.class)));
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/ChildAdapter.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/ChildAdapter.java b/app/src/main/java/com/example/smartair/ChildAdapter.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/ChildAdapter.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,66 +0,0 @@
+-package com.example.smartair;
+-
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.widget.TextView;
+-import androidx.annotation.NonNull;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import java.util.List;
+-
+-public class ChildAdapter extends RecyclerView.Adapter<ChildAdapter.ChildViewHolder> {
+-
+-    private List<Child> childList;
+-    private OnChildClickListener listener;
+-
+-    // Interface for click handling
+-    public interface OnChildClickListener {
+-        void onChildClick(Child child, String childId);
+-    }
+-
+-    public ChildAdapter(List<Child> childList, OnChildClickListener listener) {
+-        this.childList = childList;
+-        this.listener = listener;
+-    }
+-
+-    @NonNull
+-    @Override
+-    public ChildViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+-        View view = LayoutInflater.from(parent.getContext())
+-                .inflate(R.layout.item_child, parent, false);
+-        return new ChildViewHolder(view);
+-    }
+-
+-    @Override
+-    public void onBindViewHolder(@NonNull ChildViewHolder holder, int position) {
+-        Child child = childList.get(position);
+-
+-        holder.txtChildName.setText(child.getName());
+-        holder.txtChildDOB.setText("DOB: " + child.getDob());
+-        holder.txtChildNotes.setText("Notes: " + child.getNotes());
+-
+-        // Add the click listener(runs when clicked)
+-        holder.itemView.setOnClickListener(v -> {
+-            if (listener != null) {
+-                listener.onChildClick(child, child.getId());
+-            }
+-        });
+-    }
+-
+-    @Override
+-    public int getItemCount() {
+-        return childList.size();
+-    }
+-
+-    public static class ChildViewHolder extends RecyclerView.ViewHolder {
+-        TextView txtChildName, txtChildDOB, txtChildNotes;
+-
+-        public ChildViewHolder(@NonNull View itemView) {
+-            super(itemView);
+-            txtChildName = itemView.findViewById(R.id.txtChildName);
+-            txtChildDOB = itemView.findViewById(R.id.txtChildDOB);
+-            txtChildNotes = itemView.findViewById(R.id.txtChildNotes);
+-        }
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/YoutubePageFragment.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/YoutubePageFragment.java b/app/src/main/java/com/example/smartair/YoutubePageFragment.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/YoutubePageFragment.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,58 +0,0 @@
+-package com.example.smartair;
+-
+-import android.annotation.SuppressLint;
+-import android.os.Bundle;
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.webkit.WebSettings;
+-import android.webkit.WebView;
+-import android.webkit.WebViewClient;
+-
+-import androidx.annotation.NonNull;
+-import androidx.annotation.Nullable;
+-import androidx.fragment.app.Fragment;
+-
+-public class YoutubePageFragment extends Fragment {
+-
+-    private static final String ARG_VIDEO = "arg_video";
+-    private String videoId;
+-
+-    public static YoutubePageFragment newInstance(String videoId) {
+-        YoutubePageFragment f = new YoutubePageFragment();
+-        Bundle b = new Bundle();
+-        b.putString(ARG_VIDEO, videoId);
+-        f.setArguments(b);
+-        return f;
+-    }
+-
+-    @Override
+-    public void onCreate(@Nullable Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        if (getArguments() != null) videoId = getArguments().getString(ARG_VIDEO);
+-    }
+-
+-    @SuppressLint("SetJavaScriptEnabled")
+-    @Nullable
+-    @Override
+-    public View onCreateView(@NonNull LayoutInflater inflater,
+-                             @Nullable ViewGroup container,
+-                             @Nullable Bundle savedInstanceState) {
+-        View v = inflater.inflate(R.layout.fragment_youtube, container, false);
+-        WebView webView = v.findViewById(R.id.youtubeWebView);
+-
+-        WebSettings ws = webView.getSettings();
+-        ws.setJavaScriptEnabled(true);
+-        ws.setDomStorageEnabled(true);
+-        webView.setWebViewClient(new WebViewClient());
+-
+-        // Use YouTube embed (responsive)
+-        String html = "<html><body style='margin:0;padding:0;'><iframe width='100%' height='100%' " +
+-                "src='https://www.youtube.com/embed/" + videoId + "?rel=0&autoplay=0' " +
+-                "frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></body></html>";
+-
+-        webView.loadData(html, "text/html", "utf-8");
+-        return v;
+-    }
+-}
+-
+Index: app/src/main/java/com/example/smartair/TechniqueActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/TechniqueActivity.java b/app/src/main/java/com/example/smartair/TechniqueActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/TechniqueActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,46 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-
+-import androidx.annotation.Nullable;
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.viewpager2.widget.ViewPager2;
+-
+-import com.example.smartair.PageItem;
+-import com.example.smartair.R;
+-
+-import java.util.ArrayList;
+-import java.util.List;
+-
+-public class TechniqueActivity extends AppCompatActivity {
+-
+-    private ViewPager2 viewPager;
+-    private StepsAdapter adapter;
+-
+-    @Override
+-    protected void onCreate(@Nullable Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_technique);
+-
+-        viewPager = findViewById(R.id.viewPager);
+-
+-        // prepare pages: 5 steps + 1 youtube page
+-        List<PageItem> pages = new ArrayList<>();
+-
+-        // step images should be in res/drawable/step1.jpg ... step5.jpg
+-        pages.add(new PageItem(R.drawable.step1, "Step 1 — Get ready: Seal the mouthpiece\n\nImagine your little rocket would leak if air slips out. Put your lips tightly around the mouthpiece—no gaps."));
+-        pages.add(new PageItem(R.drawable.step2, "Step 2 — Empty your lungs: Blow out slowly\n\nBefore pressing your rocket, breathe out all the air like blowing out a birthday candle."));
+-        pages.add(new PageItem(R.drawable.step3, "Step 3 — Fire! Inhale deeply while pressing\n\nPress the inhaler quickly and deeply breathe in for 3–5 seconds so the medicine reaches the lungs."));
+-        pages.add(new PageItem(R.drawable.step4, "Step 4 — Hold the breath\n\nHold your breath for about 10 seconds if you can — this helps the medicine work. If not, hold as long as comfortable (at least 4–5s)."));
+-        pages.add(new PageItem(R.drawable.step5, "Step 5 — Wait before the next puff\n\nIf another puff is needed, wait 30–60 seconds (sing a short song!) then repeat the steps."));
+-
+-        // youtube page special: imageResId = 0 means youtube page (adapter will detect)
+-        pages.add(new PageItem(0, "youtube:Br9irulpbsc"));
+-
+-        adapter = new StepsAdapter(this, pages);
+-        viewPager.setAdapter(adapter);
+-
+-        // Optional: set orientation and offscreen limit
+-        viewPager.setOffscreenPageLimit(1);
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/HomepageParentsActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/HomepageParentsActivity.java b/app/src/main/java/com/example/smartair/HomepageParentsActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/HomepageParentsActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,24 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-
+-import androidx.activity.EdgeToEdge;
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.core.graphics.Insets;
+-import androidx.core.view.ViewCompat;
+-import androidx.core.view.WindowInsetsCompat;
+-
+-public class HomepageParentsActivity extends AppCompatActivity {
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        EdgeToEdge.enable(this);
+-        setContentView(R.layout.activity_homepage_parents);
+-        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {
+-            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
+-            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
+-            return insets;
+-        });
+-    }
+-}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/EnterInviteCodeActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/EnterInviteCodeActivity.java b/app/src/main/java/com/example/smartair/EnterInviteCodeActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/EnterInviteCodeActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,118 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-import android.widget.Button;
+-import android.widget.EditText;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-import com.google.firebase.Timestamp;
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.Date;
+-import java.util.HashMap;
+-import java.util.Map;
+-
+-public class EnterInviteCodeActivity extends AppCompatActivity {
+-
+-    private EditText editInviteCode;
+-    private Button btnRedeem;
+-
+-    private FirebaseFirestore db;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_enter_invite_code);
+-
+-        db = FirebaseFirestore.getInstance();
+-
+-        editInviteCode = findViewById(R.id.editInviteCode);
+-        btnRedeem = findViewById(R.id.btnRedeem);
+-
+-        btnRedeem.setOnClickListener(v -> {
+-            String code = editInviteCode.getText().toString().trim();
+-            if (code.isEmpty()) {
+-                Toast.makeText(this, "Enter the 6-digit code", Toast.LENGTH_SHORT).show();
+-                return;
+-            }
+-            redeemCode(code);
+-        });
+-    }
+-
+-    private void redeemCode(String code) {
+-        String providerId = FirebaseAuth.getInstance().getUid();
+-        if (providerId == null) {
+-            Toast.makeText(this, "You must be signed in", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        db.collection("inviteCodes").document(code)
+-                .get()
+-                .addOnSuccessListener(doc -> {
+-
+-                    if (!doc.exists()) {
+-                        Toast.makeText(this, "Invalid invite code", Toast.LENGTH_SHORT).show();
+-                        return;
+-                    }
+-
+-                    Boolean used = doc.getBoolean("used");
+-                    Date expires = doc.getDate("expires");
+-
+-                    if (used != null && used) {
+-                        Toast.makeText(this, "Code already used", Toast.LENGTH_SHORT).show();
+-                        return;
+-                    }
+-
+-                    if (expires != null && expires.before(new Date())) {
+-                        Toast.makeText(this, "Invite code expired", Toast.LENGTH_SHORT).show();
+-                        return;
+-                    }
+-
+-                    String parentId = doc.getString("parentId");
+-                    String childId = doc.getString("childId");
+-
+-                    if (parentId == null || childId == null) {
+-                        Toast.makeText(this, "Invalid invite data", Toast.LENGTH_SHORT).show();
+-                        return;
+-                    }
+-
+-                    linkProvider(providerId, parentId, childId);
+-
+-                    db.collection("inviteCodes").document(code).update("used", true);
+-                })
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, "Error validating invite code", Toast.LENGTH_SHORT).show()
+-                );
+-    }
+-
+-    private void linkProvider(String providerId, String parentId, String childId) {
+-
+-        Map<String, Object> linkData = new HashMap<>();
+-        linkData.put("parentId", parentId);
+-        linkData.put("childId", childId);
+-        linkData.put("linkedAt", new Date());
+-
+-        // Provider → child link (permanent)
+-        db.collection("providers")
+-                .document(providerId)
+-                .collection("linkedChildren")
+-                .document(childId)
+-                .set(linkData);
+-
+-        // Parent → provider link (for revoke later)
+-        db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .document(childId)
+-                .collection("linkedProviders")
+-                .document(providerId)
+-                .set(linkData)
+-                .addOnSuccessListener(a ->
+-                        Toast.makeText(this, "Child linked successfully!", Toast.LENGTH_LONG).show())
+-                .addOnFailureListener(a ->
+-                        Toast.makeText(this, "Failed to link child", Toast.LENGTH_LONG).show());
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/ManageSharingActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/ManageSharingActivity.java b/app/src/main/java/com/example/smartair/ManageSharingActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/ManageSharingActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,188 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-import android.os.Handler;
+-import android.os.Looper;
+-import android.view.View;
+-import android.widget.CompoundButton;
+-import android.widget.ProgressBar;
+-import android.widget.TextView;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.appcompat.widget.SwitchCompat;
+-import com.google.firebase.firestore.SetOptions;
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.DocumentReference;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.HashMap;
+-import java.util.Map;
+-
+-public class ManageSharingActivity extends AppCompatActivity {
+-
+-    private SwitchCompat switchRescue, switchController, switchSymptoms, switchTriggers;
+-    private SwitchCompat switchPEF, switchTriage, switchCharts;
+-
+-    private TextView tagRescue, tagController, tagSymptoms, tagTriggers;
+-    private TextView tagPEF, tagTriage, tagCharts;
+-
+-    private ProgressBar loadingIndicator;
+-    private TextView textSaving;
+-
+-    private String parentId, childId;
+-    private DocumentReference docRef;
+-    private FirebaseFirestore db;
+-
+-    private boolean isLoading = true;
+-
+-    private Handler debounceHandler = new Handler(Looper.getMainLooper());
+-    private Runnable saveRunnable;
+-    private static final long DEBOUNCE_DELAY = 800;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_manage_sharing);
+-
+-        db = FirebaseFirestore.getInstance();
+-        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+-        childId = getIntent().getStringExtra("childId");
+-
+-        if (childId == null) {
+-            Toast.makeText(this, "Error: No child selected.", Toast.LENGTH_LONG).show();
+-            finish();
+-            return;
+-        }
+-
+-        docRef = db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .document(childId)
+-                .collection("settings")
+-                .document("sharing");
+-
+-        switchRescue = findViewById(R.id.switchRescueLogs);
+-        switchController = findViewById(R.id.switchController);
+-        switchSymptoms = findViewById(R.id.switchSymptoms);
+-        switchTriggers = findViewById(R.id.switchTriggers);
+-        switchPEF = findViewById(R.id.switchPEF);
+-        switchTriage = findViewById(R.id.switchTriage);
+-        switchCharts = findViewById(R.id.switchCharts);
+-
+-        tagRescue = findViewById(R.id.tagRescue);
+-        tagController = findViewById(R.id.tagController);
+-        tagSymptoms = findViewById(R.id.tagSymptoms);
+-        tagTriggers = findViewById(R.id.tagTriggers);
+-        tagPEF = findViewById(R.id.tagPEF);
+-        tagTriage = findViewById(R.id.tagTriage);
+-        tagCharts = findViewById(R.id.tagCharts);
+-
+-        loadingIndicator = findViewById(R.id.loadingIndicator);
+-        textSaving = findViewById(R.id.textSaving);
+-
+-        saveRunnable = this::saveAllSettings;
+-
+-        loadExistingSettings();
+-    }
+-
+-    private void loadExistingSettings() {
+-        loadingIndicator.setVisibility(View.VISIBLE);
+-        textSaving.setVisibility(View.GONE);
+-        isLoading = true;
+-
+-        docRef.get().addOnSuccessListener(doc -> {
+-            if (doc.exists()) {
+-
+-                setToggleState(switchRescue, tagRescue, doc.getBoolean("rescueLogs"));
+-                setToggleState(switchController, tagController, doc.getBoolean("controller"));
+-                setToggleState(switchSymptoms, tagSymptoms, doc.getBoolean("symptoms"));
+-                setToggleState(switchTriggers, tagTriggers, doc.getBoolean("triggers"));
+-                setToggleState(switchPEF, tagPEF, doc.getBoolean("pef"));
+-                setToggleState(switchTriage, tagTriage, doc.getBoolean("triage"));
+-                setToggleState(switchCharts, tagCharts, doc.getBoolean("charts"));
+-            }
+-
+-            isLoading = false;
+-            loadingIndicator.setVisibility(View.GONE);
+-            setupToggleListeners();
+-
+-        }).addOnFailureListener(e -> {
+-            isLoading = false;
+-            loadingIndicator.setVisibility(View.GONE);
+-            setupToggleListeners();
+-            Toast.makeText(this, "Failed to load settings.", Toast.LENGTH_LONG).show();
+-        });
+-    }
+-
+-    private void setToggleState(SwitchCompat sw, TextView tag, Boolean value) {
+-        boolean checked = Boolean.TRUE.equals(value);
+-        sw.setChecked(checked);
+-        tag.setVisibility(checked ? View.VISIBLE : View.GONE);
+-    }
+-
+-    private void setupToggleListeners() {
+-
+-        CompoundButton.OnCheckedChangeListener listener = (buttonView, isChecked) -> {
+-
+-            int id = buttonView.getId();
+-
+-            if (id == R.id.switchRescueLogs) tagRescue.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchController) tagController.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchSymptoms) tagSymptoms.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchTriggers) tagTriggers.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchPEF) tagPEF.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchTriage) tagTriage.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-            else if (id == R.id.switchCharts) tagCharts.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+-
+-            if (!isLoading) {
+-                textSaving.setVisibility(View.VISIBLE);
+-                textSaving.setText("Saving...");
+-
+-                debounceHandler.removeCallbacks(saveRunnable);
+-                debounceHandler.postDelayed(saveRunnable, DEBOUNCE_DELAY);
+-            }
+-        };
+-
+-        switchRescue.setOnCheckedChangeListener(listener);
+-        switchController.setOnCheckedChangeListener(listener);
+-        switchSymptoms.setOnCheckedChangeListener(listener);
+-        switchTriggers.setOnCheckedChangeListener(listener);
+-        switchPEF.setOnCheckedChangeListener(listener);
+-        switchTriage.setOnCheckedChangeListener(listener);
+-        switchCharts.setOnCheckedChangeListener(listener);
+-    }
+-
+-    private void saveAllSettings() {
+-
+-        Map<String, Object> data = new HashMap<>();
+-        data.put("rescueLogs", switchRescue.isChecked());
+-        data.put("controller", switchController.isChecked());
+-        data.put("symptoms", switchSymptoms.isChecked());
+-        data.put("triggers", switchTriggers.isChecked());
+-        data.put("pef", switchPEF.isChecked());
+-        data.put("triage", switchTriage.isChecked());
+-        data.put("charts", switchCharts.isChecked());
+-
+-        docRef.set(data, SetOptions.merge())
+-                .addOnSuccessListener(a -> {
+-                    textSaving.setText("All changes saved!");
+-
+-                    textSaving.postDelayed(() -> {
+-                        textSaving.setVisibility(View.GONE);
+-                        textSaving.setText("Saving...");
+-                    }, 1500);
+-                })
+-                .addOnFailureListener(e -> {
+-                    textSaving.setVisibility(View.GONE);
+-                    Toast.makeText(this, "Error saving settings", Toast.LENGTH_SHORT).show();
+-                });
+-    }
+-
+-
+-    @Override
+-    protected void onDestroy() {
+-        super.onDestroy();
+-        debounceHandler.removeCallbacks(saveRunnable);
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/Child.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/Child.java b/app/src/main/java/com/example/smartair/Child.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/Child.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,31 +0,0 @@
+-package com.example.smartair;
+-
+-public class Child {
+-
+-    private String id;
+-    private String username;
+-    private String password;
+-    private String name;
+-    private String dob;
+-    private String notes;
+-
+-    public Child() {}
+-
+-    public Child(String id, String username, String password, String name, String dob, String notes) {
+-        this.id = id;
+-        this.username = username;
+-        this.password = password;
+-        this.name = name;
+-        this.dob = dob;
+-        this.notes = notes;
+-    }
+-
+-    public String getId() { return id; }
+-    public void setId(String id) { this.id = id; }
+-
+-    public String getUsername() { return username; }
+-    public String getPassword() { return password; }
+-    public String getName() { return name; }
+-    public String getDob() { return dob; }
+-    public String getNotes() { return notes; }
+-}
+Index: app/src/main/java/com/example/smartair/StepFragment.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/StepFragment.java b/app/src/main/java/com/example/smartair/StepFragment.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/StepFragment.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,58 +0,0 @@
+-package com.example.smartair;
+-
+-
+-import android.os.Bundle;
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.widget.ImageView;
+-import android.widget.TextView;
+-
+-import androidx.annotation.NonNull;
+-import androidx.annotation.Nullable;
+-import androidx.fragment.app.Fragment;
+-
+-public class StepFragment extends Fragment {
+-
+-    private static final String ARG_IMG = "arg_img";
+-    private static final String ARG_TEXT = "arg_text";
+-
+-    public static StepFragment newInstance(int imgRes, String text) {
+-        StepFragment f = new StepFragment();
+-        Bundle b = new Bundle();
+-        b.putInt(ARG_IMG, imgRes);
+-        b.putString(ARG_TEXT, text);
+-        f.setArguments(b);
+-        return f;
+-    }
+-
+-    private int imgRes;
+-    private String text;
+-
+-    @Override
+-    public void onCreate(@Nullable Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        if (getArguments() != null) {
+-            imgRes = getArguments().getInt(ARG_IMG);
+-            text = getArguments().getString(ARG_TEXT);
+-        }
+-    }
+-
+-    @Nullable
+-    @Override
+-    public View onCreateView(@NonNull LayoutInflater inflater,
+-                             @Nullable ViewGroup container,
+-                             @Nullable Bundle savedInstanceState) {
+-        View v = inflater.inflate(R.layout.fragment_step, container, false);
+-        ImageView img = v.findViewById(R.id.stepImage);
+-        TextView txt = v.findViewById(R.id.stepText);
+-
+-        if (imgRes != 0) {
+-            img.setImageResource(imgRes);
+-        }
+-        txt.setText(text);
+-
+-        return v;
+-    }
+-}
+-
+Index: app/src/main/java/com/example/smartair/StepsAdapter.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/StepsAdapter.java b/app/src/main/java/com/example/smartair/StepsAdapter.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/StepsAdapter.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,38 +0,0 @@
+-package com.example.smartair;
+-
+-import android.content.Context;
+-
+-import androidx.annotation.NonNull;
+-import androidx.fragment.app.Fragment;
+-import androidx.fragment.app.FragmentActivity;
+-import androidx.viewpager2.adapter.FragmentStateAdapter;
+-
+-import java.util.List;
+-
+-public class StepsAdapter extends FragmentStateAdapter {
+-
+-    private List<PageItem> pages;
+-
+-    public StepsAdapter(@NonNull FragmentActivity fragmentActivity, List<PageItem> pages) {
+-        super(fragmentActivity);
+-        this.pages = pages;
+-    }
+-
+-    @NonNull
+-    @Override
+-    public Fragment createFragment(int position) {
+-        PageItem item = pages.get(position);
+-        if (item.imageRes == 0 && item.text != null && item.text.startsWith("youtube:")) {
+-            String videoId = item.text.substring("youtube:".length());
+-            return YoutubePageFragment.newInstance(videoId);
+-        } else {
+-            return StepFragment.newInstance(item.imageRes, item.text);
+-        }
+-    }
+-
+-    @Override
+-    public int getItemCount() {
+-        return pages.size();
+-    }
+-}
+-
+Index: app/src/main/java/com/example/smartair/BadgeActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/BadgeActivity.java b/app/src/main/java/com/example/smartair/BadgeActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/BadgeActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,93 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.example.smartair.BadgeAdapter;
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.DocumentSnapshot;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.ArrayList;
+-import java.util.List;
+-
+-import androidx.recyclerview.widget.LinearLayoutManager;
+-
+-
+-public class BadgeActivity extends AppCompatActivity {
+-
+-    private RecyclerView rvBadges;
+-    private BadgeAdapter adapter;
+-    private String uid;
+-    private String newBadgeId; // 刚解锁的徽章，用于高亮
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        String newBadge = getIntent().getStringExtra("newBadge");
+-        // newBadge 可能是 "badge_2"，也可能是 null（如果不是从解锁来的）
+-
+-        setContentView(R.layout.activity_badge);
+-
+-        rvBadges = findViewById(R.id.rvBadges);
+-        rvBadges.setLayoutManager(new LinearLayoutManager(this));
+-
+-        uid = FirebaseAuth.getInstance().getCurrentUser().getUid();
+-
+-        // 接收从 medicinelog 传来的新徽章 ID
+-        newBadgeId = getIntent().getStringExtra("newBadge");
+-
+-        loadBadges();
+-    }
+-
+-    private void loadBadges() {
+-        FirebaseFirestore.getInstance()
+-                .collection("users").document(uid)
+-                .collection("badges")
+-                .get()
+-                .addOnSuccessListener(snap -> {
+-
+-                    List<BadgeModel> list = new ArrayList<>();
+-
+-                    for (int i = 1; i <= 5; i++) {
+-                        String id = "badge_" + i;
+-                        DocumentSnapshot doc = snap.getDocuments()
+-                                .stream()
+-                                .filter(d -> d.getId().equals(id))
+-                                .findFirst()
+-                                .orElse(null);
+-
+-                        boolean achieved = doc != null && doc.getBoolean("achieved") != null
+-                                && doc.getBoolean("achieved");
+-
+-                        String time = (doc != null && doc.getTimestamp("firstAchieved") != null)
+-                                ? doc.getTimestamp("firstAchieved").toDate().toString()
+-                                : "——";
+-
+-                        String description = doc != null && doc.getString("description") != null
+-                                ? doc.getString("description")
+-                                : "继续努力，相信你可以做到的！";
+-
+-                        list.add(new BadgeModel(
+-                                id,
+-                                "徽章 " + i,
+-                                achieved,
+-                                time,
+-                                description,
+-                                id.equals(newBadgeId)   // 是否高亮
+-                        ));
+-                    }
+-
+-                    adapter = new BadgeAdapter(list, this);
+-                    rvBadges.setAdapter(adapter);
+-
+-                })
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, "加载徽章失败：" + e.getMessage(),
+-                                Toast.LENGTH_SHORT).show()
+-                );
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/ManageChildActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/ManageChildActivity.java b/app/src/main/java/com/example/smartair/ManageChildActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/ManageChildActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,134 +0,0 @@
+-package com.example.smartair;
+-
+-import androidx.appcompat.app.AlertDialog;
+-
+-import android.content.Intent;
+-import android.os.Bundle;
+-import android.widget.Button;
+-import android.widget.EditText;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.HashMap;
+-import java.util.Map;
+-
+-public class ManageChildActivity extends AppCompatActivity {
+-
+-    private EditText editChildUsername, editChildPassword;
+-    private EditText editChildName, editChildDOB, editChildNotes;
+-    private Button btnSave, btnDelete, btnInviteProvider;
+-    private Button btnManageSharing;
+-    private String childId, parentId;
+-    private FirebaseFirestore db;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_manage_child);
+-
+-        db = FirebaseFirestore.getInstance();
+-        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+-
+-        childId = getIntent().getStringExtra("childId");
+-        String username = getIntent().getStringExtra("username");
+-        String password = getIntent().getStringExtra("password");
+-        String name = getIntent().getStringExtra("name");
+-        String dob = getIntent().getStringExtra("dob");
+-        String notes = getIntent().getStringExtra("notes");
+-
+-        editChildUsername = findViewById(R.id.editChildUsername);
+-        editChildPassword = findViewById(R.id.editChildPassword);
+-        editChildName = findViewById(R.id.editChildName);
+-        editChildDOB = findViewById(R.id.editChildDOB);
+-        editChildNotes = findViewById(R.id.editChildNotes);
+-        btnSave = findViewById(R.id.btnSave);
+-        btnDelete = findViewById(R.id.btnDelete);
+-
+-        btnManageSharing = findViewById(R.id.btnManageSharing);
+-        btnInviteProvider = findViewById(R.id.btnInviteProvider);
+-
+-        btnManageSharing.setOnClickListener(v -> {
+-            Intent intent = new Intent(ManageChildActivity.this, ManageSharingActivity.class);
+-            intent.putExtra("childId", childId);
+-            startActivity(intent);
+-        });
+-        btnInviteProvider.setOnClickListener(v -> {
+-            Intent intent = new Intent(ManageChildActivity.this, InviteProviderActivity.class);
+-            intent.putExtra("CHILD_ID", childId);
+-            startActivity(intent);
+-        });
+-
+-        editChildUsername.setText(username);
+-        editChildPassword.setText(password);
+-        editChildName.setText(name);
+-        editChildDOB.setText(dob);
+-        editChildNotes.setText(notes);
+-
+-        btnSave.setOnClickListener(v -> updateChild());
+-
+-        btnDelete.setOnClickListener(v -> showDeleteConfirmationDialog());
+-    }
+-
+-    private void updateChild() {
+-        String name = editChildName.getText().toString().trim();
+-        String username = editChildUsername.getText().toString().trim();
+-        String password = editChildPassword.getText().toString().trim();
+-
+-        if (name.isEmpty()) {
+-            Toast.makeText(this, "Child name cannot be empty.", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-        if (username.isEmpty() || password.isEmpty()) {
+-            Toast.makeText(this, "Username and password cannot be empty.", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        Map<String, Object> updates = new HashMap<>();
+-        updates.put("username", username);
+-        updates.put("password", password);
+-        updates.put("name", name);
+-        updates.put("dob", editChildDOB.getText().toString().trim());
+-        updates.put("notes", editChildNotes.getText().toString().trim());
+-
+-        db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .document(childId)
+-                .update(updates)
+-                .addOnSuccessListener(a ->
+-                        Toast.makeText(this, "Child updated!", Toast.LENGTH_SHORT).show())
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, e.getMessage(), Toast.LENGTH_LONG).show());
+-    }
+-
+-    private void showDeleteConfirmationDialog() {
+-        new AlertDialog.Builder(this)
+-                .setTitle("Delete Child")
+-                .setMessage("Are you sure you want to permanently delete this child's profile?")
+-                .setIcon(android.R.drawable.ic_dialog_alert)
+-                .setPositiveButton("Delete", (dialog, which) -> {
+-                    deleteChild();
+-                })
+-                .setNegativeButton("Cancel", null)
+-                .show();
+-    }
+-
+-
+-    private void deleteChild() {
+-        db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .document(childId)
+-                .delete()
+-                .addOnSuccessListener(a -> {
+-                    Toast.makeText(this, "Child deleted.", Toast.LENGTH_SHORT).show();
+-                    finish();
+-                })
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, e.getMessage(), Toast.LENGTH_LONG).show());
+-    }
+-}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/ViewChildrenActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/ViewChildrenActivity.java b/app/src/main/java/com/example/smartair/ViewChildrenActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/ViewChildrenActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,98 +0,0 @@
+-package com.example.smartair;
+-
+-import androidx.annotation.Nullable;
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.recyclerview.widget.LinearLayoutManager;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import android.os.Bundle;
+-import android.widget.Toast;
+-import android.content.Intent;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.auth.FirebaseUser;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-import com.google.firebase.firestore.QueryDocumentSnapshot;
+-
+-import java.util.ArrayList;
+-import java.util.List;
+-
+-public class ViewChildrenActivity extends AppCompatActivity {
+-
+-    private RecyclerView recyclerChildren;
+-    private ChildAdapter adapter;
+-    private List<Child> childList = new ArrayList<>();
+-
+-    private FirebaseFirestore db;
+-    private FirebaseAuth auth;
+-    private FirebaseUser user;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.view_children_activity);
+-
+-        recyclerChildren = findViewById(R.id.recyclerChildren);
+-        recyclerChildren.setLayoutManager(new LinearLayoutManager(this));
+-
+-        adapter = new ChildAdapter(childList, (child, childId) -> {
+-            Intent intent = new Intent(ViewChildrenActivity.this, ManageChildActivity.class);
+-            intent.putExtra("childId", childId);
+-            intent.putExtra("username", child.getUsername());
+-            intent.putExtra("password", child.getPassword());
+-            intent.putExtra("name", child.getName());
+-            intent.putExtra("dob", child.getDob());
+-            intent.putExtra("notes", child.getNotes());
+-            startActivity(intent);
+-        });
+-
+-
+-
+-
+-        recyclerChildren.setAdapter(adapter);
+-
+-        db = FirebaseFirestore.getInstance();
+-        auth = FirebaseAuth.getInstance();
+-        user = auth.getCurrentUser();
+-
+-        // IMPORTANT: check login
+-        if (user == null) {
+-            Toast.makeText(this, "Please log in first.", Toast.LENGTH_SHORT).show();
+-            finish();
+-            return;
+-        }
+-
+-        loadChildren();
+-    }
+-
+-    private void loadChildren() {
+-        String parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+-
+-        db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .addSnapshotListener((querySnapshot, error) -> {
+-
+-                    if (error != null) {
+-                        Toast.makeText(this, "Error loading children.", Toast.LENGTH_SHORT).show();
+-                        return;
+-                    }
+-
+-                    childList.clear();
+-
+-                    if (querySnapshot == null || querySnapshot.isEmpty()) {
+-                        Toast.makeText(this, "No children found.", Toast.LENGTH_SHORT).show();
+-                        adapter.notifyDataSetChanged();
+-                        return;
+-                    }
+-
+-                    for (QueryDocumentSnapshot doc : querySnapshot) {
+-                        Child child = doc.toObject(Child.class);
+-                        child.setId(doc.getId());
+-                        childList.add(child);
+-                    }
+-
+-                    adapter.notifyDataSetChanged();
+-                });
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/BadgeAdapter.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/BadgeAdapter.java b/app/src/main/java/com/example/smartair/BadgeAdapter.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/BadgeAdapter.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,82 +0,0 @@
+-package com.example.smartair;
+-
+-import android.content.Context;
+-import android.graphics.Color;
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.widget.ImageView;
+-import android.widget.TextView;
+-
+-import androidx.annotation.NonNull;
+-import androidx.cardview.widget.CardView;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import java.util.List;
+-
+-public class BadgeAdapter extends RecyclerView.Adapter<BadgeAdapter.ViewHolder> {
+-
+-    private List<BadgeModel> list;
+-    private Context ctx;
+-
+-    public BadgeAdapter(List<BadgeModel> list, Context ctx) {
+-        this.list = list;
+-        this.ctx = ctx;
+-    }
+-
+-    @NonNull
+-    @Override
+-    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+-        View view = LayoutInflater.from(ctx).inflate(R.layout.badge_item, parent, false);
+-        return new ViewHolder(view);
+-    }
+-
+-    @Override
+-    public void onBindViewHolder(@NonNull ViewHolder h, int pos) {
+-        BadgeModel b = list.get(pos);
+-
+-        // 设置图片
+-        int imgRes = ctx.getResources().getIdentifier(b.id, "drawable", ctx.getPackageName());
+-        h.ivBadge.setImageResource(imgRes);
+-
+-        // 标题
+-        h.tvBadgeTitle.setText(b.title);
+-
+-        // 是否获得
+-        h.tvAchieved.setText("已获得：" + (b.achieved ? "是" : "否"));
+-
+-        // 第一次获得时间
+-        h.tvFirstTime.setText("第一次获得：" + b.firstTime);
+-
+-        // 描述
+-        h.tvDescription.setText(b.description);
+-
+-        // 是否高亮（新徽章）
+-        if (b.highlight) {
+-            h.card.setCardBackgroundColor(Color.parseColor("#FFF59D")); // 黄色高亮
+-        } else {
+-            h.card.setCardBackgroundColor(Color.WHITE);
+-        }
+-    }
+-
+-    @Override
+-    public int getItemCount() {
+-        return list.size();
+-    }
+-
+-    static class ViewHolder extends RecyclerView.ViewHolder {
+-        ImageView ivBadge;
+-        TextView tvBadgeTitle, tvAchieved, tvFirstTime, tvDescription;
+-        CardView card;
+-
+-        public ViewHolder(@NonNull View itemView) {
+-            super(itemView);
+-            ivBadge = itemView.findViewById(R.id.ivBadge);
+-            tvBadgeTitle = itemView.findViewById(R.id.tvBadgeTitle);
+-            tvAchieved = itemView.findViewById(R.id.tvAchieved);
+-            tvFirstTime = itemView.findViewById(R.id.tvFirstTime);
+-            tvDescription = itemView.findViewById(R.id.tvDescription);
+-            card = itemView.findViewById(R.id.cardBadge);
+-        }
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/BadgeModel.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/BadgeModel.java b/app/src/main/java/com/example/smartair/BadgeModel.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/BadgeModel.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,20 +0,0 @@
+-package com.example.smartair;
+-
+-public class BadgeModel {
+-    public String id;
+-    public String title;
+-    public boolean achieved;
+-    public String firstTime;
+-    public String description;
+-    public boolean highlight;
+-
+-    public BadgeModel(String id, String title, boolean achieved, String firstTime,
+-                      String description, boolean highlight) {
+-        this.id = id;
+-        this.title = title;
+-        this.achieved = achieved;
+-        this.firstTime = firstTime;
+-        this.description = description;
+-        this.highlight = highlight;
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/HomepageProvidersActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/HomepageProvidersActivity.java b/app/src/main/java/com/example/smartair/HomepageProvidersActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/HomepageProvidersActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,24 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-
+-import androidx.activity.EdgeToEdge;
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.core.graphics.Insets;
+-import androidx.core.view.ViewCompat;
+-import androidx.core.view.WindowInsetsCompat;
+-
+-public class HomepageProvidersActivity extends AppCompatActivity {
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        EdgeToEdge.enable(this);
+-        setContentView(R.layout.activity_homepage_providers);
+-        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {
+-            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
+-            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
+-            return insets;
+-        });
+-    }
+-}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/ChooseChildForSharingActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/ChooseChildForSharingActivity.java b/app/src/main/java/com/example/smartair/ChooseChildForSharingActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/ChooseChildForSharingActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,79 +0,0 @@
+-package com.example.smartair;
+-
+-import android.content.Intent;
+-import android.os.Bundle;
+-import android.view.View;
+-import android.widget.ProgressBar;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.recyclerview.widget.LinearLayoutManager;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-import com.google.firebase.firestore.QueryDocumentSnapshot;
+-
+-import java.util.ArrayList;
+-import java.util.List;
+-
+-public class ChooseChildForSharingActivity extends AppCompatActivity {
+-
+-    private RecyclerView recyclerChildren;
+-    private ChildAdapter adapter;
+-    private List<Child> childList = new ArrayList<>();
+-    private ProgressBar loadingIndicator;
+-
+-    private FirebaseFirestore db;
+-    private String parentId;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_choose_child_for_sharing);
+-
+-        db = FirebaseFirestore.getInstance();
+-        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+-        loadingIndicator = findViewById(R.id.loadingIndicator);
+-        recyclerChildren = findViewById(R.id.recyclerChildren);
+-        recyclerChildren.setLayoutManager(new LinearLayoutManager(this));
+-        adapter = new ChildAdapter(childList, (child, childId) -> {
+-            Intent intent = new Intent(this, ManageSharingActivity.class);
+-            intent.putExtra("childId", childId);
+-            startActivity(intent);
+-        });
+-        recyclerChildren.setAdapter(adapter);
+-        loadChildren();
+-    }
+-
+-    private void loadChildren() {
+-        loadingIndicator.setVisibility(View.VISIBLE);
+-        recyclerChildren.setVisibility(View.GONE);
+-
+-        db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .get()
+-                .addOnSuccessListener(snapshot -> {
+-                    loadingIndicator.setVisibility(View.GONE);
+-                    recyclerChildren.setVisibility(View.VISIBLE);
+-                    if (snapshot.isEmpty()) {
+-                        Toast.makeText(this, "No children added yet!", Toast.LENGTH_LONG).show();
+-                        finish();
+-                        return;
+-                    }
+-
+-                    childList.clear();
+-                    for (QueryDocumentSnapshot doc : snapshot) {
+-                        Child child = doc.toObject(Child.class);
+-                        child.setId(doc.getId());
+-                        childList.add(child);
+-                    }
+-                    adapter.notifyDataSetChanged();
+-                })
+-                .addOnFailureListener(e -> {
+-                    loadingIndicator.setVisibility(View.GONE);
+-                    Toast.makeText(this, "Error loading children: " + e.getMessage(), Toast.LENGTH_LONG).show();
+-                });
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/InviteProviderActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/InviteProviderActivity.java b/app/src/main/java/com/example/smartair/InviteProviderActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/InviteProviderActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,194 +0,0 @@
+-package com.example.smartair;
+-
+-import android.graphics.Color;
+-import android.os.Bundle;
+-import android.view.View;
+-import android.widget.Button;
+-import android.widget.TextView;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.Calendar;
+-import java.util.Date;
+-import java.util.HashMap;
+-import java.util.Map;
+-import java.util.Random;
+-
+-public class InviteProviderActivity extends AppCompatActivity {
+-
+-    private Button btnGenerateCode, btnRevoke;
+-    private TextView textInviteCode, textHint, textStatus;
+-
+-    private FirebaseFirestore db;
+-    private String parentId;
+-    private String childId;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_invite_provider);
+-
+-        db = FirebaseFirestore.getInstance();
+-
+-
+-        btnGenerateCode = findViewById(R.id.btnGenerateCode);
+-        btnRevoke = findViewById(R.id.btnRevoke);
+-        textInviteCode = findViewById(R.id.textInviteCode);
+-        textHint = findViewById(R.id.textHint);
+-        textStatus = findViewById(R.id.textStatusLabel);
+-
+-        parentId = FirebaseAuth.getInstance().getUid();
+-        childId = getIntent().getStringExtra("CHILD_ID");
+-
+-        if (parentId == null || childId == null) {
+-            Toast.makeText(this, "Error: Missing IDs", Toast.LENGTH_SHORT).show();
+-            finish();
+-            return;
+-        }
+-
+-        btnGenerateCode.setOnClickListener(v -> generateInviteCode());
+-        btnRevoke.setOnClickListener(v -> revokeInviteCode());
+-
+-        checkForExistingCode();
+-    }
+-
+-
+-    private void checkForExistingCode() {
+-        // Check the CHILD'S profile (Local)
+-        db.collection("parents").document(parentId)
+-                .collection("children").document(childId)
+-                .collection("invite").document("current")
+-                .get()
+-                .addOnSuccessListener(doc -> {
+-                    if (doc.exists()) {
+-                        String code = doc.getString("code");
+-                        validateGlobalCode(code);
+-                    } else {
+-                        updateUI(false, null);
+-                    }
+-                });
+-    }
+-
+-    private void validateGlobalCode(String code) {
+-        if (code == null) return;
+-
+-        db.collection("inviteCodes").document(code).get()
+-                .addOnSuccessListener(globalDoc -> {
+-                    if (globalDoc.exists()) {
+-                        Date expires = globalDoc.getDate("expires");
+-
+-                        // "Valid 7 Days" Requirement check
+-                        if (expires != null && expires.after(new Date())) {
+-                            showInviteCode(code);
+-                        } else {
+-                            deleteLocalInvite();
+-                        }
+-                    } else {
+-                        deleteLocalInvite();
+-                    }
+-                });
+-    }
+-
+-    private void deleteLocalInvite() {
+-        db.collection("parents").document(parentId)
+-                .collection("children").document(childId)
+-                .collection("invite").document("current")
+-                .delete();
+-
+-        updateUI(false, null);
+-    }
+-
+-    private void generateInviteCode() {
+-        revokeInviteCodeInternal(() -> {
+-
+-            String code = String.valueOf(100000 + new Random().nextInt(900000));
+-
+-            Calendar c = Calendar.getInstance();
+-            c.add(Calendar.DAY_OF_YEAR, 7);
+-            Date expiryDate = c.getTime();
+-
+-            Map<String, Object> data = new HashMap<>();
+-            data.put("parentId", parentId);
+-            data.put("childId", childId);
+-            data.put("used", false);
+-            data.put("expires", expiryDate);
+-
+-            db.collection("inviteCodes").document(code)
+-                    .set(data)
+-                    .addOnSuccessListener(a -> {
+-
+-                        Map<String, Object> local = new HashMap<>();
+-                        local.put("code", code);
+-
+-                        db.collection("parents").document(parentId)
+-                                .collection("children").document(childId)
+-                                .collection("invite").document("current")
+-                                .set(local)
+-                                .addOnSuccessListener(v -> showInviteCode(code));
+-                    })
+-                    .addOnFailureListener(e ->
+-                            Toast.makeText(this, "Failed to generate code", Toast.LENGTH_SHORT).show()
+-                    );
+-        });
+-    }
+-
+-    private void revokeInviteCode() {
+-        revokeInviteCodeInternal(null);
+-        Toast.makeText(this, "Access revoked.", Toast.LENGTH_SHORT).show();
+-    }
+-
+-    private void revokeInviteCodeInternal(Runnable onFinished) {
+-        db.collection("parents").document(parentId)
+-                .collection("children").document(childId)
+-                .collection("invite").document("current")
+-                .get()
+-                .addOnSuccessListener(doc -> {
+-                    if (doc.exists()) {
+-                        String code = doc.getString("code");
+-
+-                        if (code != null) {
+-                            db.collection("inviteCodes").document(code).delete();
+-                        }
+-                        doc.getReference().delete();
+-
+-                        updateUI(false, null);
+-                    }
+-
+-                    if (onFinished != null) onFinished.run();
+-                });
+-    }
+-
+-    private void showInviteCode(String code) {
+-        updateUI(true, code);
+-    }
+-
+-    private void updateUI(boolean isActive, String code) {
+-        if (isActive) {
+-            textInviteCode.setText(code);
+-            textInviteCode.setVisibility(View.VISIBLE);
+-            textHint.setVisibility(View.VISIBLE);
+-
+-            if (btnRevoke != null) btnRevoke.setVisibility(View.VISIBLE);
+-            btnGenerateCode.setText("Regenerate Code");
+-            if (textStatus != null) {
+-                textStatus.setText("Status: Active (Shared)");
+-                textStatus.setTextColor(Color.parseColor("#4CAF50")); // Green
+-            }
+-        } else {
+-            textInviteCode.setVisibility(View.GONE);
+-            textHint.setVisibility(View.GONE);
+-
+-            if (btnRevoke != null) btnRevoke.setVisibility(View.GONE);
+-            btnGenerateCode.setText("Generate Invite Code");
+-
+-            if (textStatus != null) {
+-                textStatus.setText("Status: Not Shared");
+-                textStatus.setTextColor(Color.GRAY);
+-            }
+-        }
+-    }
+-}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/PageItem.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/PageItem.java b/app/src/main/java/com/example/smartair/PageItem.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/PageItem.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,14 +0,0 @@
+-package com.example.smartair;
+-
+-
+-
+-public class PageItem {
+-    public int imageRes; // 0 => special (youtube)
+-    public String text;  // for youtube page we store "youtube:VIDEO_ID"
+-
+-    public PageItem(int imageRes, String text) {
+-        this.imageRes = imageRes;
+-        this.text = text;
+-    }
+-}
+-
+Index: app/src/main/java/com/example/smartair/PrePostCheckActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/PrePostCheckActivity.java b/app/src/main/java/com/example/smartair/PrePostCheckActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/PrePostCheckActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,183 +0,0 @@
+-package com.example.smartair;
+-
+-import android.content.Intent;
+-import android.os.Bundle;
+-import android.text.TextUtils;
+-import android.view.View;
+-import android.widget.Button;
+-import android.widget.EditText;
+-import android.widget.RatingBar;
+-import android.widget.RadioButton;
+-import android.widget.RadioGroup;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AlertDialog;
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.recyclerview.widget.LinearLayoutManager;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.auth.FirebaseUser;
+-import com.google.firebase.firestore.CollectionReference;
+-import com.google.firebase.firestore.DocumentSnapshot;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.text.SimpleDateFormat;
+-import java.util.Date;
+-import java.util.HashMap;
+-import java.util.Locale;
+-
+-public class PrePostCheckActivity extends AppCompatActivity {
+-
+-    private RadioGroup rgWhen;
+-    private RadioGroup rgResult;
+-    private RatingBar ratingBar;
+-    private EditText etNote;
+-    private Button btnSubmit;
+-    private RecyclerView rvCheckHistory;
+-    private PrePostCheckAdapter adapter;
+-    private SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+-
+-    private FirebaseAuth auth;
+-    private FirebaseFirestore db;
+-    private CollectionReference checkRef;
+-    private FirebaseUser user;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_pre_post_check);
+-
+-        rgWhen = findViewById(R.id.rgWhen);
+-        rgResult = findViewById(R.id.rgResult);
+-        ratingBar = findViewById(R.id.ratingBar);
+-        etNote = findViewById(R.id.etNote);
+-        btnSubmit = findViewById(R.id.btnSubmitCheck);
+-        rvCheckHistory = findViewById(R.id.rvCheckHistory);
+-
+-        auth = FirebaseAuth.getInstance();
+-        db = FirebaseFirestore.getInstance();
+-        user = auth.getCurrentUser();
+-        if (user == null) {
+-            Toast.makeText(this, "请先登录", Toast.LENGTH_SHORT).show();
+-            finish();
+-            return;
+-        }
+-
+-        checkRef = db.collection("users")
+-                .document(user.getUid())
+-                .collection("prepost_checks");
+-
+-        // 初始化 RecyclerView
+-        adapter = new PrePostCheckAdapter();
+-        rvCheckHistory.setAdapter(adapter);
+-        rvCheckHistory.setLayoutManager(new LinearLayoutManager(this));
+-
+-        // 读取历史记录
+-        checkRef.orderBy("timestamp").limit(50).get()
+-                .addOnSuccessListener(queryDocumentSnapshots -> adapter.setChecks(queryDocumentSnapshots.getDocuments()))
+-                .addOnFailureListener(e -> Toast.makeText(this, "读取历史失败: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+-
+-        btnSubmit.setOnClickListener(view -> submitCheck());
+-    }
+-
+-    private void submitCheck() {
+-        int whenId = rgWhen.getCheckedRadioButtonId();
+-        int resId = rgResult.getCheckedRadioButtonId();
+-        if (whenId == -1 || resId == -1) {
+-            Toast.makeText(this, "请选择 Before/After 和 Better/Same/Worse", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        String when = ((RadioButton) findViewById(whenId)).getText().toString();
+-        String result = ((RadioButton) findViewById(resId)).getText().toString();
+-        float rating = ratingBar.getRating();
+-        String note = etNote.getText().toString();
+-
+-        String uid = user.getUid();
+-        String email = user.getEmail();
+-        long now = System.currentTimeMillis();
+-
+-        HashMap<String, Object> data = new HashMap<>();
+-        data.put("uid", uid);
+-        data.put("email", email);
+-        data.put("when", when);
+-        data.put("result", result);
+-        data.put("rating", rating);
+-        data.put("note", note);
+-        data.put("timestamp", now);
+-
+-        btnSubmit.setEnabled(false);
+-        checkRef.add(data).addOnSuccessListener(documentReference -> {
+-            btnSubmit.setEnabled(true);
+-            Toast.makeText(this, "评估已保存", Toast.LENGTH_SHORT).show();
+-
+-            // 自动检查徽章
+-            checkAndUnlockBadge(uid);
+-
+-            // 将刚提交的数据直接插入 RecyclerView
+-            documentReference.get().addOnSuccessListener(doc -> adapter.addCheck(doc));
+-
+-            ratingBar.setRating(0);
+-            etNote.setText("");
+-        }).addOnFailureListener(e -> {
+-            btnSubmit.setEnabled(true);
+-            Toast.makeText(this, "保存失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+-        });
+-    }
+-
+-    private void checkAndUnlockBadge(String uid) {
+-        db.collection("users")
+-                .document(uid)
+-                .collection("prepost_checks")
+-                .whereGreaterThanOrEqualTo("rating", 4)
+-                .get()
+-                .addOnSuccessListener(snap -> {
+-                    if (snap.size() >= 5) {
+-                        unlockBadge(uid);
+-                    }
+-                })
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, "检查徽章失败: " + e.getMessage(), Toast.LENGTH_SHORT).show()
+-                );
+-    }
+-
+-    private void unlockBadge(String uid) {
+-        db.collection("users")
+-                .document(uid)
+-                .collection("badges")
+-                .document("badge_1")
+-                .get()
+-                .addOnSuccessListener(doc -> {
+-                    if (doc.exists()) return; // 已经解锁过，不重复弹窗
+-
+-                    HashMap<String, Object> data = new HashMap<>();
+-                    data.put("unlocked", true);
+-                    data.put("timestamp", System.currentTimeMillis());
+-                    data.put("description", "有 5 次呼吸评分都达到 4 分以上，说明你越来越懂得照顾自己了！");
+-
+-                    db.collection("users")
+-                            .document(uid)
+-                            .collection("badges")
+-                            .document("badge_1")
+-                            .set(data);
+-
+-                    showBadgePopup();
+-                });
+-    }
+-
+-    private void showBadgePopup() {
+-        AlertDialog.Builder builder = new AlertDialog.Builder(this);
+-        builder.setTitle("🎉 恭喜获得徽章！");
+-        builder.setMessage("你已经连续获得 5 次高评分呼吸记录！");
+-
+-        builder.setPositiveButton("查看徽章", (dialog, which) -> {
+-            Intent intent = new Intent(this, BadgeActivity.class);
+-            intent.putExtra("newBadge", "badge_2");
+-            startActivity(intent);
+-        });
+-
+-        builder.setNegativeButton("关闭", null);
+-        builder.show();
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/AddChildActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/AddChildActivity.java b/app/src/main/java/com/example/smartair/AddChildActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/AddChildActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,162 +0,0 @@
+-package com.example.smartair;
+-
+-import android.app.DatePickerDialog;
+-import android.content.Intent;
+-import android.os.Bundle;
+-import android.widget.Button;
+-import android.widget.EditText;
+-import android.widget.TextView;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.auth.FirebaseUser;
+-import com.google.firebase.firestore.DocumentReference;
+-import com.google.firebase.firestore.FieldValue;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-import com.google.firebase.firestore.WriteBatch;
+-
+-import java.util.Calendar;
+-import java.util.HashMap;
+-import java.util.Map;
+-
+-public class AddChildActivity extends AppCompatActivity {
+-
+-    private EditText editChildUsername, editChildPassword;
+-    private EditText editChildName, editChildNotes;
+-    private Button btnAddChild;
+-
+-    // Date Picker UI
+-    private TextView textDOB;
+-    private Button btnPickDate;
+-    private String selectedDOB = "";
+-
+-    private FirebaseFirestore db;
+-    private FirebaseAuth auth;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_add_child);
+-
+-        db = FirebaseFirestore.getInstance();
+-        auth = FirebaseAuth.getInstance();
+-
+-        if (auth.getCurrentUser() == null) {
+-            Toast.makeText(this, "Please log in first.", Toast.LENGTH_SHORT).show();
+-            finish();
+-            return;
+-        }
+-
+-        editChildUsername = findViewById(R.id.editChildUsername);
+-        editChildPassword = findViewById(R.id.editChildPassword);
+-        editChildName = findViewById(R.id.editChildName);
+-        editChildNotes = findViewById(R.id.editChildNotes);
+-        btnAddChild = findViewById(R.id.btnAddChild);
+-
+-        textDOB = findViewById(R.id.textDOB);
+-        btnPickDate = findViewById(R.id.btnPickDate);
+-
+-        btnPickDate.setOnClickListener(v -> showDatePickerDialog());
+-        btnAddChild.setOnClickListener(v -> checkUsernameAndAddChild());
+-    }
+-
+-    private void showDatePickerDialog() {
+-        final Calendar c = Calendar.getInstance();
+-        int year = c.get(Calendar.YEAR);
+-        int month = c.get(Calendar.MONTH);
+-        int day = c.get(Calendar.DAY_OF_MONTH);
+-
+-        DatePickerDialog.OnDateSetListener dateSetListener = (view, yearPicked, monthPicked, dayPicked) -> {
+-            int monthActual = monthPicked + 1;
+-            selectedDOB = String.format("%02d/%02d/%d", dayPicked, monthActual, yearPicked);
+-            textDOB.setText("Date of Birth: " + selectedDOB);
+-        };
+-
+-        DatePickerDialog datePickerDialog = new DatePickerDialog(this, dateSetListener, year, month, day);
+-        datePickerDialog.getDatePicker().setMaxDate(System.currentTimeMillis());
+-        datePickerDialog.show();
+-    }
+-
+-    private void checkUsernameAndAddChild() {
+-        String username = editChildUsername.getText().toString().trim();
+-        String password = editChildPassword.getText().toString().trim();
+-        String name = editChildName.getText().toString().trim();
+-        String dob = selectedDOB;
+-        String notes = editChildNotes.getText().toString().trim();
+-
+-        if (username.isEmpty() || password.isEmpty()) {
+-            Toast.makeText(this, "Please enter username and password.", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        if (name.isEmpty() || dob.isEmpty()) {
+-            Toast.makeText(this, "Please enter name and select DOB.", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        FirebaseUser user = auth.getCurrentUser();
+-        if (user == null) {
+-            Toast.makeText(this, "Session expired. Please log in.", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        DocumentReference usernameRef = db.collection("usernames").document(username);
+-
+-        usernameRef.get().addOnSuccessListener(doc -> {
+-            if (doc.exists()) {
+-                Toast.makeText(this, "Username '" + username + "' is already taken.", Toast.LENGTH_LONG).show();
+-            } else {
+-                saveChildWithBatch(user.getUid(), username, password, name, dob, notes);
+-            }
+-        }).addOnFailureListener(e ->
+-                Toast.makeText(this, "Error checking username: " + e.getMessage(), Toast.LENGTH_SHORT).show()
+-        );
+-    }
+-
+-    private void saveChildWithBatch(String parentId, String username, String password, String name, String dob, String notes) {
+-
+-        Map<String, Object> childData = new HashMap<>();
+-        childData.put("username", username);
+-        childData.put("password", password);
+-        childData.put("name", name);
+-        childData.put("dob", dob);
+-        childData.put("notes", notes);
+-        childData.put("createdAt", FieldValue.serverTimestamp());
+-
+-        WriteBatch batch = db.batch();
+-        DocumentReference newChildRef = db.collection("parents")
+-                .document(parentId)
+-                .collection("children")
+-                .document();
+-
+-        DocumentReference usernameRef = db.collection("usernames").document(username);
+-        Map<String, Object> usernameData = new HashMap<>();
+-        usernameData.put("isTaken", true);
+-        usernameData.put("parentId", parentId);
+-        usernameData.put("childId", newChildRef.getId());
+-
+-        batch.set(newChildRef, childData);
+-        batch.set(usernameRef, usernameData);
+-
+-        batch.commit()
+-                .addOnSuccessListener(aVoid -> {
+-                    Toast.makeText(this, "Child added successfully!", Toast.LENGTH_SHORT).show();
+-
+-                    editChildUsername.setText("");
+-                    editChildPassword.setText("");
+-                    editChildName.setText("");
+-                    editChildNotes.setText("");
+-                    textDOB.setText("Date of Birth: Not Set");
+-                    selectedDOB = "";
+-
+-                    Intent intent = new Intent(AddChildActivity.this, ViewChildrenActivity.class);
+-                    startActivity(intent);
+-                    finish();
+-                })
+-                .addOnFailureListener(e ->
+-                        Toast.makeText(this, "Error saving child: " + e.getMessage(), Toast.LENGTH_SHORT).show()
+-                );
+-    }
+-}
+\ No newline at end of file
+Index: app/src/main/java/com/example/smartair/SignUpActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/SignUpActivity.java b/app/src/main/java/com/example/smartair/SignUpActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/SignUpActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,77 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-import android.widget.Button;
+-import android.widget.EditText;
+-import android.widget.RadioButton;
+-import android.widget.RadioGroup;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.HashMap;
+-import java.util.Map;
+-
+-public class SignUpActivity extends AppCompatActivity {
+-    private EditText etEmail, etPassword;
+-    private Button btnRegister;
+-    private RadioGroup rgRole;
+-    private FirebaseAuth mAuth;
+-    private FirebaseFirestore db;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_sign_up);
+-
+-        etEmail = findViewById(R.id.etEmail);
+-        etPassword = findViewById(R.id.etPassword);
+-        btnRegister = findViewById(R.id.btnRegister);
+-        rgRole = findViewById(R.id.rgRole);
+-
+-        mAuth = FirebaseAuth.getInstance();
+-        db = FirebaseFirestore.getInstance();
+-
+-        btnRegister.setOnClickListener(v -> registerUser());
+-    }
+-
+-    private void registerUser() {
+-        String email = etEmail.getText().toString().trim();
+-        String password = etPassword.getText().toString().trim();
+-
+-        int selectedId = rgRole.getCheckedRadioButtonId();
+-        if(selectedId == -1) {
+-            Toast.makeText(this, "Please select a role", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-        RadioButton rb = findViewById(selectedId);
+-        String role = rb.getText().toString().toLowerCase(); // child/parent/provider
+-
+-        if(email.isEmpty() || password.isEmpty()) {
+-            Toast.makeText(this, "Email and password cannot be empty", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        mAuth.createUserWithEmailAndPassword(email, password)
+-                .addOnCompleteListener(this, task -> {
+-                    if(task.isSuccessful()) {
+-                        String uid = mAuth.getCurrentUser().getUid();
+-                        Map<String, Object> user = new HashMap<>();
+-                        user.put("email", email);
+-                        user.put("role", role);
+-
+-                        db.collection("users").document(uid)
+-                                .set(user)
+-                                .addOnSuccessListener(aVoid -> Toast.makeText(this, "Registration successful!", Toast.LENGTH_SHORT).show())
+-                                .addOnFailureListener(e -> Toast.makeText(this, "Failed to save user: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+-
+-                        finish(); // 返回登录页面
+-                    } else {
+-                        Toast.makeText(this, "Registration Failed: " + task.getException().getMessage(), Toast.LENGTH_SHORT).show();
+-                    }
+-                });
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/PrePostCheckAdapter.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/PrePostCheckAdapter.java b/app/src/main/java/com/example/smartair/PrePostCheckAdapter.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/PrePostCheckAdapter.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,88 +0,0 @@
+-package com.example.smartair;
+-
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.widget.TextView;
+-
+-import androidx.annotation.NonNull;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.google.firebase.firestore.DocumentSnapshot;
+-
+-import java.text.SimpleDateFormat;
+-import java.util.ArrayList;
+-import java.util.Date;
+-import java.util.List;
+-import java.util.Locale;
+-
+-public class PrePostCheckAdapter extends RecyclerView.Adapter<PrePostCheckAdapter.CheckViewHolder> {
+-
+-    private List<DocumentSnapshot> checkList = new ArrayList<>();
+-    private static final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+-
+-    public void setChecks(List<DocumentSnapshot> checks) {
+-        this.checkList = checks != null ? checks : new ArrayList<>();
+-        notifyDataSetChanged();
+-    }
+-
+-    public void addCheck(DocumentSnapshot check) {
+-        checkList.add(0, check); // 新记录插入顶部
+-        notifyItemInserted(0);
+-    }
+-
+-    @NonNull
+-    @Override
+-    public CheckViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+-        View view = LayoutInflater.from(parent.getContext())
+-                .inflate(R.layout.item_pre_post_check, parent, false);
+-        return new CheckViewHolder(view);
+-    }
+-
+-    @Override
+-    public void onBindViewHolder(@NonNull CheckViewHolder holder, int position) {
+-        holder.bind(checkList.get(position));
+-    }
+-
+-    @Override
+-    public int getItemCount() {
+-        return checkList.size();
+-    }
+-
+-    static class CheckViewHolder extends RecyclerView.ViewHolder {
+-
+-        TextView tvWhenResult, tvRating, tvNote, tvTimestamp;
+-
+-        public CheckViewHolder(@NonNull View itemView) {
+-            super(itemView);
+-            tvWhenResult = itemView.findViewById(R.id.tvWhenResult);
+-            tvRating = itemView.findViewById(R.id.tvRating);
+-            tvNote = itemView.findViewById(R.id.tvNote);
+-            tvTimestamp = itemView.findViewById(R.id.tvTimestamp);
+-        }
+-
+-        public void bind(DocumentSnapshot doc) {
+-            String when = doc.getString("when");
+-            String result = doc.getString("result");
+-            Double rating = doc.getDouble("rating");
+-            String note = doc.getString("note");
+-            Long ts = doc.getLong("timestamp");
+-
+-            tvWhenResult.setText((when != null ? when : "-") + " | " + (result != null ? result : "-"));
+-            tvRating.setText("Rating: " + (rating != null ? rating : "-"));
+-
+-            if (note != null && !note.isEmpty()) {
+-                tvNote.setText("Note: " + note);
+-                tvNote.setVisibility(View.VISIBLE);
+-            } else {
+-                tvNote.setVisibility(View.GONE);
+-            }
+-
+-            if (ts != null) {
+-                tvTimestamp.setText(sdf.format(new Date(ts)));
+-            } else {
+-                tvTimestamp.setText("-");
+-            }
+-        }
+-    }
+-}
+Index: app/src/main/java/com/example/smartair/MedicineLogAdapter.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/MedicineLogAdapter.java b/app/src/main/java/com/example/smartair/MedicineLogAdapter.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/MedicineLogAdapter.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,84 +0,0 @@
+-package com.example.smartair;
+-
+-
+-import android.view.LayoutInflater;
+-import android.view.View;
+-import android.view.ViewGroup;
+-import android.widget.TextView;
+-
+-import androidx.annotation.NonNull;
+-import androidx.core.content.ContextCompat;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.google.firebase.firestore.DocumentSnapshot;
+-
+-import java.text.SimpleDateFormat;
+-import java.util.ArrayList;
+-import java.util.Date;
+-import java.util.List;
+-import java.util.Locale;
+-
+-public class MedicineLogAdapter extends RecyclerView.Adapter<MedicineLogAdapter.LogViewHolder> {
+-
+-    private List<DocumentSnapshot> logList = new ArrayList<>();
+-    private static final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+-
+-    public void setLogs(List<DocumentSnapshot> logs) {
+-        this.logList = logs != null ? logs : new ArrayList<>();
+-        notifyDataSetChanged();
+-    }
+-
+-    @NonNull
+-    @Override
+-    public LogViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+-        View view = LayoutInflater.from(parent.getContext())
+-                .inflate(R.layout.item_medicine_log, parent, false);
+-        return new LogViewHolder(view);
+-    }
+-
+-    @Override
+-    public void onBindViewHolder(@NonNull LogViewHolder holder, int position) {
+-        holder.bind(logList.get(position));
+-    }
+-
+-    @Override
+-    public int getItemCount() {
+-        return logList.size();
+-    }
+-
+-    static class LogViewHolder extends RecyclerView.ViewHolder {
+-
+-        TextView typeText, doseText, timestampText;
+-
+-        public LogViewHolder(@NonNull View itemView) {
+-            super(itemView);
+-            typeText = itemView.findViewById(R.id.type_text);
+-            doseText = itemView.findViewById(R.id.dose_text);
+-            timestampText = itemView.findViewById(R.id.timestamp_text);
+-        }
+-
+-        public void bind(DocumentSnapshot doc) {
+-            String type = doc.getString("type");
+-            Long dose = doc.getLong("dose");
+-            Long ts = doc.getLong("timestamp");
+-
+-            typeText.setText(type != null ? type : "-");
+-            doseText.setText("Dose: " + (dose != null ? dose : "-") + " puffs");
+-
+-            if (type != null) {
+-                if (type.equalsIgnoreCase("Rescue")) {
+-                    typeText.setTextColor(ContextCompat.getColor(itemView.getContext(), android.R.color.holo_orange_dark));
+-                } else if (type.equalsIgnoreCase("Controller")) {
+-                    typeText.setTextColor(ContextCompat.getColor(itemView.getContext(), android.R.color.holo_green_dark));
+-                }
+-            }
+-
+-            if (ts != null) {
+-                timestampText.setText(sdf.format(new Date(ts)));
+-            } else {
+-                timestampText.setText("-");
+-            }
+-        }
+-    }
+-}
+-
+Index: app/src/main/java/com/example/smartair/LogMedicineActivity.java
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/LogMedicineActivity.java b/app/src/main/java/com/example/smartair/LogMedicineActivity.java
+deleted file mode 100644
+--- a/app/src/main/java/com/example/smartair/LogMedicineActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ /dev/null	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
+@@ -1,130 +0,0 @@
+-package com.example.smartair;
+-
+-import android.os.Bundle;
+-import android.text.TextUtils;
+-import android.view.View;
+-import android.widget.RadioButton;
+-import android.widget.RadioGroup;
+-import android.widget.Toast;
+-
+-import androidx.appcompat.app.AppCompatActivity;
+-import androidx.recyclerview.widget.LinearLayoutManager;
+-import androidx.recyclerview.widget.RecyclerView;
+-
+-import com.google.android.material.button.MaterialButton;
+-import com.google.android.material.textfield.TextInputEditText;
+-import com.google.firebase.auth.FirebaseAuth;
+-import com.google.firebase.auth.FirebaseUser;
+-import com.google.firebase.firestore.CollectionReference;
+-import com.google.firebase.firestore.DocumentSnapshot;
+-import com.google.firebase.firestore.FirebaseFirestore;
+-
+-import java.util.ArrayList;
+-import java.util.HashMap;
+-import java.util.List;
+-
+-public class LogMedicineActivity extends AppCompatActivity {
+-
+-    private RadioGroup rgType;
+-    private TextInputEditText etDose;
+-    private MaterialButton btnSubmit;
+-    private RecyclerView rvHistory;
+-    private MedicineLogAdapter adapter;
+-    private View emptyStateText;
+-
+-    private FirebaseFirestore db;
+-    private FirebaseAuth auth;
+-    private CollectionReference logRef;
+-    private FirebaseUser user;
+-
+-    @Override
+-    protected void onCreate(Bundle savedInstanceState) {
+-        super.onCreate(savedInstanceState);
+-        setContentView(R.layout.activity_log_medicine);
+-
+-        rgType = findViewById(R.id.rgType);
+-        etDose = findViewById(R.id.etDose);
+-        btnSubmit = findViewById(R.id.btnSubmitLog);
+-        rvHistory = findViewById(R.id.rvLogHistory);
+-        emptyStateText = findViewById(R.id.empty_state_text);
+-
+-        auth = FirebaseAuth.getInstance();
+-        db = FirebaseFirestore.getInstance();
+-        user = auth.getCurrentUser();
+-
+-        if (user == null) {
+-            Toast.makeText(this, "请先登录", Toast.LENGTH_SHORT).show();
+-            finish();
+-            return;
+-        }
+-
+-        logRef = db.collection("users").document(user.getUid()).collection("medicine_logs");
+-
+-        rvHistory.setLayoutManager(new LinearLayoutManager(this));
+-        adapter = new MedicineLogAdapter();
+-        rvHistory.setAdapter(adapter);
+-
+-        btnSubmit.setOnClickListener(v -> submitLog());
+-
+-        fetchLogs();
+-    }
+-
+-    private void submitLog() {
+-        int checkedId = rgType.getCheckedRadioButtonId();
+-        if (checkedId == -1) {
+-            Toast.makeText(this, "请选择 Rescue 或 Controller", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-        RadioButton rb = findViewById(checkedId);
+-        String type = rb.getText().toString();
+-
+-        String doseStr = etDose.getText().toString();
+-        if (TextUtils.isEmpty(doseStr)) {
+-            Toast.makeText(this, "请输入剂量（puffs）", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        long dose;
+-        try {
+-            dose = Long.parseLong(doseStr);
+-        } catch (NumberFormatException ex) {
+-            Toast.makeText(this, "剂量必须为数字", Toast.LENGTH_SHORT).show();
+-            return;
+-        }
+-
+-        long now = System.currentTimeMillis();
+-        HashMap<String, Object> data = new HashMap<>();
+-        data.put("uid", user.getUid());
+-        data.put("email", user.getEmail());
+-        data.put("type", type);
+-        data.put("dose", dose);
+-        data.put("timestamp", now);
+-
+-        btnSubmit.setEnabled(false);
+-        logRef.add(data).addOnSuccessListener(documentReference -> {
+-            btnSubmit.setEnabled(true);
+-            Toast.makeText(this, "记录已保存", Toast.LENGTH_SHORT).show();
+-            etDose.setText("");
+-            fetchLogs(); // 更新列表
+-        }).addOnFailureListener(e -> {
+-            btnSubmit.setEnabled(true);
+-            Toast.makeText(this, "保存失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+-        });
+-    }
+-
+-    private void fetchLogs() {
+-        logRef.orderBy("timestamp").limit(50).get().addOnSuccessListener(queryDocumentSnapshots -> {
+-            List<DocumentSnapshot> logs = queryDocumentSnapshots.getDocuments();
+-            if (logs.isEmpty()) {
+-                emptyStateText.setVisibility(View.VISIBLE);
+-                rvHistory.setVisibility(View.GONE);
+-            } else {
+-                emptyStateText.setVisibility(View.GONE);
+-                rvHistory.setVisibility(View.VISIBLE);
+-                adapter.setLogs(logs);
+-            }
+-        }).addOnFailureListener(e -> {
+-            Toast.makeText(this, "读取历史失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+-        });
+-    }
+-}
+Index: app/src/main/res/layout/activity_homepage.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<ScrollView xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:padding=\"24dp\"\n    android:background=\"#FFFFFF\">\n\n    <LinearLayout\n        android:orientation=\"vertical\"\n        android:gravity=\"center\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\">\n\n        <Button\n            android:id=\"@+id/btnAddChild\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Add Child\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n        <Button\n            android:id=\"@+id/btnViewChildren\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"View Children\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n        <Button\n            android:id=\"@+id/btnManageChild\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Manage Child Activity\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n        <Button\n            android:id=\"@+id/btnManageSharing\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Manage Sharing\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"32dp\"\n            android:padding=\"12dp\" />\n\n        <!-- Existing Features -->\n        <Button\n            android:id=\"@+id/btnLogMedicine\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Log Medicine\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n        <Button\n            android:id=\"@+id/btnTechnique\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Technique Helper\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n        <Button\n            android:id=\"@+id/btnPrePostCheck\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Pre/Post Check\"\n            android:textSize=\"18sp\"\n            android:layout_marginBottom=\"16dp\"\n            android:padding=\"12dp\" />\n\n\n        <Button\n            android:id=\"@+id/btnBadges\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"Badges\"\n            android:textSize=\"18sp\"\n            android:padding=\"12dp\" />\n\n    </LinearLayout>\n\n</ScrollView>\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/layout/activity_homepage.xml b/app/src/main/res/layout/activity_homepage.xml
+--- a/app/src/main/res/layout/activity_homepage.xml	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/res/layout/activity_homepage.xml	(date 1763835574322)
+@@ -11,41 +11,7 @@
+         android:layout_width="match_parent"
+         android:layout_height="wrap_content">
+ 
+-        <Button
+-            android:id="@+id/btnAddChild"
+-            android:layout_width="match_parent"
+-            android:layout_height="wrap_content"
+-            android:text="Add Child"
+-            android:textSize="18sp"
+-            android:layout_marginBottom="16dp"
+-            android:padding="12dp" />
+-
+-        <Button
+-            android:id="@+id/btnViewChildren"
+-            android:layout_width="match_parent"
+-            android:layout_height="wrap_content"
+-            android:text="View Children"
+-            android:textSize="18sp"
+-            android:layout_marginBottom="16dp"
+-            android:padding="12dp" />
+ 
+-        <Button
+-            android:id="@+id/btnManageChild"
+-            android:layout_width="match_parent"
+-            android:layout_height="wrap_content"
+-            android:text="Manage Child Activity"
+-            android:textSize="18sp"
+-            android:layout_marginBottom="16dp"
+-            android:padding="12dp" />
+-
+-        <Button
+-            android:id="@+id/btnManageSharing"
+-            android:layout_width="match_parent"
+-            android:layout_height="wrap_content"
+-            android:text="Manage Sharing"
+-            android:textSize="18sp"
+-            android:layout_marginBottom="32dp"
+-            android:padding="12dp" />
+ 
+         <!-- Existing Features -->
+         <Button
+Index: app/src/main/java/com/example/smartair/auth/AuthModel.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.example.smartair.auth;\n\nimport androidx.annotation.NonNull;\n\nimport com.example.smartair.models.UserRole;\nimport com.google.android.gms.tasks.OnCompleteListener;\nimport com.google.android.gms.tasks.Task;\nimport com.google.firebase.auth.AuthResult;\nimport com.google.firebase.auth.FirebaseAuth;\n\npublic class AuthModel {\n\n    public interface AuthCallback {\n        void onSuccess(UserRole role);\n        void onError(String message);\n    }\n\n    private final FirebaseAuth mAuth;\n\n    public AuthModel() {\n        mAuth = FirebaseAuth.getInstance();\n    }\n\n    public void login(String email, String password, AuthCallback callback) {\n        mAuth.signInWithEmailAndPassword(email, password)\n                .addOnCompleteListener(new OnCompleteListener<AuthResult>() {\n                    @Override\n                    public void onComplete(@NonNull Task<AuthResult> task) {\n                        if (task.isSuccessful()) {\n                            UserRole role = UserRole.CHILD;\n                            callback.onSuccess(role);\n                        } else {\n                            String msg = task.getException() != null\n                                    ? task.getException().getMessage()\n                                    : \"Login failed.\";\n                            callback.onError(msg);\n                        }\n                    }\n                });\n    }\n\n    public void register(String email, String password, UserRole role, AuthCallback callback) {\n        mAuth.createUserWithEmailAndPassword(email, password)\n                .addOnCompleteListener(new OnCompleteListener<AuthResult>() {\n                    @Override\n                    public void onComplete(@NonNull Task<AuthResult> task) {\n                        if (task.isSuccessful()) {\n                            callback.onSuccess(role);\n                        } else {\n                            Exception e = task.getException();\n                            if(e != null) {\n                                e.printStackTrace();   // 在 Logcat 打印完整错误\n                                callback.onError(e.toString());  // 返回完整信息\n                            } else {\n                                callback.onError(\"Unknown error during login\");\n                            }\n                            String msg = task.getException() != null\n                                    ? task.getException().getMessage()\n                                    : \"Sign up failed.\";\n                            callback.onError(msg);\n                        }\n                    }\n                });\n    }\n}\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/auth/AuthModel.java b/app/src/main/java/com/example/smartair/auth/AuthModel.java
+--- a/app/src/main/java/com/example/smartair/auth/AuthModel.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/java/com/example/smartair/auth/AuthModel.java	(date 1763837817183)
+@@ -15,7 +15,9 @@
+         void onError(String message);
+     }
+ 
+-    private final FirebaseAuth mAuth;
++    // 破坏了封装性，但是不得不改
++    public static FirebaseAuth mAuth = FirebaseAuth.getInstance();
++
+ 
+     public AuthModel() {
+         mAuth = FirebaseAuth.getInstance();
+Index: app/src/main/java/com/example/smartair/auth/LoginActivity.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>package com.example.smartair.auth;\n\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.ProgressBar;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.example.smartair.HomepageActivity;\nimport com.example.smartair.R;\nimport com.example.smartair.models.UserRole;\nimport com.example.smartair.utils.SharedPrefsHelper;\nimport com.google.firebase.FirebaseApp;\n\npublic class LoginActivity extends AppCompatActivity implements LoginContract.View {\n\n    private static final String TAG = \"LoginActivity\";\n\n    private EditText emailEditText;\n    private EditText passwordEditText;\n    private Button loginButton;\n    private TextView registerTextView;\n    private ProgressBar progressBar;\n\n    private LoginContract.Presenter presenter;\n    private SharedPrefsHelper prefsHelper;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n\n        try {\n            FirebaseApp.initializeApp(this); // 确保 Firebase 初始化\n        } catch (Exception e) {\n            Log.e(TAG, \"Firebase 初始化失败\", e);\n            Toast.makeText(this, \"Firebase 初始化失败\", Toast.LENGTH_LONG).show();\n        }\n\n        setContentView(R.layout.activity_login);\n\n        emailEditText = findViewById(R.id.emailEditText);\n        passwordEditText = findViewById(R.id.passwordEditText);\n        loginButton = findViewById(R.id.loginButton);\n        registerTextView = findViewById(R.id.registerTextView);\n        progressBar = findViewById(R.id.progressBar);\n\n        try {\n            AuthModel model = new AuthModel();\n            presenter = new LoginPresenter(this, model);\n        } catch (Exception e) {\n            Log.e(TAG, \"Presenter 初始化失败\", e);\n            Toast.makeText(this, \"登录模块初始化失败\", Toast.LENGTH_LONG).show();\n        }\n\n        prefsHelper = new SharedPrefsHelper(this);\n\n        loginButton.setOnClickListener(v -> {\n            try {\n                if (presenter != null) {\n                    presenter.onLoginClicked();\n                } else {\n                    Log.e(TAG, \"Presenter 未初始化\");\n                    Toast.makeText(this, \"登录模块未准备好\", Toast.LENGTH_SHORT).show();\n                }\n            } catch (Exception e) {\n                Log.e(TAG, \"登录点击异常\", e);\n                Toast.makeText(this, \"登录异常: \" + e.getMessage(), Toast.LENGTH_LONG).show();\n            }\n        });\n\n        registerTextView.setOnClickListener(v -> {\n            try {\n                Intent intent = new Intent(LoginActivity.this, RegisterActivity.class);\n                startActivity(intent);\n            } catch (Exception e) {\n                Log.e(TAG, \"跳转注册异常\", e);\n                Toast.makeText(this, \"无法跳转注册页面\", Toast.LENGTH_SHORT).show();\n            }\n        });\n    }\n\n    @Override\n    public void showLoading() {\n        progressBar.setVisibility(View.VISIBLE);\n        loginButton.setEnabled(false);\n    }\n\n    @Override\n    public void hideLoading() {\n        progressBar.setVisibility(View.GONE);\n        loginButton.setEnabled(true);\n    }\n\n    @Override\n    public void showError(String message) {\n        Toast.makeText(this, message, Toast.LENGTH_LONG).show();\n    }\n\n    @Override\n    public void navigateToHome(UserRole role) {\n        prefsHelper.saveUserRole(role.getValue());\n        Intent intent = new Intent(this, HomepageActivity.class);\n        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);\n        startActivity(intent);\n        finish();\n    }\n\n    @Override\n    public String getEmail() {\n        return emailEditText.getText().toString().trim();\n    }\n\n    @Override\n    public String getPassword() {\n        return passwordEditText.getText().toString();\n    }\n\n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        try {\n            if (presenter != null) {\n                presenter.onDestroy();\n            }\n        } catch (Exception e) {\n            Log.e(TAG, \"Presenter 销毁异常\", e);\n        }\n    }\n}\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/java/com/example/smartair/auth/LoginActivity.java b/app/src/main/java/com/example/smartair/auth/LoginActivity.java
+--- a/app/src/main/java/com/example/smartair/auth/LoginActivity.java	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/java/com/example/smartair/auth/LoginActivity.java	(date 1763838062310)
+@@ -13,33 +13,39 @@
+ import androidx.appcompat.app.AppCompatActivity;
+ 
+ import com.example.smartair.HomepageActivity;
++import com.example.smartair.HomepageParentsActivity;
++import com.example.smartair.HomepageProvidersActivity;
+ import com.example.smartair.R;
+ import com.example.smartair.models.UserRole;
+ import com.example.smartair.utils.SharedPrefsHelper;
+ import com.google.firebase.FirebaseApp;
++import com.google.firebase.auth.FirebaseUser;
++
++import com.google.firebase.firestore.FirebaseFirestore;
++
+ 
+ public class LoginActivity extends AppCompatActivity implements LoginContract.View {
+ 
+     private static final String TAG = "LoginActivity";
+ 
+-    private EditText emailEditText;
+-    private EditText passwordEditText;
++    private EditText emailEditText, passwordEditText;
+     private Button loginButton;
+     private TextView registerTextView;
+     private ProgressBar progressBar;
+ 
+     private LoginContract.Presenter presenter;
+     private SharedPrefsHelper prefsHelper;
++    private FirebaseFirestore db;
+ 
+     @Override
+     protected void onCreate(Bundle savedInstanceState) {
+         super.onCreate(savedInstanceState);
+ 
+         try {
+-            FirebaseApp.initializeApp(this); // 确保 Firebase 初始化
++            FirebaseApp.initializeApp(this);
+         } catch (Exception e) {
+-            Log.e(TAG, "Firebase 初始化失败", e);
+-            Toast.makeText(this, "Firebase 初始化失败", Toast.LENGTH_LONG).show();
++            Log.e(TAG, "Firebase init failed", e);
++            Toast.makeText(this, "Firebase initialization failed", Toast.LENGTH_LONG).show();
+         }
+ 
+         setContentView(R.layout.activity_login);
+@@ -50,50 +56,30 @@
+         registerTextView = findViewById(R.id.registerTextView);
+         progressBar = findViewById(R.id.progressBar);
+ 
+-        try {
+-            AuthModel model = new AuthModel();
+-            presenter = new LoginPresenter(this, model);
+-        } catch (Exception e) {
+-            Log.e(TAG, "Presenter 初始化失败", e);
+-            Toast.makeText(this, "登录模块初始化失败", Toast.LENGTH_LONG).show();
+-        }
+-
+-        prefsHelper = new SharedPrefsHelper(this);
++        db = FirebaseFirestore.getInstance();
++        prefsHelper = new SharedPrefsHelper(this);
++
++        AuthModel model = new AuthModel();
++        presenter = new LoginPresenter(this, model);
+ 
+         loginButton.setOnClickListener(v -> {
+-            try {
+-                if (presenter != null) {
+-                    presenter.onLoginClicked();
+-                } else {
+-                    Log.e(TAG, "Presenter 未初始化");
+-                    Toast.makeText(this, "登录模块未准备好", Toast.LENGTH_SHORT).show();
+-                }
+-            } catch (Exception e) {
+-                Log.e(TAG, "登录点击异常", e);
+-                Toast.makeText(this, "登录异常: " + e.getMessage(), Toast.LENGTH_LONG).show();
+-            }
++            presenter.onLoginClicked();
+         });
+ 
+         registerTextView.setOnClickListener(v -> {
+-            try {
+-                Intent intent = new Intent(LoginActivity.this, RegisterActivity.class);
+-                startActivity(intent);
+-            } catch (Exception e) {
+-                Log.e(TAG, "跳转注册异常", e);
+-                Toast.makeText(this, "无法跳转注册页面", Toast.LENGTH_SHORT).show();
+-            }
++            startActivity(new Intent(LoginActivity.this, RegisterActivity.class));
+         });
+     }
+ 
+     @Override
+     public void showLoading() {
+-        progressBar.setVisibility(View.VISIBLE);
++        progressBar.setVisibility(ProgressBar.VISIBLE);
+         loginButton.setEnabled(false);
+     }
+ 
+     @Override
+     public void hideLoading() {
+-        progressBar.setVisibility(View.GONE);
++        progressBar.setVisibility(ProgressBar.GONE);
+         loginButton.setEnabled(true);
+     }
+ 
+@@ -104,11 +90,36 @@
+ 
+     @Override
+     public void navigateToHome(UserRole role) {
+-        prefsHelper.saveUserRole(role.getValue());
+-        Intent intent = new Intent(this, HomepageActivity.class);
+-        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
+-        startActivity(intent);
+-        finish();
++        FirebaseUser user = AuthModel.mAuth.getCurrentUser();
++        if (user == null) return;
++
++        db.collection("users").document(user.getUid())
++                .get()
++                .addOnSuccessListener(doc -> {
++                    if (doc.exists()) {
++                        String roleStr = doc.getString("role");
++                        if (roleStr == null) roleStr = "child";
++
++                        UserRole userRole = UserRole.fromString(roleStr);
++                        prefsHelper.saveUserRole(userRole.getValue());
++
++                        switch (userRole) {
++                            case CHILD:
++                                startActivity(new Intent(this, HomepageActivity.class));
++                                break;
++                            case PARENT:
++                                startActivity(new Intent(this, HomepageParentsActivity.class));
++                                break;
++                            case PROVIDER:
++                                startActivity(new Intent(this, HomepageProvidersActivity.class));
++                                break;
++                        }
++                        finish();
++                    } else {
++                        Toast.makeText(this, "User role not found", Toast.LENGTH_SHORT).show();
++                    }
++                })
++                .addOnFailureListener(e -> Toast.makeText(this, "Failed to fetch user role: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+     }
+ 
+     @Override
+@@ -124,12 +135,6 @@
+     @Override
+     protected void onDestroy() {
+         super.onDestroy();
+-        try {
+-            if (presenter != null) {
+-                presenter.onDestroy();
+-            }
+-        } catch (Exception e) {
+-            Log.e(TAG, "Presenter 销毁异常", e);
+-        }
++        presenter.onDestroy();
+     }
+-}
++}
+\ No newline at end of file
+Index: .idea/deploymentTargetSelector.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"deploymentTargetSelector\">\n    <selectionStates>\n      <SelectionState runConfigName=\"app\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n        <DropdownSelection timestamp=\"2025-11-11T21:26:28.380294500Z\">\n          <Target type=\"DEFAULT_BOOT\">\n            <handle>\n              <DeviceId pluginId=\"LocalEmulator\" identifier=\"path=C:\\Users\\HP\\.android\\avd\\Medium_Phone.avd\" />\n            </handle>\n          </Target>\n        </DropdownSelection>\n        <DialogSelection>\n          <targets>\n            <Target type=\"DEFAULT_BOOT\">\n              <handle>\n                <DeviceId pluginId=\"LocalEmulator\" identifier=\"path=C:\\Users\\HP\\.android\\avd\\Medium_Phone.avd\" />\n              </handle>\n            </Target>\n          </targets>\n        </DialogSelection>\n      </SelectionState>\n      <SelectionState runConfigName=\"ManageChildActivity\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n      <SelectionState runConfigName=\"ViewChildrenActivity (3)\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n      <SelectionState runConfigName=\"AddChildActivity\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n      <SelectionState runConfigName=\"ViewChildrenActivity (1)\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n      <SelectionState runConfigName=\"MainActivity\">\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\n      </SelectionState>\n    </selectionStates>\n  </component>\n</project>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
+--- a/.idea/deploymentTargetSelector.xml	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/.idea/deploymentTargetSelector.xml	(date 1763834204915)
+@@ -21,18 +21,6 @@
+           </targets>
+         </DialogSelection>
+       </SelectionState>
+-      <SelectionState runConfigName="ManageChildActivity">
+-        <option name="selectionMode" value="DROPDOWN" />
+-      </SelectionState>
+-      <SelectionState runConfigName="ViewChildrenActivity (3)">
+-        <option name="selectionMode" value="DROPDOWN" />
+-      </SelectionState>
+-      <SelectionState runConfigName="AddChildActivity">
+-        <option name="selectionMode" value="DROPDOWN" />
+-      </SelectionState>
+-      <SelectionState runConfigName="ViewChildrenActivity (1)">
+-        <option name="selectionMode" value="DROPDOWN" />
+-      </SelectionState>
+       <SelectionState runConfigName="MainActivity">
+         <option name="selectionMode" value="DROPDOWN" />
+       </SelectionState>
+Index: app/src/main/AndroidManifest.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.example.smartair\">\n\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n\n    <application\n        android:allowBackup=\"true\"\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\n        android:fullBackupContent=\"@xml/backup_rules\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.SmartAir\">\n\n        <!-- LOGIN (Launcher) -->\n        <activity\n            android:name=\".auth.LoginActivity\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n\n        <!-- REGISTER -->\n        <activity\n            android:name=\".auth.RegisterActivity\"\n            android:exported=\"false\" />\n\n        <!-- HOMEPAGE -->\n        <activity\n            android:name=\".HomepageActivity\"\n            android:exported=\"true\" />\n\n        <!-- CHILD MANAGEMENT -->\n        <activity android:name=\".ViewChildrenActivity\" android:exported=\"true\" />\n        <activity android:name=\".AddChildActivity\" android:exported=\"true\" />\n        <activity android:name=\".ManageChildActivity\" android:exported=\"true\" />\n\n        <!-- SHARING MANAGEMENT -->\n        <activity android:name=\".ManageSharingActivity\" android:exported=\"false\" />\n        <activity android:name=\".ChooseChildForSharingActivity\" android:exported=\"true\" />\n\n        <!-- OTHER SCREENS -->\n        <activity android:name=\".LogMedicineActivity\" android:exported=\"false\" />\n        <activity android:name=\".TechniqueActivity\" android:exported=\"false\" />\n        <activity android:name=\".PrePostCheckActivity\" android:exported=\"false\" />\n\n        <!-- OPTIONAL: remove if not used anymore -->\n        <activity android:name=\".MainActivity\" android:exported=\"false\" />\n\n        <activity android:name=\".BadgeActivity\" />\n\n    </application>\n\n</manifest>\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
+--- a/app/src/main/AndroidManifest.xml	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/AndroidManifest.xml	(date 1763838006796)
+@@ -34,6 +34,12 @@
+         <activity
+             android:name=".HomepageActivity"
+             android:exported="true" />
++        <activity
++            android:name=".HomepageParentsActivity"
++            android:exported="true" />
++        <activity
++            android:name=".HomepageProvidersActivity"
++            android:exported="true" />
+ 
+         <!-- CHILD MANAGEMENT -->
+         <activity android:name=".ViewChildrenActivity" android:exported="true" />
+Index: app/src/main/res/layout/activity_homepage_parents.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:id=\"@+id/main\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    tools:context=\".HomepageParentsActivity\">\n\n    <TextView\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:text=\"Homepage for parents\"\n        android:textSize=\"25sp\"\n        android:layout_gravity=\"center\" />\n\n</LinearLayout>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/app/src/main/res/layout/activity_homepage_parents.xml b/app/src/main/res/layout/activity_homepage_parents.xml
+--- a/app/src/main/res/layout/activity_homepage_parents.xml	(revision 3eee483dd815c17177e06cfb78c3be67424030de)
++++ b/app/src/main/res/layout/activity_homepage_parents.xml	(date 1763835574340)
+@@ -1,17 +1,90 @@
+ <?xml version="1.0" encoding="utf-8"?>
+-<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+-    xmlns:app="http://schemas.android.com/apk/res-auto"
+-    xmlns:tools="http://schemas.android.com/tools"
+-    android:id="@+id/main"
++<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+     android:layout_width="match_parent"
+     android:layout_height="match_parent"
+-    tools:context=".HomepageParentsActivity">
++    android:padding="24dp"
++    android:background="#FFFFFF">
++
++    <LinearLayout
++        android:orientation="vertical"
++        android:gravity="center"
++        android:layout_width="match_parent"
++        android:layout_height="wrap_content">
++
++        <!-- 父母相关按钮 -->
++        <Button
++            android:id="@+id/btnAddChild"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Add Child"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
++
++        <Button
++            android:id="@+id/btnViewChildren"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="View Children"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
++
++        <Button
++            android:id="@+id/btnManageChild"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Manage Child Activity"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
++
++        <Button
++            android:id="@+id/btnManageSharing"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Manage Sharing"
++            android:textSize="18sp"
++            android:layout_marginBottom="32dp"
++            android:padding="12dp" />
++
++        <!-- 其他功能按钮（可选，如果想和父母主页共用）-->
++        <!--
++        <Button
++            android:id="@+id/btnLogMedicine"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Log Medicine"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
++
++        <Button
++            android:id="@+id/btnTechnique"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Technique Helper"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
+ 
+-    <TextView
+-        android:layout_width="wrap_content"
+-        android:layout_height="wrap_content"
+-        android:text="Homepage for parents"
+-        android:textSize="25sp"
+-        android:layout_gravity="center" />
++        <Button
++            android:id="@+id/btnPrePostCheck"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Pre/Post Check"
++            android:textSize="18sp"
++            android:layout_marginBottom="16dp"
++            android:padding="12dp" />
++
++        <Button
++            android:id="@+id/btnBadges"
++            android:layout_width="match_parent"
++            android:layout_height="wrap_content"
++            android:text="Badges"
++            android:textSize="18sp"
++            android:padding="12dp" />
++        -->
+ 
+-</LinearLayout>
+\ No newline at end of file
++    </LinearLayout>
++</ScrollView>
Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".MainActivity\">\r\n\r\n    <TextView\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"Hello World!\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_main.xml b/app/src/main/res/layout/activity_main.xml
--- a/app/src/main/res/layout/activity_main.xml	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/src/main/res/layout/activity_main.xml	(date 1763918002230)
@@ -1,19 +1,36 @@
 <?xml version="1.0" encoding="utf-8"?>
-<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://schemas.android.com/apk/res-auto"
-    xmlns:tools="http://schemas.android.com/tools"
-    android:id="@+id/main"
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:orientation="vertical"
+    android:padding="24dp"
     android:layout_width="match_parent"
-    android:layout_height="match_parent"
-    tools:context=".MainActivity">
-
-    <TextView
-        android:layout_width="wrap_content"
+    android:layout_height="match_parent">
+
+    <EditText
+        android:id="@+id/etEmail"
+        android:hint="Email"
+        android:inputType="textEmailAddress"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content" />
+
+    <EditText
+        android:id="@+id/etPassword"
+        android:hint="Password"
+        android:inputType="textPassword"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="16dp"/>
+
+    <Button
+        android:id="@+id/btnLogin"
+        android:text="Login"
+        android:layout_width="match_parent"
         android:layout_height="wrap_content"
-        android:text="Hello World!"
-        app:layout_constraintBottom_toBottomOf="parent"
-        app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toTopOf="parent" />
+        android:layout_marginTop="24dp"/>
 
-</androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
+    <Button
+        android:id="@+id/btnGoSignUp"
+        android:text="Sign Up"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="16dp"/>
+</LinearLayout>
Index: app/src/main/res/values/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\r\n    <string name=\"app_name\">SmartAir</string>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
--- a/app/src/main/res/values/strings.xml	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/src/main/res/values/strings.xml	(date 1763918002237)
@@ -1,3 +1,46 @@
 <resources>
     <string name="app_name">SmartAir</string>
+    <string name="step_image_desc">Step image</string>
+    <string name="child_pef_title">Enter PEF Value</string>
+    <string name="child_pef_subtitle">Track how medicine affects your breathing</string>
+    <string name="pef_input_hint">PEF Value (L/min)</string>
+    <string name="save_pef_entry">Save PEF Entry</string>
+    <string name="radio_pre_medicine">Before Medicine</string>
+    <string name="radio_post_medicine">After Medicine</string>
+    <string name="radio_none">No Tag</string>
+    <string name="medicine_tag_label">Medicine Tag:</string>
+    <string name="personal_best_title">Personal Best (PB)</string>
+    <string name="personal_best_description">This is the best peak-flow number from your action plan.</string>
+    <string name="personal_best_status_missing">Ask a parent to enter your personal best to unlock your color zone.</string>
+    <string name="personal_best_status_set">PB from your asthma action plan.</string>
+    <string name="personal_best_value_format">%1$d L/min</string>
+    <string name="zone_card_title">Your Breathing Zone</string>
+    <string name="zone_label_green">Green Zone</string>
+    <string name="zone_label_yellow">Yellow Zone</string>
+    <string name="zone_label_red">Red Zone</string>
+    <string name="zone_label_unknown">Zone Status</string>
+    <string name="zone_green_guidance">You\'re clear! Keep following your controller plan.</string>
+    <string name="zone_yellow_guidance">Caution! Follow the yellow-zone steps and check in with a parent.</string>
+    <string name="zone_red_guidance">Warning! Use your rescue plan right away and get help.</string>
+    <string name="zone_unknown_guidance">Enter a PEF number to see if you\'re in Green, Yellow, or Red.</string>
+    <string name="zone_percent_format">%1$s%% of PB</string>
+    <string name="zone_based_on_current_entry">Based on what you\'re typing now.</string>
+    <string name="zone_based_on_latest_entry">Based on your latest saved entry.</string>
+    <string name="zone_missing_pb">Add your Personal Best to unlock this color card.</string>
+    <string name="zone_missing_entries">Log a PEF value to see your color zone.</string>
+    <string name="triage_button_text">Having trouble breathing?</string>
+    <string name="triage_safety_note">This is guidance, not a diagnosis. If in doubt, call emergency.</string>
+    <string name="triage_title">Having trouble breathing?</string>
+    <string name="triage_intro">Answer these quick red-flag questions so we can guide your next step.</string>
+    <string name="triage_question_speech">I can\'t speak in full sentences.</string>
+    <string name="triage_question_chest">My chest or ribs are pulling in when I breathe.</string>
+    <string name="triage_question_color">My lips or nails look blue or gray.</string>
+    <string name="triage_check_next_steps">Check next steps</string>
+    <string name="triage_result_emergency_title">Call emergency now</string>
+    <string name="triage_result_emergency_message">These red flags mean breathing trouble could be serious. Tell an adult and call emergency services right away.</string>
+    <string name="triage_result_home_title">Start home steps</string>
+    <string name="triage_result_home_message">Keep calm, follow your action plan with an adult, and re-check after your timer.</string>
+    <string name="triage_no_flags_hint">Answer the red-flag questions above to see guidance.</string>
+    <string name="recent_entries_title">Recent Entries</string>
+    <string name="empty_history_message">No PEF entries yet.\nEnter your first PEF value above.</string>
 </resources>
\ No newline at end of file
Index: app/src/main/res/values/colors.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<resources>\r\n    <color name=\"black\">#FF000000</color>\r\n    <color name=\"white\">#FFFFFFFF</color>\r\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/colors.xml b/app/src/main/res/values/colors.xml
--- a/app/src/main/res/values/colors.xml	(revision 26d7548472c43a6ab6cc033661d214e36fa327fe)
+++ b/app/src/main/res/values/colors.xml	(date 1763918002236)
@@ -2,4 +2,14 @@
 <resources>
     <color name="black">#FF000000</color>
     <color name="white">#FFFFFFFF</color>
-</resources>
\ No newline at end of file
+    <color name="zone_green_bg">#DDF5E5</color>
+    <color name="zone_green_text">#1B5E20</color>
+    <color name="zone_yellow_bg">#FFF4D2</color>
+    <color name="zone_yellow_text">#8C6D1F</color>
+    <color name="zone_red_bg">#FFE1E1</color>
+    <color name="zone_red_text">#B3261E</color>
+    <color name="zone_neutral_bg">#F1F3F6</color>
+    <color name="bg_soft">#FFF7F2</color> <!-- page background -->
+    <color name="card_bg">#FFFFFFFF</color> <!-- card background -->
+    <color name="text_primary">#333333</color>
+</resources>
Index: app/src/main/java/com/example/smartair/auth/AuthModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/AuthModel.java b/app/src/main/java/com/example/smartair/auth/AuthModel.java
new file mode 100644
--- /dev/null	(date 1763918002060)
+++ b/app/src/main/java/com/example/smartair/auth/AuthModel.java	(date 1763918002060)
@@ -0,0 +1,67 @@
+package com.example.smartair.auth;
+
+import androidx.annotation.NonNull;
+
+import com.example.smartair.models.UserRole;
+import com.google.android.gms.tasks.OnCompleteListener;
+import com.google.android.gms.tasks.Task;
+import com.google.firebase.auth.AuthResult;
+import com.google.firebase.auth.FirebaseAuth;
+
+public class AuthModel {
+
+    public interface AuthCallback {
+        void onSuccess(UserRole role);
+        void onError(String message);
+    }
+
+    // 破坏了封装性，但是不得不改
+    public static FirebaseAuth mAuth = FirebaseAuth.getInstance();
+
+
+    public AuthModel() {
+        mAuth = FirebaseAuth.getInstance();
+    }
+
+    public void login(String email, String password, AuthCallback callback) {
+        mAuth.signInWithEmailAndPassword(email, password)
+                .addOnCompleteListener(new OnCompleteListener<AuthResult>() {
+                    @Override
+                    public void onComplete(@NonNull Task<AuthResult> task) {
+                        if (task.isSuccessful()) {
+                            UserRole role = UserRole.CHILD;
+                            callback.onSuccess(role);
+                        } else {
+                            String msg = task.getException() != null
+                                    ? task.getException().getMessage()
+                                    : "Login failed.";
+                            callback.onError(msg);
+                        }
+                    }
+                });
+    }
+
+    public void register(String email, String password, UserRole role, AuthCallback callback) {
+        mAuth.createUserWithEmailAndPassword(email, password)
+                .addOnCompleteListener(new OnCompleteListener<AuthResult>() {
+                    @Override
+                    public void onComplete(@NonNull Task<AuthResult> task) {
+                        if (task.isSuccessful()) {
+                            callback.onSuccess(role);
+                        } else {
+                            Exception e = task.getException();
+                            if(e != null) {
+                                e.printStackTrace();   // 在 Logcat 打印完整错误
+                                callback.onError(e.toString());  // 返回完整信息
+                            } else {
+                                callback.onError("Unknown error during login");
+                            }
+                            String msg = task.getException() != null
+                                    ? task.getException().getMessage()
+                                    : "Sign up failed.";
+                            callback.onError(msg);
+                        }
+                    }
+                });
+    }
+}
Index: app/src/main/java/com/example/smartair/data/PEFRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/data/PEFRepository.java b/app/src/main/java/com/example/smartair/data/PEFRepository.java
new file mode 100644
--- /dev/null	(date 1763918002069)
+++ b/app/src/main/java/com/example/smartair/data/PEFRepository.java	(date 1763918002069)
@@ -0,0 +1,121 @@
+package com.example.smartair.data;
+
+import android.content.Context;
+import android.content.SharedPreferences;
+import android.util.Log;
+import com.example.smartair.model.PEFEntry;
+import org.json.JSONArray;
+import org.json.JSONException;
+import org.json.JSONObject;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+import java.util.UUID;
+
+/**
+ * Repository for managing PEF (Peak Expiratory Flow) entries.
+ */
+public class PEFRepository {
+    private static final String TAG = "PEFRepository";
+    private static final String PREFS_NAME = "SmartAir_PEF";
+    private static final String KEY_PEF_ENTRIES = "pef_entries";
+    private static final String KEY_PERSONAL_BEST = "personal_best";
+    
+    private final SharedPreferences sharedPreferences;
+    
+    public PEFRepository(Context context) {
+        this.sharedPreferences = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
+    }
+    public void addPEFEntry(PEFEntry entry) {
+        if (entry.getId() == null || entry.getId().isEmpty()) {
+            entry.setId(UUID.randomUUID().toString());
+        }
+        
+        List<PEFEntry> entries = getAllPEFEntries();
+        entries.add(entry);
+        savePEFEntries(entries);
+    }
+
+    public List<PEFEntry> getAllPEFEntries() {
+        String jsonString = sharedPreferences.getString(KEY_PEF_ENTRIES, null);
+        if (jsonString == null || jsonString.isEmpty()) {
+            return new ArrayList<>();
+        }
+        
+        List<PEFEntry> entries = new ArrayList<>();
+        try {
+            JSONArray jsonArray = new JSONArray(jsonString);
+            for (int i = 0; i < jsonArray.length(); i++) {
+                JSONObject jsonObject = jsonArray.getJSONObject(i);
+                PEFEntry entry = PEFEntry.fromJSON(jsonObject);
+                entries.add(entry);
+            }
+        } catch (JSONException e) {
+            Log.e(TAG, "Error reading PEF entries from JSON", e);
+        }
+        
+        // Sort by timestamp, newest first
+        Collections.sort(entries, (e1, e2) -> Long.compare(e2.getTimestamp(), e1.getTimestamp()));
+        
+        return entries;
+    }
+
+    public List<PEFEntry> getPEFEntriesInRange(long startTime, long endTime) {
+        List<PEFEntry> allEntries = getAllPEFEntries();
+        List<PEFEntry> filtered = new ArrayList<>();
+        
+        for (PEFEntry entry : allEntries) {
+            if (entry.getTimestamp() >= startTime && entry.getTimestamp() <= endTime) {
+                filtered.add(entry);
+            }
+        }
+        
+        return filtered;
+    }
+
+    public PEFEntry getMostRecentPEFEntry() {
+        List<PEFEntry> entries = getAllPEFEntries();
+        return entries.isEmpty() ? null : entries.get(0);
+    }
+
+    public void deletePEFEntry(String entryId) {
+        List<PEFEntry> entries = getAllPEFEntries();
+        entries.removeIf(entry -> entry.getId().equals(entryId));
+        savePEFEntries(entries);
+    }
+
+    private void savePEFEntries(List<PEFEntry> entries) {
+        try {
+            JSONArray jsonArray = new JSONArray();
+            for (PEFEntry entry : entries) {
+                jsonArray.put(entry.toJSON());
+            }
+            sharedPreferences.edit().putString(KEY_PEF_ENTRIES, jsonArray.toString()).apply();
+        } catch (Exception e) {
+            Log.e(TAG, "Error saving PEF entries to JSON", e);
+        }
+    }
+
+    /**
+     * Stores the Personal Best (PB) value provided by a parent.
+     */
+    public void setPersonalBest(int personalBest) {
+        if (personalBest <= 0) {
+            throw new IllegalArgumentException("Personal best must be a positive number");
+        }
+        sharedPreferences.edit().putInt(KEY_PERSONAL_BEST, personalBest).apply();
+    }
+
+    /**
+     * @return saved Personal Best or null if it has not been set.
+     */
+    public Integer getPersonalBest() {
+        int storedValue = sharedPreferences.getInt(KEY_PERSONAL_BEST, -1);
+        return storedValue > 0 ? storedValue : null;
+    }
+
+    public boolean hasPersonalBest() {
+        return getPersonalBest() != null;
+    }
+}
+
Index: app/src/main/java/com/example/smartair/auth/LoginActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/LoginActivity.java b/app/src/main/java/com/example/smartair/auth/LoginActivity.java
new file mode 100644
--- /dev/null	(date 1763918002061)
+++ b/app/src/main/java/com/example/smartair/auth/LoginActivity.java	(date 1763918002061)
@@ -0,0 +1,218 @@
+package com.example.smartair.auth;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.util.Log;
+import android.view.View;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.ProgressBar;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.example.smartair.homepages.HomepageActivity;
+import com.example.smartair.homepages.HomepageParentsActivity;
+import com.example.smartair.homepages.HomepageProvidersActivity;
+import com.example.smartair.models.UserRole;
+import com.example.smartair.utils.SharedPrefsHelper;
+import com.google.firebase.FirebaseApp;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+
+import com.google.firebase.firestore.FirebaseFirestore;
+
+
+public class LoginActivity extends AppCompatActivity implements LoginContract.View {
+
+    private static final String TAG = "LoginActivity";
+
+    private EditText emailEditText, passwordEditText;
+    private Button loginButton;
+    private TextView registerTextView;
+    private ProgressBar progressBar;
+
+    private LoginContract.Presenter presenter;
+    private SharedPrefsHelper prefsHelper;
+    private FirebaseFirestore db;
+    private boolean isChildLogin = false;
+
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+
+        try {
+            FirebaseApp.initializeApp(this);
+        } catch (Exception e) {
+            Log.e(TAG, "Firebase init failed", e);
+            Toast.makeText(this, "Firebase initialization failed", Toast.LENGTH_LONG).show();
+        }
+
+        setContentView(R.layout.activity_login);
+
+        emailEditText = findViewById(R.id.emailEditText);
+        passwordEditText = findViewById(R.id.passwordEditText);
+        loginButton = findViewById(R.id.loginButton);
+        registerTextView = findViewById(R.id.registerTextView);
+        progressBar = findViewById(R.id.progressBar);
+
+        db = FirebaseFirestore.getInstance();
+        prefsHelper = new SharedPrefsHelper(this);
+
+        AuthModel model = new AuthModel();
+        presenter = new LoginPresenter(this, model);
+
+        loginButton.setOnClickListener(v -> handleLogin());
+
+        registerTextView.setOnClickListener(v -> {
+            startActivity(new Intent(LoginActivity.this, RegisterActivity.class));
+        });
+    }
+    private void handleLogin() {
+        String input = getEmail();
+        String password = getPassword();
+
+        if (input.isEmpty() || password.isEmpty()) {
+            showError("Please enter login credentials");
+            return;
+        }
+        if (!input.contains("@")) {
+            loginChild(input, password);
+            return;
+        }
+
+        presenter.onLoginClicked();
+    }
+    private void loginChild(String username, String password) {
+        showLoading();
+
+        db.collection("usernames")
+                .document(username)
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (!doc.exists()) {
+                        hideLoading();
+                        showError("Invalid username");
+                        return;
+                    }
+
+                    String parentId = doc.getString("parentId");
+                    String childId = doc.getString("childUid");
+
+                    if (parentId == null || childId == null) {
+                        hideLoading();
+                        showError("Account is not configured correctly");
+                        return;
+                    }
+
+                    db.collection("users")
+                            .document(parentId)
+                            .collection("children")
+                            .document(childId)
+                            .get()
+                            .addOnSuccessListener(childDoc -> {
+                                hideLoading();
+
+                                if (!childDoc.exists()) {
+                                    showError("Child profile missing");
+                                    return;
+                                }
+
+                                String savedPw = childDoc.getString("password");
+
+                                if (!password.equals(savedPw)) {
+                                    showError("Incorrect password");
+                                    return;
+                                }
+                                prefsHelper.saveUserRole("child");
+                                startActivity(new Intent(this, HomepageActivity.class));
+                                finish();
+                            })
+                            .addOnFailureListener(e -> {
+                                hideLoading();
+                                showError("Failed to load child account");
+                            });
+
+                })
+                .addOnFailureListener(e -> {
+                    hideLoading();
+                    showError("Login failed: " + e.getMessage());
+                });
+    }
+
+    @Override
+    public void showLoading() {
+        progressBar.setVisibility(ProgressBar.VISIBLE);
+        loginButton.setEnabled(false);
+    }
+
+    @Override
+    public void hideLoading() {
+        progressBar.setVisibility(ProgressBar.GONE);
+        loginButton.setEnabled(true);
+    }
+
+    @Override
+    public void showError(String message) {
+        Toast.makeText(this, message, Toast.LENGTH_LONG).show();
+    }
+
+    @Override
+    public void navigateToHome(UserRole role) {
+        FirebaseUser user = AuthModel.mAuth.getCurrentUser();
+        if (user == null) return;
+        if (isChildLogin) {
+            prefsHelper.saveUserRole("child");
+            startActivity(new Intent(this, HomepageActivity.class));
+            finish();
+            return;
+        }
+
+        db.collection("users").document(user.getUid())
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (doc.exists()) {
+                        String roleStr = doc.getString("role");
+                        if (roleStr == null) roleStr = "child";
+
+                        UserRole userRole = UserRole.fromString(roleStr);
+                        prefsHelper.saveUserRole(userRole.getValue());
+
+                        switch (userRole) {
+                            case CHILD:
+                                startActivity(new Intent(this, HomepageActivity.class));
+                                break;
+                            case PARENT:
+                                startActivity(new Intent(this, HomepageParentsActivity.class));
+                                break;
+                            case PROVIDER:
+                                startActivity(new Intent(this, HomepageProvidersActivity.class));
+                                break;
+                        }
+                        finish();
+                    } else {
+                        Toast.makeText(this, "User role not found", Toast.LENGTH_SHORT).show();
+                    }
+                })
+                .addOnFailureListener(e -> Toast.makeText(this, "Failed to fetch user role: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+    }
+
+    @Override
+    public String getEmail() {
+        return emailEditText.getText().toString().trim();
+    }
+
+    @Override
+    public String getPassword() {
+        return passwordEditText.getText().toString();
+    }
+
+    @Override
+    protected void onDestroy() {
+        super.onDestroy();
+        presenter.onDestroy();
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/auth/ForgotPasswordActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/ForgotPasswordActivity.java b/app/src/main/java/com/example/smartair/auth/ForgotPasswordActivity.java
new file mode 100644
--- /dev/null	(date 1763918002060)
+++ b/app/src/main/java/com/example/smartair/auth/ForgotPasswordActivity.java	(date 1763918002060)
@@ -0,0 +1,4 @@
+package com.example.smartair.auth;
+
+public class ForgotPasswordActivity {
+}
Index: app/src/main/java/com/example/smartair/models/User.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/models/User.java b/app/src/main/java/com/example/smartair/models/User.java
new file mode 100644
--- /dev/null	(date 1763918002073)
+++ b/app/src/main/java/com/example/smartair/models/User.java	(date 1763918002073)
@@ -0,0 +1,60 @@
+package com.example.smartair.models;
+
+public class User {
+    private String uid;
+    private String email;
+    private UserRole role;
+    private String name;
+    private long createdAt;
+
+    public User() {
+    }
+
+    public User(String uid, String email, UserRole role, String name) {
+        this.uid = uid;
+        this.email = email;
+        this.role = role;
+        this.name = name;
+        this.createdAt = System.currentTimeMillis();
+    }
+
+    public String getUid() {
+        return uid;
+    }
+
+    public void setUid(String uid) {
+        this.uid = uid;
+    }
+
+    public String getEmail() {
+        return email;
+    }
+
+    public void setEmail(String email) {
+        this.email = email;
+    }
+
+    public UserRole getRole() {
+        return role;
+    }
+
+    public void setRole(UserRole role) {
+        this.role = role;
+    }
+
+    public String getName() {
+        return name;
+    }
+
+    public void setName(String name) {
+        this.name = name;
+    }
+
+    public long getCreatedAt() {
+        return createdAt;
+    }
+
+    public void setCreatedAt(long createdAt) {
+        this.createdAt = createdAt;
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/data/ChildRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/data/ChildRepository.java b/app/src/main/java/com/example/smartair/data/ChildRepository.java
new file mode 100644
--- /dev/null	(date 1763918002069)
+++ b/app/src/main/java/com/example/smartair/data/ChildRepository.java	(date 1763918002069)
@@ -0,0 +1,108 @@
+package com.example.smartair.data;
+
+import android.content.Context;
+import android.content.SharedPreferences;
+import android.util.Log;
+import com.example.smartair.model.Child;
+import org.json.JSONArray;
+import org.json.JSONException;
+import org.json.JSONObject;
+import java.util.ArrayList;
+import java.util.List;
+import java.util.UUID;
+
+/**
+ * Repository for managing child data.
+ * Uses SharedPreferences with JSONArray.
+ */
+public class ChildRepository {
+    private static final String TAG = "ChildRepository";
+    private static final String PREFS_NAME = "SmartAir_Children";
+    private static final String KEY_CHILDREN = "children_list";
+    
+    private final SharedPreferences sharedPreferences;
+    
+    public ChildRepository(Context context) {
+        this.sharedPreferences = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
+    }
+
+    public void addChild(Child child) {
+        if (child.getId() == null || child.getId().isEmpty()) {
+            child.setId(UUID.randomUUID().toString());
+        }
+        
+        List<Child> children = getAllChildren();
+        children.add(child);
+        saveChildren(children);
+    }
+
+
+    public void updateChild(Child child) {
+        List<Child> children = getAllChildren();
+        for (int i = 0; i < children.size(); i++) {
+            if (children.get(i).getId().equals(child.getId())) {
+                children.set(i, child);
+                saveChildren(children);
+                return;
+            }
+        }
+    }
+
+    public void updatePersonalBest(String childId, Integer personalBest) {
+        Child child = getChildById(childId);
+        if (child != null) {
+            child.setPersonalBest(personalBest);
+            updateChild(child);
+        }
+    }
+
+    public Child getChildById(String childId) {
+        List<Child> children = getAllChildren();
+        for (Child child : children) {
+            if (child.getId().equals(childId)) {
+                return child;
+            }
+        }
+        return null;
+    }
+
+    public List<Child> getAllChildren() {
+        String jsonString = sharedPreferences.getString(KEY_CHILDREN, null);
+        if (jsonString == null || jsonString.isEmpty()) {
+            return new ArrayList<>();
+        }
+        
+        List<Child> children = new ArrayList<>();
+        try {
+            JSONArray jsonArray = new JSONArray(jsonString);
+            for (int i = 0; i < jsonArray.length(); i++) {
+                JSONObject jsonObject = jsonArray.getJSONObject(i);
+                Child child = Child.fromJSON(jsonObject);
+                children.add(child);
+            }
+        } catch (JSONException e) {
+            Log.e(TAG, "Error reading children from JSON", e);
+        }
+        
+        return children;
+    }
+
+    public void deleteChild(String childId) {
+        List<Child> children = getAllChildren();
+        children.removeIf(child -> child.getId().equals(childId));
+        saveChildren(children);
+    }
+
+    private void saveChildren(List<Child> children) {
+        try {
+            JSONArray jsonArray = new JSONArray();
+            for (Child child : children) {
+                jsonArray.put(child.toJSON());
+            }
+            sharedPreferences.edit().putString(KEY_CHILDREN, jsonArray.toString()).apply();
+        } catch (Exception e) {
+            Log.e(TAG, "Error saving children to JSON", e);
+        }
+    }
+}
+
Index: app/src/main/java/com/example/smartair/models/UserRole.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/models/UserRole.java b/app/src/main/java/com/example/smartair/models/UserRole.java
new file mode 100644
--- /dev/null	(date 1763918002073)
+++ b/app/src/main/java/com/example/smartair/models/UserRole.java	(date 1763918002073)
@@ -0,0 +1,26 @@
+package com.example.smartair.models;
+
+public enum UserRole {
+    CHILD("child"),
+    PARENT("parent"),
+    PROVIDER("provider");
+
+    private final String value;
+
+    UserRole(String value) {
+        this.value = value;
+    }
+
+    public String getValue() {
+        return value;
+    }
+
+    public static UserRole fromString(String value) {
+        for (UserRole role : UserRole.values()) {
+            if (role.value.equalsIgnoreCase(value)) {
+                return role;
+            }
+        }
+        throw new IllegalArgumentException("Unknown role: " + value);
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/child_managent/Child.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/Child.java b/app/src/main/java/com/example/smartair/child_managent/Child.java
new file mode 100644
--- /dev/null	(date 1763918002066)
+++ b/app/src/main/java/com/example/smartair/child_managent/Child.java	(date 1763918002066)
@@ -0,0 +1,31 @@
+package com.example.smartair.child_managent;
+
+public class Child {
+
+    private String id;
+    private String username;
+    private String password;
+    private String name;
+    private String dob;
+    private String notes;
+
+    public Child() {}
+
+    public Child(String id, String username, String password, String name, String dob, String notes) {
+        this.id = id;
+        this.username = username;
+        this.password = password;
+        this.name = name;
+        this.dob = dob;
+        this.notes = notes;
+    }
+
+    public String getId() { return id; }
+    public void setId(String id) { this.id = id; }
+
+    public String getUsername() { return username; }
+    public String getPassword() { return password; }
+    public String getName() { return name; }
+    public String getDob() { return dob; }
+    public String getNotes() { return notes; }
+}
Index: app/src/main/java/com/example/smartair/child_managent/AddChildActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/AddChildActivity.java b/app/src/main/java/com/example/smartair/child_managent/AddChildActivity.java
new file mode 100644
--- /dev/null	(date 1763918002065)
+++ b/app/src/main/java/com/example/smartair/child_managent/AddChildActivity.java	(date 1763918002065)
@@ -0,0 +1,179 @@
+package com.example.smartair.child_managent;
+
+import android.app.DatePickerDialog;
+import android.content.Intent;
+import android.os.Bundle;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.DocumentReference;
+import com.google.firebase.firestore.FieldValue;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.google.firebase.firestore.WriteBatch;
+
+import java.util.Calendar;
+import java.util.HashMap;
+import java.util.Map;
+
+public class AddChildActivity extends AppCompatActivity {
+
+    private EditText editChildUsername, editChildPassword;
+    private EditText editChildName, editChildNotes;
+
+    private TextView textDOB;
+    private Button btnPickDate, btnAddChild;
+    private String selectedDOB = "";
+
+    private FirebaseFirestore db;
+    private FirebaseAuth auth;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_add_child);
+
+        db = FirebaseFirestore.getInstance();
+        auth = FirebaseAuth.getInstance();
+
+        FirebaseUser parent = auth.getCurrentUser();
+        if (parent == null) {
+            Toast.makeText(this, "Please log in first.", Toast.LENGTH_SHORT).show();
+            finish();
+            return;
+        }
+
+        editChildUsername = findViewById(R.id.editChildUsername);
+        editChildPassword = findViewById(R.id.editChildPassword);
+        editChildName = findViewById(R.id.editChildName);
+        editChildNotes = findViewById(R.id.editChildNotes);
+        btnAddChild = findViewById(R.id.btnAddChild);
+
+        textDOB = findViewById(R.id.textDOB);
+        btnPickDate = findViewById(R.id.btnPickDate);
+
+        btnPickDate.setOnClickListener(v -> showDatePickerDialog());
+        btnAddChild.setOnClickListener(v -> checkUsernameAndAddChild());
+    }
+
+    private void showDatePickerDialog() {
+        final Calendar c = Calendar.getInstance();
+        int year = c.get(Calendar.YEAR);
+        int month = c.get(Calendar.MONTH);
+        int day = c.get(Calendar.DAY_OF_MONTH);
+
+        DatePickerDialog dialog = new DatePickerDialog(
+                this,
+                (view, yr, mo, dy) -> {
+                    String dob = String.format("%02d/%02d/%d", dy, mo + 1, yr);
+                    selectedDOB = dob;
+                    textDOB.setText("Date of Birth: " + dob);
+                },
+                year, month, day
+        );
+        dialog.getDatePicker().setMaxDate(System.currentTimeMillis());
+        dialog.show();
+    }
+
+    private void checkUsernameAndAddChild() {
+        String username = editChildUsername.getText().toString().trim();
+        String password = editChildPassword.getText().toString().trim();
+        String name = editChildName.getText().toString().trim();
+        String dob = selectedDOB;
+        String notes = editChildNotes.getText().toString().trim();
+
+        if (username.isEmpty() || password.isEmpty()) {
+            Toast.makeText(this, "Username and password required.", Toast.LENGTH_SHORT).show();
+            return;
+        }
+        if (name.isEmpty() || dob.isEmpty()) {
+            Toast.makeText(this, "Name and DOB required.", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        String generatedEmail = username + "@child.smartair.com";
+
+        FirebaseUser parent = auth.getCurrentUser();
+        if (parent == null) {
+            Toast.makeText(this, "Session expired. Log in again.", Toast.LENGTH_SHORT).show();
+            return;
+        }
+        String parentId = parent.getUid();
+
+        DocumentReference usernameRef = db.collection("usernames").document(username);
+
+        usernameRef.get().addOnSuccessListener(doc -> {
+            if (doc.exists()) {
+                Toast.makeText(this, "Username already exists.", Toast.LENGTH_LONG).show();
+            } else {
+                saveChildFirestore(
+                        parent.getUid(),
+                        generatedEmail,
+                        password,
+                        username,
+                        name,
+                        dob,
+                        notes
+                );
+            }
+        }).addOnFailureListener(e ->
+                Toast.makeText(this, "Username check failed: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+    }
+
+    private void saveChildFirestore(
+            String parentId,
+            String email,
+            String password,
+            String username,
+            String name,
+            String dob,
+            String notes
+    ) {
+        WriteBatch batch = db.batch();
+
+        // Create a new child document with random ID
+        DocumentReference childRef = db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .document();
+
+        String childUid = childRef.getId();
+
+        DocumentReference usernameRef = db.collection("usernames").document(username);
+
+        Map<String, Object> child = new HashMap<>();
+        child.put("uid", childUid);
+        child.put("email", email);
+        child.put("password", password);
+        child.put("username", username);
+        child.put("name", name);
+        child.put("dob", dob);
+        child.put("notes", notes);
+        child.put("createdAt", FieldValue.serverTimestamp());
+
+        Map<String, Object> usernameMap = new HashMap<>();
+        usernameMap.put("email", email);
+        usernameMap.put("childUid", childUid);
+        usernameMap.put("parentId", parentId);
+
+        batch.set(childRef, child);
+        batch.set(usernameRef, usernameMap);
+
+        batch.commit()
+                .addOnSuccessListener(aVoid -> {
+                    Toast.makeText(this, "Child added successfully!", Toast.LENGTH_SHORT).show();
+
+                    startActivity(new Intent(this, ViewChildrenActivity.class));
+                    finish();
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "Firestore save failed: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+    }
+
+}
Index: app/src/main/java/com/example/smartair/child_managent/ChooseChildForSharingActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/ChooseChildForSharingActivity.java b/app/src/main/java/com/example/smartair/child_managent/ChooseChildForSharingActivity.java
new file mode 100644
--- /dev/null	(date 1763918002067)
+++ b/app/src/main/java/com/example/smartair/child_managent/ChooseChildForSharingActivity.java	(date 1763918002067)
@@ -0,0 +1,96 @@
+package com.example.smartair.child_managent;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.view.View;
+import android.widget.ProgressBar;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+
+import com.example.smartair.R;
+import com.example.smartair.sharing.ManageSharingActivity;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.google.firebase.firestore.QueryDocumentSnapshot;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public class ChooseChildForSharingActivity extends AppCompatActivity {
+
+    private RecyclerView recyclerChildren;
+    private ChildAdapter adapter;
+    private List<Child> childList = new ArrayList<>();
+    private ProgressBar loadingIndicator;
+
+    private FirebaseFirestore db;
+    private String parentId;
+    private String mode = "sharing";
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_choose_child_for_sharing);
+
+        db = FirebaseFirestore.getInstance();
+        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+        loadingIndicator = findViewById(R.id.loadingIndicator);
+        recyclerChildren = findViewById(R.id.recyclerChildren);
+        recyclerChildren.setLayoutManager(new LinearLayoutManager(this));
+        String m = getIntent().getStringExtra("mode");
+        if (m != null) mode = m;
+
+        loadingIndicator = findViewById(R.id.loadingIndicator);
+        recyclerChildren = findViewById(R.id.recyclerChildren);
+        recyclerChildren.setLayoutManager(new LinearLayoutManager(this));
+        adapter = new ChildAdapter(childList, (child, childId) -> {
+            Intent intent;
+            if ("manageChild".equals(mode)) {
+                intent = new Intent(this, ManageChildActivity.class);
+            } else {
+                intent = new Intent(this, ManageSharingActivity.class);
+            }
+            intent.putExtra("childId", childId);
+            startActivity(intent);
+        });
+
+        recyclerChildren.setAdapter(adapter);
+        loadChildren();
+
+    }
+
+    private void loadChildren() {
+        loadingIndicator.setVisibility(View.VISIBLE);
+        recyclerChildren.setVisibility(View.GONE);
+
+        db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .get()
+                .addOnSuccessListener(snapshot -> {
+                    loadingIndicator.setVisibility(View.GONE);
+                    recyclerChildren.setVisibility(View.VISIBLE);
+                    if (snapshot.isEmpty()) {
+                        Toast.makeText(this, "No children added yet!", Toast.LENGTH_LONG).show();
+                        finish();
+                        return;
+                    }
+
+                    childList.clear();
+                    for (QueryDocumentSnapshot doc : snapshot) {
+                        Child child = doc.toObject(Child.class);
+                        child.setId(doc.getId());
+                        childList.add(child);
+                    }
+                    adapter.notifyDataSetChanged();
+                })
+                .addOnFailureListener(e -> {
+                    loadingIndicator.setVisibility(View.GONE);
+                    Toast.makeText(this, "Error loading children: " + e.getMessage(), Toast.LENGTH_LONG).show();
+                });
+    }
+}
Index: app/src/main/java/com/example/smartair/child_managent/ChildAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/ChildAdapter.java b/app/src/main/java/com/example/smartair/child_managent/ChildAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002067)
+++ b/app/src/main/java/com/example/smartair/child_managent/ChildAdapter.java	(date 1763918002067)
@@ -0,0 +1,68 @@
+package com.example.smartair.child_managent;
+
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.TextView;
+import androidx.annotation.NonNull;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+
+import java.util.List;
+
+public class ChildAdapter extends RecyclerView.Adapter<ChildAdapter.ChildViewHolder> {
+
+    private List<Child> childList;
+    private OnChildClickListener listener;
+
+    // Interface for click handling
+    public interface OnChildClickListener {
+        void onChildClick(Child child, String childId);
+    }
+
+    public ChildAdapter(List<Child> childList, OnChildClickListener listener) {
+        this.childList = childList;
+        this.listener = listener;
+    }
+
+    @NonNull
+    @Override
+    public ChildViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(parent.getContext())
+                .inflate(R.layout.item_child, parent, false);
+        return new ChildViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull ChildViewHolder holder, int position) {
+        Child child = childList.get(position);
+
+        holder.txtChildName.setText(child.getName());
+        holder.txtChildDOB.setText("DOB: " + child.getDob());
+        holder.txtChildNotes.setText("Notes: " + child.getNotes());
+
+        // Add the click listener(runs when clicked)
+        holder.itemView.setOnClickListener(v -> {
+            if (listener != null) {
+                listener.onChildClick(child, child.getId());
+            }
+        });
+    }
+
+    @Override
+    public int getItemCount() {
+        return childList.size();
+    }
+
+    public static class ChildViewHolder extends RecyclerView.ViewHolder {
+        TextView txtChildName, txtChildDOB, txtChildNotes;
+
+        public ChildViewHolder(@NonNull View itemView) {
+            super(itemView);
+            txtChildName = itemView.findViewById(R.id.txtChildName);
+            txtChildDOB = itemView.findViewById(R.id.txtChildDOB);
+            txtChildNotes = itemView.findViewById(R.id.txtChildNotes);
+        }
+    }
+}
Index: app/src/main/java/com/example/smartair/auth/LoginPresenter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/LoginPresenter.java b/app/src/main/java/com/example/smartair/auth/LoginPresenter.java
new file mode 100644
--- /dev/null	(date 1763918002062)
+++ b/app/src/main/java/com/example/smartair/auth/LoginPresenter.java	(date 1763918002062)
@@ -0,0 +1,65 @@
+package com.example.smartair.auth;
+
+import android.text.TextUtils;
+import android.util.Patterns;
+
+import com.example.smartair.models.UserRole;
+
+public class LoginPresenter implements LoginContract.Presenter {
+
+    private LoginContract.View view;
+    private final AuthModel model;
+
+    public LoginPresenter(LoginContract.View view, AuthModel model) {
+        this.view = view;
+        this.model = model;
+    }
+
+    @Override
+    public void onLoginClicked() {
+        if (view == null) {
+            return;
+        }
+
+        String email = view.getEmail();
+        String password = view.getPassword();
+
+        if (TextUtils.isEmpty(email) || TextUtils.isEmpty(password)) {
+            view.showError("Email and password are required.");
+            return;
+        }
+
+        if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
+            view.showError("Please enter a valid email address.");
+            return;
+        }
+
+        if (password.length() < 6) {
+            view.showError("Password must be at least 6 characters.");
+            return;
+        }
+
+        view.showLoading();
+
+        model.login(email, password, new AuthModel.AuthCallback() {
+            @Override
+            public void onSuccess(UserRole role) {
+                if (view == null) return;
+                view.hideLoading();
+                view.navigateToHome(role);
+            }
+
+            @Override
+            public void onError(String message) {
+                if (view == null) return;
+                view.hideLoading();
+                view.showError("Login failed: " + message);
+            }
+        });
+    }
+
+    @Override
+    public void onDestroy() {
+        view = null;
+    }
+}
Index: app/src/main/java/com/example/smartair/auth/LoginContract.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/LoginContract.java b/app/src/main/java/com/example/smartair/auth/LoginContract.java
new file mode 100644
--- /dev/null	(date 1763918002061)
+++ b/app/src/main/java/com/example/smartair/auth/LoginContract.java	(date 1763918002061)
@@ -0,0 +1,20 @@
+package com.example.smartair.auth;
+
+import com.example.smartair.models.UserRole;
+
+public interface LoginContract {
+
+    interface View {
+        void showLoading();
+        void hideLoading();
+        void showError(String message);
+        void navigateToHome(UserRole role);
+        String getEmail();
+        String getPassword();
+    }
+
+    interface Presenter {
+        void onLoginClicked();
+        void onDestroy();
+    }
+}
Index: app/src/main/java/com/example/smartair/unsure/SignUpActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/unsure/SignUpActivity.java b/app/src/main/java/com/example/smartair/unsure/SignUpActivity.java
new file mode 100644
--- /dev/null	(date 1763918002086)
+++ b/app/src/main/java/com/example/smartair/unsure/SignUpActivity.java	(date 1763918002086)
@@ -0,0 +1,78 @@
+package com.example.smartair.unsure;
+
+import android.os.Bundle;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.RadioButton;
+import android.widget.RadioGroup;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.HashMap;
+import java.util.Map;
+
+public class SignUpActivity extends AppCompatActivity {
+    private EditText etEmail, etPassword;
+    private Button btnRegister;
+    private RadioGroup rgRole;
+    private FirebaseAuth mAuth;
+    private FirebaseFirestore db;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_sign_up);
+
+        etEmail = findViewById(R.id.etEmail);
+        etPassword = findViewById(R.id.etPassword);
+        btnRegister = findViewById(R.id.btnRegister);
+        rgRole = findViewById(R.id.rgRole);
+
+        mAuth = FirebaseAuth.getInstance();
+        db = FirebaseFirestore.getInstance();
+
+        btnRegister.setOnClickListener(v -> registerUser());
+    }
+
+    private void registerUser() {
+        String email = etEmail.getText().toString().trim();
+        String password = etPassword.getText().toString().trim();
+
+        int selectedId = rgRole.getCheckedRadioButtonId();
+        if(selectedId == -1) {
+            Toast.makeText(this, "Please select a role", Toast.LENGTH_SHORT).show();
+            return;
+        }
+        RadioButton rb = findViewById(selectedId);
+        String role = rb.getText().toString().toLowerCase(); // child/parent/provider
+
+        if(email.isEmpty() || password.isEmpty()) {
+            Toast.makeText(this, "Email and password cannot be empty", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        mAuth.createUserWithEmailAndPassword(email, password)
+                .addOnCompleteListener(this, task -> {
+                    if(task.isSuccessful()) {
+                        String uid = mAuth.getCurrentUser().getUid();
+                        Map<String, Object> user = new HashMap<>();
+                        user.put("email", email);
+                        user.put("role", role);
+
+                        db.collection("users").document(uid)
+                                .set(user)
+                                .addOnSuccessListener(aVoid -> Toast.makeText(this, "Registration successful!", Toast.LENGTH_SHORT).show())
+                                .addOnFailureListener(e -> Toast.makeText(this, "Failed to save user: " + e.getMessage(), Toast.LENGTH_SHORT).show());
+
+                        finish(); // 返回登录页面
+                    } else {
+                        Toast.makeText(this, "Registration Failed: " + task.getException().getMessage(), Toast.LENGTH_SHORT).show();
+                    }
+                });
+    }
+}
Index: app/src/main/java/com/example/smartair/auth/RegisterActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/auth/RegisterActivity.java b/app/src/main/java/com/example/smartair/auth/RegisterActivity.java
new file mode 100644
--- /dev/null	(date 1763918002062)
+++ b/app/src/main/java/com/example/smartair/auth/RegisterActivity.java	(date 1763918002062)
@@ -0,0 +1,137 @@
+package com.example.smartair.auth;
+
+import android.os.Bundle;
+import android.os.Handler;
+import android.os.Looper;
+import android.view.View;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.ProgressBar;
+import android.widget.RadioGroup;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.example.smartair.models.UserRole;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.HashMap;
+import java.util.Map;
+
+public class RegisterActivity extends AppCompatActivity {
+
+    private EditText nameEditText, emailEditText, passwordEditText, confirmPasswordEditText;
+    private RadioGroup roleRadioGroup;
+    private Button registerButton;
+    private ProgressBar progressBar;
+    private TextView backToLoginTextView;
+
+    private AuthModel authModel;
+    private FirebaseFirestore db;
+    private Handler timeoutHandler = new Handler(Looper.getMainLooper());
+    private Runnable timeoutRunnable;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_register);
+
+        nameEditText = findViewById(R.id.nameEditText);
+        emailEditText = findViewById(R.id.emailEditText);
+        passwordEditText = findViewById(R.id.passwordEditText);
+        confirmPasswordEditText = findViewById(R.id.confirmPasswordEditText);
+        roleRadioGroup = findViewById(R.id.roleRadioGroup);
+        registerButton = findViewById(R.id.registerButton);
+        progressBar = findViewById(R.id.progressBar);
+        backToLoginTextView = findViewById(R.id.backToLoginTextView);
+
+        authModel = new AuthModel();
+        db = FirebaseFirestore.getInstance();
+
+        registerButton.setOnClickListener(v -> register());
+        backToLoginTextView.setOnClickListener(v -> finish());
+    }
+
+    private void register() {
+        String name = nameEditText.getText().toString().trim();
+        String email = emailEditText.getText().toString().trim();
+        String password = passwordEditText.getText().toString().trim();
+        String confirmPassword = confirmPasswordEditText.getText().toString().trim();
+
+        if (name.isEmpty() || email.isEmpty() || password.isEmpty() || confirmPassword.isEmpty()) {
+            Toast.makeText(this, "All fields are required.", Toast.LENGTH_LONG).show();
+            return;
+        }
+
+        if (!android.util.Patterns.EMAIL_ADDRESS.matcher(email).matches()) {
+            Toast.makeText(this, "Invalid email address.", Toast.LENGTH_LONG).show();
+            return;
+        }
+
+        if (!password.equals(confirmPassword)) {
+            Toast.makeText(this, "Passwords do not match.", Toast.LENGTH_LONG).show();
+            return;
+        }
+
+        // 固定写死 role，也可以按界面选择
+        UserRole role = UserRole.CHILD;
+        int checkedId = roleRadioGroup.getCheckedRadioButtonId();
+        if (checkedId == R.id.radioParent) role = UserRole.PARENT;
+        else if (checkedId == R.id.radioProvider) role = UserRole.PROVIDER;
+
+        progressBar.setVisibility(android.view.View.VISIBLE);
+        registerButton.setEnabled(false);
+
+        // 超时处理
+        timeoutRunnable = () -> {
+            progressBar.setVisibility(android.view.View.GONE);
+            registerButton.setEnabled(true);
+            Toast.makeText(RegisterActivity.this, "Request timed out.", Toast.LENGTH_LONG).show();
+        };
+        timeoutHandler.postDelayed(timeoutRunnable, 15000);
+
+        authModel.register(email, password, role, new AuthModel.AuthCallback() {
+            @Override
+            public void onSuccess(UserRole r) {
+                timeoutHandler.removeCallbacks(timeoutRunnable);
+
+                // 注册成功后把用户信息写入 Firestore
+                String uid = authModel.mAuth.getCurrentUser().getUid();
+                Map<String, Object> userMap = new HashMap<>();
+                userMap.put("name", name);
+                userMap.put("email", email);
+                userMap.put("role", r.getValue()); // ✅ 用枚举 getValue 写入 Firestore
+
+                db.collection("users").document(uid)
+                        .set(userMap)
+                        .addOnSuccessListener(aVoid -> {
+                            progressBar.setVisibility(android.view.View.GONE);
+                            registerButton.setEnabled(true);
+                            Toast.makeText(RegisterActivity.this, "Registration successful!", Toast.LENGTH_LONG).show();
+                            finish(); // 返回登录页
+                        })
+                        .addOnFailureListener(e -> {
+                            progressBar.setVisibility(android.view.View.GONE);
+                            registerButton.setEnabled(true);
+                            Toast.makeText(RegisterActivity.this, "Failed to save user: " + e.getMessage(), Toast.LENGTH_LONG).show();
+                        });
+            }
+
+            @Override
+            public void onError(String message) {
+                timeoutHandler.removeCallbacks(timeoutRunnable);
+                progressBar.setVisibility(android.view.View.GONE);
+                registerButton.setEnabled(true);
+                Toast.makeText(RegisterActivity.this, "Registration failed: " + message, Toast.LENGTH_LONG).show();
+            }
+        });
+    }
+
+    @Override
+    protected void onDestroy() {
+        super.onDestroy();
+        timeoutHandler.removeCallbacksAndMessages(null);
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/homepages/HomepageActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/homepages/HomepageActivity.java b/app/src/main/java/com/example/smartair/homepages/HomepageActivity.java
new file mode 100644
--- /dev/null	(date 1763918002070)
+++ b/app/src/main/java/com/example/smartair/homepages/HomepageActivity.java	(date 1763918002070)
@@ -0,0 +1,61 @@
+package com.example.smartair.homepages;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.view.View;
+import android.widget.Button;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+
+import com.example.smartair.R;
+
+import com.example.smartair.badges_system.BadgeActivity;
+import com.example.smartair.medicine_logs.LogMedicineActivity;
+import com.example.smartair.pre_post_checks.PrePostCheckActivity;
+import com.example.smartair.technique_guidance.TechniqueActivity;
+import com.example.smartair.ui.child.ChildPEFActivity;
+import com.example.smartair.ui.child.ChildTriageActivity;
+
+
+public class HomepageActivity extends AppCompatActivity {
+
+    private Button btnLogMedicine;
+    private Button btnTechnique;
+    private Button btnPrePostCheck;
+    private Button btnBadge; // 只声明，不初始化
+    private Button btnCheckPeakFlow;
+    private Button btnCheckSymptom;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_homepage); // 确保布局文件存在
+
+        // 初始化按钮
+        btnLogMedicine = findViewById(R.id.btnLogMedicine);
+        btnTechnique = findViewById(R.id.btnTechnique);
+        btnPrePostCheck = findViewById(R.id.btnPrePostCheck);
+        btnBadge = findViewById(R.id.btnBadges); // ✅ 放到这里初始化
+        btnCheckPeakFlow = findViewById(R.id.btnCheckPeakFlow);
+        btnCheckSymptom = findViewById(R.id.btnCheckSymptom);
+
+
+        btnLogMedicine.setOnClickListener(v ->
+                startActivity(new Intent(this, LogMedicineActivity.class)));
+
+        btnTechnique.setOnClickListener(v ->
+                startActivity(new Intent(this, TechniqueActivity.class)));
+
+        btnPrePostCheck.setOnClickListener(v ->
+                startActivity(new Intent(this, PrePostCheckActivity.class)));
+
+        btnBadge.setOnClickListener(v ->
+                startActivity(new Intent(this, BadgeActivity.class)));
+        btnCheckPeakFlow.setOnClickListener(v ->
+                startActivity(new Intent(this, ChildPEFActivity.class)));
+        btnCheckSymptom.setOnClickListener(v ->
+                startActivity(new Intent(this, ChildTriageActivity.class)));
+
+    }
+}
Index: app/src/main/java/com/example/smartair/sharing/ManageSharingActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/sharing/ManageSharingActivity.java b/app/src/main/java/com/example/smartair/sharing/ManageSharingActivity.java
new file mode 100644
--- /dev/null	(date 1763918002079)
+++ b/app/src/main/java/com/example/smartair/sharing/ManageSharingActivity.java	(date 1763918002079)
@@ -0,0 +1,190 @@
+package com.example.smartair.sharing;
+
+import android.os.Bundle;
+import android.os.Handler;
+import android.os.Looper;
+import android.view.View;
+import android.widget.CompoundButton;
+import android.widget.ProgressBar;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.appcompat.widget.SwitchCompat;
+
+import com.example.smartair.R;
+import com.google.firebase.firestore.SetOptions;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.DocumentReference;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.HashMap;
+import java.util.Map;
+
+public class ManageSharingActivity extends AppCompatActivity {
+
+    private SwitchCompat switchRescue, switchController, switchSymptoms, switchTriggers;
+    private SwitchCompat switchPEF, switchTriage, switchCharts;
+
+    private TextView tagRescue, tagController, tagSymptoms, tagTriggers;
+    private TextView tagPEF, tagTriage, tagCharts;
+
+    private ProgressBar loadingIndicator;
+    private TextView textSaving;
+
+    private String parentId, childId;
+    private DocumentReference docRef;
+    private FirebaseFirestore db;
+
+    private boolean isLoading = true;
+
+    private Handler debounceHandler = new Handler(Looper.getMainLooper());
+    private Runnable saveRunnable;
+    private static final long DEBOUNCE_DELAY = 800;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_manage_sharing);
+
+        db = FirebaseFirestore.getInstance();
+        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+        childId = getIntent().getStringExtra("childId");
+
+        if (childId == null) {
+            Toast.makeText(this, "Error: No child selected.", Toast.LENGTH_LONG).show();
+            finish();
+            return;
+        }
+
+        docRef = db.collection("parents")
+                .document(parentId)
+                .collection("children")
+                .document(childId)
+                .collection("settings")
+                .document("sharing");
+
+        switchRescue = findViewById(R.id.switchRescueLogs);
+        switchController = findViewById(R.id.switchController);
+        switchSymptoms = findViewById(R.id.switchSymptoms);
+        switchTriggers = findViewById(R.id.switchTriggers);
+        switchPEF = findViewById(R.id.switchPEF);
+        switchTriage = findViewById(R.id.switchTriage);
+        switchCharts = findViewById(R.id.switchCharts);
+
+        tagRescue = findViewById(R.id.tagRescue);
+        tagController = findViewById(R.id.tagController);
+        tagSymptoms = findViewById(R.id.tagSymptoms);
+        tagTriggers = findViewById(R.id.tagTriggers);
+        tagPEF = findViewById(R.id.tagPEF);
+        tagTriage = findViewById(R.id.tagTriage);
+        tagCharts = findViewById(R.id.tagCharts);
+
+        loadingIndicator = findViewById(R.id.loadingIndicator);
+        textSaving = findViewById(R.id.textSaving);
+
+        saveRunnable = this::saveAllSettings;
+
+        loadExistingSettings();
+    }
+
+    private void loadExistingSettings() {
+        loadingIndicator.setVisibility(View.VISIBLE);
+        textSaving.setVisibility(View.GONE);
+        isLoading = true;
+
+        docRef.get().addOnSuccessListener(doc -> {
+            if (doc.exists()) {
+
+                setToggleState(switchRescue, tagRescue, doc.getBoolean("rescueLogs"));
+                setToggleState(switchController, tagController, doc.getBoolean("controller"));
+                setToggleState(switchSymptoms, tagSymptoms, doc.getBoolean("symptoms"));
+                setToggleState(switchTriggers, tagTriggers, doc.getBoolean("triggers"));
+                setToggleState(switchPEF, tagPEF, doc.getBoolean("pef"));
+                setToggleState(switchTriage, tagTriage, doc.getBoolean("triage"));
+                setToggleState(switchCharts, tagCharts, doc.getBoolean("charts"));
+            }
+
+            isLoading = false;
+            loadingIndicator.setVisibility(View.GONE);
+            setupToggleListeners();
+
+        }).addOnFailureListener(e -> {
+            isLoading = false;
+            loadingIndicator.setVisibility(View.GONE);
+            setupToggleListeners();
+            Toast.makeText(this, "Failed to load settings.", Toast.LENGTH_LONG).show();
+        });
+    }
+
+    private void setToggleState(SwitchCompat sw, TextView tag, Boolean value) {
+        boolean checked = Boolean.TRUE.equals(value);
+        sw.setChecked(checked);
+        tag.setVisibility(checked ? View.VISIBLE : View.GONE);
+    }
+
+    private void setupToggleListeners() {
+
+        CompoundButton.OnCheckedChangeListener listener = (buttonView, isChecked) -> {
+
+            int id = buttonView.getId();
+
+            if (id == R.id.switchRescueLogs) tagRescue.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchController) tagController.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchSymptoms) tagSymptoms.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchTriggers) tagTriggers.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchPEF) tagPEF.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchTriage) tagTriage.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+            else if (id == R.id.switchCharts) tagCharts.setVisibility(isChecked ? View.VISIBLE : View.GONE);
+
+            if (!isLoading) {
+                textSaving.setVisibility(View.VISIBLE);
+                textSaving.setText("Saving...");
+
+                debounceHandler.removeCallbacks(saveRunnable);
+                debounceHandler.postDelayed(saveRunnable, DEBOUNCE_DELAY);
+            }
+        };
+
+        switchRescue.setOnCheckedChangeListener(listener);
+        switchController.setOnCheckedChangeListener(listener);
+        switchSymptoms.setOnCheckedChangeListener(listener);
+        switchTriggers.setOnCheckedChangeListener(listener);
+        switchPEF.setOnCheckedChangeListener(listener);
+        switchTriage.setOnCheckedChangeListener(listener);
+        switchCharts.setOnCheckedChangeListener(listener);
+    }
+
+    private void saveAllSettings() {
+
+        Map<String, Object> data = new HashMap<>();
+        data.put("rescueLogs", switchRescue.isChecked());
+        data.put("controller", switchController.isChecked());
+        data.put("symptoms", switchSymptoms.isChecked());
+        data.put("triggers", switchTriggers.isChecked());
+        data.put("pef", switchPEF.isChecked());
+        data.put("triage", switchTriage.isChecked());
+        data.put("charts", switchCharts.isChecked());
+
+        docRef.set(data, SetOptions.merge())
+                .addOnSuccessListener(a -> {
+                    textSaving.setText("All changes saved!");
+
+                    textSaving.postDelayed(() -> {
+                        textSaving.setVisibility(View.GONE);
+                        textSaving.setText("Saving...");
+                    }, 1500);
+                })
+                .addOnFailureListener(e -> {
+                    textSaving.setVisibility(View.GONE);
+                    Toast.makeText(this, "Error saving settings", Toast.LENGTH_SHORT).show();
+                });
+    }
+
+
+    @Override
+    protected void onDestroy() {
+        super.onDestroy();
+        debounceHandler.removeCallbacks(saveRunnable);
+    }
+}
Index: app/src/main/java/com/example/smartair/homepages/HomepageProvidersActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/homepages/HomepageProvidersActivity.java b/app/src/main/java/com/example/smartair/homepages/HomepageProvidersActivity.java
new file mode 100644
--- /dev/null	(date 1763918002071)
+++ b/app/src/main/java/com/example/smartair/homepages/HomepageProvidersActivity.java	(date 1763918002071)
@@ -0,0 +1,26 @@
+package com.example.smartair.homepages;
+
+import android.os.Bundle;
+
+import androidx.activity.EdgeToEdge;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.graphics.Insets;
+import androidx.core.view.ViewCompat;
+import androidx.core.view.WindowInsetsCompat;
+
+import com.example.smartair.R;
+
+public class HomepageProvidersActivity extends AppCompatActivity {
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        EdgeToEdge.enable(this);
+        setContentView(R.layout.activity_homepage_providers);
+        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -> {
+            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());
+            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);
+            return insets;
+        });
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/homepages/HomepageParentsActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/homepages/HomepageParentsActivity.java b/app/src/main/java/com/example/smartair/homepages/HomepageParentsActivity.java
new file mode 100644
--- /dev/null	(date 1763918002070)
+++ b/app/src/main/java/com/example/smartair/homepages/HomepageParentsActivity.java	(date 1763918002070)
@@ -0,0 +1,60 @@
+package com.example.smartair.homepages;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.widget.Button;
+
+import androidx.activity.EdgeToEdge;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.graphics.Insets;
+import androidx.core.view.ViewCompat;
+import androidx.core.view.WindowInsetsCompat;
+
+import com.example.smartair.R;
+import com.example.smartair.child_managent.AddChildActivity;
+import com.example.smartair.child_managent.ChooseChildForSharingActivity;
+import com.example.smartair.child_managent.ManageChildActivity;
+import com.example.smartair.child_managent.ViewChildrenActivity;
+import com.example.smartair.ui.parent.ParentHomeActivity;
+
+public class HomepageParentsActivity extends AppCompatActivity {
+
+    private Button btnAddChild;
+    private Button btnViewChildren;
+    private Button btnManageChild;
+    private Button btnManageSharing;
+    private Button btnManagePB;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_homepage_parents); // 你的新布局文件
+
+        // 初始化按钮
+        btnAddChild = findViewById(R.id.btnAddChild);
+        btnViewChildren = findViewById(R.id.btnViewChildren);
+        btnManageChild = findViewById(R.id.btnManageChild);
+        btnManageSharing = findViewById(R.id.btnManageSharing);
+        btnManagePB = findViewById(R.id.btnManagePB);
+
+
+        // 设置点击事件
+        btnAddChild.setOnClickListener(v ->
+                startActivity(new Intent(this, AddChildActivity.class)));
+
+        btnViewChildren.setOnClickListener(v ->
+                startActivity(new Intent(this, ViewChildrenActivity.class)));
+        btnManageChild.setOnClickListener(v -> {
+            Intent intent = new Intent(this, ChooseChildForSharingActivity.class);
+            intent.putExtra("mode", "manageChild");
+            startActivity(intent);
+        });
+        btnManageSharing.setOnClickListener(v -> {
+            Intent intent = new Intent(this, ChooseChildForSharingActivity.class);
+            intent.putExtra("mode", "sharing");
+            startActivity(intent);
+        });
+        btnManagePB.setOnClickListener(v ->
+                startActivity(new Intent(this, ParentHomeActivity.class)));
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/child_managent/ViewChildrenActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/ViewChildrenActivity.java b/app/src/main/java/com/example/smartair/child_managent/ViewChildrenActivity.java
new file mode 100644
--- /dev/null	(date 1763918002068)
+++ b/app/src/main/java/com/example/smartair/child_managent/ViewChildrenActivity.java	(date 1763918002068)
@@ -0,0 +1,103 @@
+package com.example.smartair.child_managent;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import android.os.Bundle;
+import android.widget.Toast;
+import android.content.Intent;
+
+import com.example.smartair.R;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.google.firebase.firestore.QueryDocumentSnapshot;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public class ViewChildrenActivity extends AppCompatActivity {
+
+    private RecyclerView recyclerChildren;
+    private ChildAdapter adapter;
+    private List<Child> childList = new ArrayList<>();
+
+    private FirebaseFirestore db;
+    private FirebaseAuth auth;
+    private FirebaseUser user;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.view_children_activity);
+
+        recyclerChildren = findViewById(R.id.recyclerChildren);
+        recyclerChildren.setLayoutManager(new LinearLayoutManager(this));
+
+        adapter = new ChildAdapter(childList, (child, childId) -> {
+            Intent intent = new Intent(ViewChildrenActivity.this, ManageChildActivity.class);
+            intent.putExtra("childId", childId);
+            intent.putExtra("username", child.getUsername());
+            intent.putExtra("password", child.getPassword());
+            intent.putExtra("name", child.getName());
+            intent.putExtra("dob", child.getDob());
+            intent.putExtra("notes", child.getNotes());
+            startActivity(intent);
+        });
+
+        recyclerChildren.setAdapter(adapter);
+
+        db = FirebaseFirestore.getInstance();
+        auth = FirebaseAuth.getInstance();
+        user = auth.getCurrentUser();
+
+        if (user == null && getIntent().getStringExtra("parentId") == null) {
+            Toast.makeText(this, "Please log in first.", Toast.LENGTH_SHORT).show();
+            finish();
+            return;
+        }
+
+        loadChildren();
+    }
+
+    private void loadChildren() {
+        String parentId = getIntent().getStringExtra("parentId");
+        if (parentId == null) {
+            FirebaseUser current = FirebaseAuth.getInstance().getCurrentUser();
+            if (current == null) {
+                Toast.makeText(this, "No authenticated user.", Toast.LENGTH_SHORT).show();
+                finish();
+                return;
+            }
+            parentId = current.getUid();
+        }
+
+        db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .addSnapshotListener((querySnapshot, error) -> {
+
+                    if (error != null) {
+                        Toast.makeText(this, "Error loading children.", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    childList.clear();
+
+                    if (querySnapshot == null || querySnapshot.isEmpty()) {
+                        Toast.makeText(this, "No children found.", Toast.LENGTH_SHORT).show();
+                        adapter.notifyDataSetChanged();
+                        return;
+                    }
+
+                    for (QueryDocumentSnapshot doc : querySnapshot) {
+                        Child child = doc.toObject(Child.class);
+                        child.setId(doc.getId());
+                        childList.add(child);
+                    }
+
+                    adapter.notifyDataSetChanged();
+                });
+    }
+}
Index: app/src/main/java/com/example/smartair/child_managent/ManageChildActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/child_managent/ManageChildActivity.java b/app/src/main/java/com/example/smartair/child_managent/ManageChildActivity.java
new file mode 100644
--- /dev/null	(date 1763918002068)
+++ b/app/src/main/java/com/example/smartair/child_managent/ManageChildActivity.java	(date 1763918002068)
@@ -0,0 +1,177 @@
+package com.example.smartair.child_managent;
+
+import android.app.DatePickerDialog;
+import android.content.Intent;
+import android.os.Bundle;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AlertDialog;
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.example.smartair.sharing.InviteProviderActivity;
+import com.example.smartair.sharing.ManageSharingActivity;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.DocumentReference;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.Calendar;
+import java.util.HashMap;
+import java.util.Map;
+
+public class ManageChildActivity extends AppCompatActivity {
+
+    private EditText editChildUsername, editChildPassword;
+    private EditText editChildName, editChildNotes;
+    private EditText editChildDOB;
+    private Button btnSave, btnDelete, btnInviteProvider, btnManageSharing;
+
+    private String childId;
+    private String parentId;
+
+    private FirebaseFirestore db;
+
+    private String selectedDOB = "";
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_manage_child);
+
+        db = FirebaseFirestore.getInstance();
+        parentId = FirebaseAuth.getInstance().getCurrentUser().getUid();
+
+        childId = getIntent().getStringExtra("childId");
+        if (childId == null) {
+            Toast.makeText(this, "Error: No child selected.", Toast.LENGTH_LONG).show();
+            finish();
+            return;
+        }
+
+        editChildUsername = findViewById(R.id.editChildUsername);
+        editChildPassword = findViewById(R.id.editChildPassword);
+        editChildName = findViewById(R.id.editChildName);
+        editChildDOB = findViewById(R.id.editChildDOB);
+        editChildNotes = findViewById(R.id.editChildNotes);
+
+        btnSave = findViewById(R.id.btnSave);
+        btnDelete = findViewById(R.id.btnDelete);
+        btnInviteProvider = findViewById(R.id.btnInviteProvider);
+        btnManageSharing = findViewById(R.id.btnManageSharing);
+
+        editChildDOB.setFocusable(false);
+        editChildDOB.setOnClickListener(v -> showDobPicker());
+
+        loadChildInfo();
+
+        btnSave.setOnClickListener(v -> updateChild());
+        btnDelete.setOnClickListener(v -> confirmDelete());
+        btnManageSharing.setOnClickListener(v -> {
+            Intent i = new Intent(ManageChildActivity.this, ManageSharingActivity.class);
+            i.putExtra("childId", childId);
+            startActivity(i);
+        });
+
+        btnInviteProvider.setOnClickListener(v -> {
+            Intent i = new Intent(ManageChildActivity.this, InviteProviderActivity.class);
+            i.putExtra("CHILD_ID", childId);
+            startActivity(i);
+        });
+    }
+
+    private void loadChildInfo() {
+        db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .document(childId)
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (!doc.exists()) {
+                        Toast.makeText(this, "Child data not found.", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    editChildUsername.setText(doc.getString("username"));
+                    editChildPassword.setText(doc.getString("password"));
+                    editChildName.setText(doc.getString("name"));
+                    editChildDOB.setText(doc.getString("dob"));
+                    editChildNotes.setText(doc.getString("notes"));
+                    selectedDOB = doc.getString("dob");
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "Failed to load child data.", Toast.LENGTH_SHORT).show()
+                );
+    }
+
+    private void showDobPicker() {
+        final Calendar c = Calendar.getInstance();
+
+        int year = c.get(Calendar.YEAR);
+        int month = c.get(Calendar.MONTH);
+        int day = c.get(Calendar.DAY_OF_MONTH);
+
+        DatePickerDialog dialog = new DatePickerDialog(
+                this,
+                (view, yr, mo, dy) -> {
+                    selectedDOB = String.format("%02d/%02d/%d", dy, mo + 1, yr);
+                    editChildDOB.setText(selectedDOB);
+                },
+                year, month, day
+        );
+        dialog.getDatePicker().setMaxDate(System.currentTimeMillis());
+        dialog.show();
+    }
+
+    private void updateChild() {
+        String username = editChildUsername.getText().toString().trim();
+        String password = editChildPassword.getText().toString().trim();
+        String name = editChildName.getText().toString().trim();
+        String notes = editChildNotes.getText().toString().trim();
+
+        if (username.isEmpty() || password.isEmpty() || name.isEmpty() || selectedDOB.isEmpty()) {
+            Toast.makeText(this, "All fields are required.", Toast.LENGTH_SHORT).show();
+            return;
+        }
+        Map<String, Object> updates = new HashMap<>();
+        updates.put("username", username);
+        updates.put("password", password);
+        updates.put("name", name);
+        updates.put("dob", selectedDOB);
+        updates.put("notes", notes);
+
+        db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .document(childId)
+                .update(updates)
+                .addOnSuccessListener(a -> Toast.makeText(this, "Child updated!", Toast.LENGTH_SHORT).show())
+                .addOnFailureListener(e -> Toast.makeText(this, "Update failed.", Toast.LENGTH_SHORT).show());
+    }
+
+    private void confirmDelete() {
+        new AlertDialog.Builder(this)
+                .setTitle("Delete Child")
+                .setMessage("Are you sure you want to permanently delete this child?")
+                .setPositiveButton("Delete", (d, w) -> deleteChild())
+                .setNegativeButton("Cancel", null)
+                .show();
+    }
+
+    private void deleteChild() {
+        db.collection("users")
+                .document(parentId)
+                .collection("children")
+                .document(childId)
+                .delete()
+                .addOnSuccessListener(a -> {
+                    Toast.makeText(this, "Child deleted.", Toast.LENGTH_SHORT).show();
+                    finish();
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "Delete failed.", Toast.LENGTH_SHORT).show()
+                );
+    }
+}
Index: app/src/main/java/com/example/smartair/sharing/InviteProviderActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/sharing/InviteProviderActivity.java b/app/src/main/java/com/example/smartair/sharing/InviteProviderActivity.java
new file mode 100644
--- /dev/null	(date 1763918002078)
+++ b/app/src/main/java/com/example/smartair/sharing/InviteProviderActivity.java	(date 1763918002078)
@@ -0,0 +1,195 @@
+package com.example.smartair.sharing;
+
+import android.graphics.Color;
+import android.os.Bundle;
+import android.view.View;
+import android.widget.Button;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.Calendar;
+import java.util.Date;
+import java.util.HashMap;
+import java.util.Map;
+import java.util.Random;
+
+public class InviteProviderActivity extends AppCompatActivity {
+
+    private Button btnGenerateCode, btnRevoke;
+    private TextView textInviteCode, textHint, textStatus;
+
+    private FirebaseFirestore db;
+    private String parentId;
+    private String childId;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_invite_provider);
+
+        db = FirebaseFirestore.getInstance();
+
+
+        btnGenerateCode = findViewById(R.id.btnGenerateCode);
+        btnRevoke = findViewById(R.id.btnRevoke);
+        textInviteCode = findViewById(R.id.textInviteCode);
+        textHint = findViewById(R.id.textHint);
+        textStatus = findViewById(R.id.textStatusLabel);
+
+        parentId = FirebaseAuth.getInstance().getUid();
+        childId = getIntent().getStringExtra("CHILD_ID");
+
+        if (parentId == null || childId == null) {
+            Toast.makeText(this, "Error: Missing IDs", Toast.LENGTH_SHORT).show();
+            finish();
+            return;
+        }
+
+        btnGenerateCode.setOnClickListener(v -> generateInviteCode());
+        btnRevoke.setOnClickListener(v -> revokeInviteCode());
+
+        checkForExistingCode();
+    }
+
+
+    private void checkForExistingCode() {
+        // Check the CHILD'S profile (Local)
+        db.collection("parents").document(parentId)
+                .collection("children").document(childId)
+                .collection("invite").document("current")
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (doc.exists()) {
+                        String code = doc.getString("code");
+                        validateGlobalCode(code);
+                    } else {
+                        updateUI(false, null);
+                    }
+                });
+    }
+
+    private void validateGlobalCode(String code) {
+        if (code == null) return;
+
+        db.collection("inviteCodes").document(code).get()
+                .addOnSuccessListener(globalDoc -> {
+                    if (globalDoc.exists()) {
+                        Date expires = globalDoc.getDate("expires");
+
+                        // "Valid 7 Days" Requirement check
+                        if (expires != null && expires.after(new Date())) {
+                            showInviteCode(code);
+                        } else {
+                            deleteLocalInvite();
+                        }
+                    } else {
+                        deleteLocalInvite();
+                    }
+                });
+    }
+
+    private void deleteLocalInvite() {
+        db.collection("parents").document(parentId)
+                .collection("children").document(childId)
+                .collection("invite").document("current")
+                .delete();
+
+        updateUI(false, null);
+    }
+
+    private void generateInviteCode() {
+        revokeInviteCodeInternal(() -> {
+
+            String code = String.valueOf(100000 + new Random().nextInt(900000));
+
+            Calendar c = Calendar.getInstance();
+            c.add(Calendar.DAY_OF_YEAR, 7);
+            Date expiryDate = c.getTime();
+
+            Map<String, Object> data = new HashMap<>();
+            data.put("parentId", parentId);
+            data.put("childId", childId);
+            data.put("used", false);
+            data.put("expires", expiryDate);
+
+            db.collection("inviteCodes").document(code)
+                    .set(data)
+                    .addOnSuccessListener(a -> {
+
+                        Map<String, Object> local = new HashMap<>();
+                        local.put("code", code);
+
+                        db.collection("parents").document(parentId)
+                                .collection("children").document(childId)
+                                .collection("invite").document("current")
+                                .set(local)
+                                .addOnSuccessListener(v -> showInviteCode(code));
+                    })
+                    .addOnFailureListener(e ->
+                            Toast.makeText(this, "Failed to generate code", Toast.LENGTH_SHORT).show()
+                    );
+        });
+    }
+
+    private void revokeInviteCode() {
+        revokeInviteCodeInternal(null);
+        Toast.makeText(this, "Access revoked.", Toast.LENGTH_SHORT).show();
+    }
+
+    private void revokeInviteCodeInternal(Runnable onFinished) {
+        db.collection("parents").document(parentId)
+                .collection("children").document(childId)
+                .collection("invite").document("current")
+                .get()
+                .addOnSuccessListener(doc -> {
+                    if (doc.exists()) {
+                        String code = doc.getString("code");
+
+                        if (code != null) {
+                            db.collection("inviteCodes").document(code).delete();
+                        }
+                        doc.getReference().delete();
+
+                        updateUI(false, null);
+                    }
+
+                    if (onFinished != null) onFinished.run();
+                });
+    }
+
+    private void showInviteCode(String code) {
+        updateUI(true, code);
+    }
+
+    private void updateUI(boolean isActive, String code) {
+        if (isActive) {
+            textInviteCode.setText(code);
+            textInviteCode.setVisibility(View.VISIBLE);
+            textHint.setVisibility(View.VISIBLE);
+
+            if (btnRevoke != null) btnRevoke.setVisibility(View.VISIBLE);
+            btnGenerateCode.setText("Regenerate Code");
+            if (textStatus != null) {
+                textStatus.setText("Status: Active (Shared)");
+                textStatus.setTextColor(Color.parseColor("#4CAF50")); // Green
+            }
+        } else {
+            textInviteCode.setVisibility(View.GONE);
+            textHint.setVisibility(View.GONE);
+
+            if (btnRevoke != null) btnRevoke.setVisibility(View.GONE);
+            btnGenerateCode.setText("Generate Invite Code");
+
+            if (textStatus != null) {
+                textStatus.setText("Status: Not Shared");
+                textStatus.setTextColor(Color.GRAY);
+            }
+        }
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/sharing/EnterInviteCodeActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/sharing/EnterInviteCodeActivity.java b/app/src/main/java/com/example/smartair/sharing/EnterInviteCodeActivity.java
new file mode 100644
--- /dev/null	(date 1763918002077)
+++ b/app/src/main/java/com/example/smartair/sharing/EnterInviteCodeActivity.java	(date 1763918002077)
@@ -0,0 +1,119 @@
+package com.example.smartair.sharing;
+
+import android.os.Bundle;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.example.smartair.R;
+import com.google.firebase.Timestamp;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.Date;
+import java.util.HashMap;
+import java.util.Map;
+
+public class EnterInviteCodeActivity extends AppCompatActivity {
+
+    private EditText editInviteCode;
+    private Button btnRedeem;
+
+    private FirebaseFirestore db;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_enter_invite_code);
+
+        db = FirebaseFirestore.getInstance();
+
+        editInviteCode = findViewById(R.id.editInviteCode);
+        btnRedeem = findViewById(R.id.btnRedeem);
+
+        btnRedeem.setOnClickListener(v -> {
+            String code = editInviteCode.getText().toString().trim();
+            if (code.isEmpty()) {
+                Toast.makeText(this, "Enter the 6-digit code", Toast.LENGTH_SHORT).show();
+                return;
+            }
+            redeemCode(code);
+        });
+    }
+
+    private void redeemCode(String code) {
+        String providerId = FirebaseAuth.getInstance().getUid();
+        if (providerId == null) {
+            Toast.makeText(this, "You must be signed in", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        db.collection("inviteCodes").document(code)
+                .get()
+                .addOnSuccessListener(doc -> {
+
+                    if (!doc.exists()) {
+                        Toast.makeText(this, "Invalid invite code", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    Boolean used = doc.getBoolean("used");
+                    Date expires = doc.getDate("expires");
+
+                    if (used != null && used) {
+                        Toast.makeText(this, "Code already used", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    if (expires != null && expires.before(new Date())) {
+                        Toast.makeText(this, "Invite code expired", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    String parentId = doc.getString("parentId");
+                    String childId = doc.getString("childId");
+
+                    if (parentId == null || childId == null) {
+                        Toast.makeText(this, "Invalid invite data", Toast.LENGTH_SHORT).show();
+                        return;
+                    }
+
+                    linkProvider(providerId, parentId, childId);
+
+                    db.collection("inviteCodes").document(code).update("used", true);
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "Error validating invite code", Toast.LENGTH_SHORT).show()
+                );
+    }
+
+    private void linkProvider(String providerId, String parentId, String childId) {
+
+        Map<String, Object> linkData = new HashMap<>();
+        linkData.put("parentId", parentId);
+        linkData.put("childId", childId);
+        linkData.put("linkedAt", new Date());
+
+        // Provider → child link (permanent)
+        db.collection("providers")
+                .document(providerId)
+                .collection("linkedChildren")
+                .document(childId)
+                .set(linkData);
+
+        // Parent → provider link (for revoke later)
+        db.collection("parents")
+                .document(parentId)
+                .collection("children")
+                .document(childId)
+                .collection("linkedProviders")
+                .document(providerId)
+                .set(linkData)
+                .addOnSuccessListener(a ->
+                        Toast.makeText(this, "Child linked successfully!", Toast.LENGTH_LONG).show())
+                .addOnFailureListener(a ->
+                        Toast.makeText(this, "Failed to link child", Toast.LENGTH_LONG).show());
+    }
+}
Index: app/src/main/java/com/example/smartair/badges_system/BadgeModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/badges_system/BadgeModel.java b/app/src/main/java/com/example/smartair/badges_system/BadgeModel.java
new file mode 100644
--- /dev/null	(date 1763918002065)
+++ b/app/src/main/java/com/example/smartair/badges_system/BadgeModel.java	(date 1763918002065)
@@ -0,0 +1,20 @@
+package com.example.smartair.badges_system;
+
+public class BadgeModel {
+    public String id;
+    public String title;
+    public boolean achieved;
+    public String firstTime;
+    public String description;
+    public boolean highlight;
+
+    public BadgeModel(String id, String title, boolean achieved, String firstTime,
+                      String description, boolean highlight) {
+        this.id = id;
+        this.title = title;
+        this.achieved = achieved;
+        this.firstTime = firstTime;
+        this.description = description;
+        this.highlight = highlight;
+    }
+}
Index: app/src/main/java/com/example/smartair/ui/child/ChildPEFActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/ui/child/ChildPEFActivity.java b/app/src/main/java/com/example/smartair/ui/child/ChildPEFActivity.java
new file mode 100644
--- /dev/null	(date 1763918002083)
+++ b/app/src/main/java/com/example/smartair/ui/child/ChildPEFActivity.java	(date 1763918002083)
@@ -0,0 +1,365 @@
+package com.example.smartair.ui.child;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.text.Editable;
+import android.text.InputType;
+import android.text.TextUtils;
+import android.text.TextWatcher;
+import android.view.View;
+import android.widget.EditText;
+import android.widget.RadioButton;
+import android.widget.RadioGroup;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.content.ContextCompat;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.example.smartair.model.PEFEntry;
+import com.example.smartair.util.PEFValidator;
+import com.example.smartair.util.PEFZoneCalculator;
+import com.google.android.material.button.MaterialButton;
+import com.google.android.material.card.MaterialCardView;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.CollectionReference;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.google.firebase.firestore.QueryDocumentSnapshot;
+import com.google.firebase.firestore.QuerySnapshot;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.Locale;
+import java.util.Map;
+import java.util.HashMap;
+
+/**
+ * Child activity for entering PEF values with pre/post-medicine tags.
+ * Uses Firebase Firestore for data storage instead of local SharedPreferences.
+ */
+public class ChildPEFActivity extends AppCompatActivity {
+    private EditText pefInput;
+    private TextView pefWarningText;
+    private RadioGroup medicineTagGroup;
+    private RadioButton preMedicineRadio;
+    private RadioButton postMedicineRadio;
+    private RadioButton noneRadio;
+    private MaterialButton saveButton;
+    private RecyclerView pefHistoryRecyclerView;
+    private PEFHistoryAdapter historyAdapter;
+    private TextView emptyStateText;
+    private TextView personalBestValueText;
+    private TextView personalBestStatusText;
+    private MaterialCardView zoneCard;
+    private View zoneContentGroup;
+    private TextView zoneStateText;
+    private TextView zonePercentText;
+    private TextView zoneGuidanceText;
+    private TextView zoneSourceText;
+    private TextView zoneEmptyText;
+
+    private Integer latestSavedPef;
+    private Integer currentPersonalBest;
+
+    // Firebase
+    private FirebaseFirestore db;
+    private CollectionReference pefCollection;
+    private FirebaseUser user;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_child_pef);
+
+        // Firebase setup
+        db = FirebaseFirestore.getInstance();
+        user = FirebaseAuth.getInstance().getCurrentUser();
+        if (user != null) {
+            pefCollection = db.collection("users")
+                    .document(user.getUid())
+                    .collection("pef_entries");
+        }
+
+        // Views
+        pefInput = findViewById(R.id.pef_input);
+        pefWarningText = findViewById(R.id.pef_warning_text);
+        medicineTagGroup = findViewById(R.id.medicine_tag_group);
+        preMedicineRadio = findViewById(R.id.pre_medicine_radio);
+        postMedicineRadio = findViewById(R.id.post_medicine_radio);
+        noneRadio = findViewById(R.id.none_radio);
+        saveButton = findViewById(R.id.save_pef_button);
+        pefHistoryRecyclerView = findViewById(R.id.pef_history_recycler_view);
+        emptyStateText = findViewById(R.id.empty_state_text);
+        personalBestValueText = findViewById(R.id.personal_best_value);
+        personalBestStatusText = findViewById(R.id.personal_best_status_text);
+        zoneCard = findViewById(R.id.zone_card);
+        zoneContentGroup = findViewById(R.id.zone_content_group);
+        zoneStateText = findViewById(R.id.zone_state_text);
+        zonePercentText = findViewById(R.id.zone_percent_text);
+        zoneGuidanceText = findViewById(R.id.zone_guidance_text);
+        zoneSourceText = findViewById(R.id.zone_source_text);
+        zoneEmptyText = findViewById(R.id.zone_empty_text);
+
+        pefInput.setInputType(InputType.TYPE_CLASS_NUMBER);
+        pefInput.setHint(R.string.pef_input_hint);
+
+        // Realtime validation
+        pefInput.addTextChangedListener(new TextWatcher() {
+            @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
+            @Override public void onTextChanged(CharSequence s, int start, int before, int count) {
+                validatePEFInput(s.toString());
+                updateZoneCardUsingCurrentState();
+            }
+            @Override public void afterTextChanged(Editable s) {}
+        });
+
+        noneRadio.setChecked(true);
+
+        pefHistoryRecyclerView.setLayoutManager(new LinearLayoutManager(this));
+        historyAdapter = new PEFHistoryAdapter();
+        pefHistoryRecyclerView.setAdapter(historyAdapter);
+
+        saveButton.setOnClickListener(v -> savePEFEntry());
+
+        MaterialButton triageButton = findViewById(R.id.triage_button);
+        if (triageButton != null) {
+            triageButton.setOnClickListener(v ->
+                    startActivity(new Intent(this, ChildTriageActivity.class))
+            );
+        }
+
+        updatePersonalBestCard();
+        fetchPEFEntries();
+    }
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        updatePersonalBestCard();
+        fetchPEFEntries();
+    }
+
+    private void validatePEFInput(String pefString) {
+        if (pefString == null || pefString.trim().isEmpty()) {
+            pefWarningText.setVisibility(View.GONE);
+            return;
+        }
+        try {
+            int pefValue = Integer.parseInt(pefString.trim());
+            PEFValidator.ValidationResult result = PEFValidator.validatePEF(pefValue);
+
+            if (result.hasWarning()) {
+                pefWarningText.setText(result.getWarningMessage());
+                pefWarningText.setVisibility(View.VISIBLE);
+                pefWarningText.setTextColor(result.isValid()
+                        ? ContextCompat.getColor(this, android.R.color.holo_orange_dark)
+                        : ContextCompat.getColor(this, android.R.color.holo_red_dark));
+            } else {
+                pefWarningText.setVisibility(View.GONE);
+            }
+        } catch (NumberFormatException e) {
+            pefWarningText.setVisibility(View.GONE);
+        }
+    }
+
+    private void savePEFEntry() {
+        String pefString = pefInput.getText().toString().trim();
+
+        if (TextUtils.isEmpty(pefString)) {
+            Toast.makeText(this, "Please enter a PEF value", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        try {
+            int pefValue = Integer.parseInt(pefString);
+            PEFValidator.ValidationResult result = PEFValidator.validatePEF(pefValue);
+            if (!result.isValid()) {
+                Toast.makeText(this, result.getWarningMessage(), Toast.LENGTH_LONG).show();
+                return;
+            }
+
+            PEFEntry.MedicineTag tag = PEFEntry.MedicineTag.NONE;
+            int selectedId = medicineTagGroup.getCheckedRadioButtonId();
+            if (selectedId == R.id.pre_medicine_radio) tag = PEFEntry.MedicineTag.PRE_MEDICINE;
+            else if (selectedId == R.id.post_medicine_radio) tag = PEFEntry.MedicineTag.POST_MEDICINE;
+
+            long timestamp = System.currentTimeMillis();
+            Map<String, Object> data = new HashMap<>();
+            data.put("pefValue", pefValue);
+            data.put("timestamp", timestamp);
+            data.put("medicineTag", tag.name());
+
+            saveButton.setEnabled(false);
+            pefCollection.add(data)
+                    .addOnSuccessListener(docRef -> {
+                        saveButton.setEnabled(true);
+                        Toast.makeText(this, "PEF entry saved!", Toast.LENGTH_SHORT).show();
+                        pefInput.setText("");
+                        noneRadio.setChecked(true);
+                        fetchPEFEntries();
+                    })
+                    .addOnFailureListener(e -> {
+                        saveButton.setEnabled(true);
+                        Toast.makeText(this, "Failed to save: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+                    });
+
+        } catch (NumberFormatException e) {
+            Toast.makeText(this, "Please enter a valid number", Toast.LENGTH_SHORT).show();
+        }
+    }
+
+    private void fetchPEFEntries() {
+        if (pefCollection == null) return;
+
+        pefCollection.orderBy("timestamp", com.google.firebase.firestore.Query.Direction.DESCENDING)
+                .get()
+                .addOnSuccessListener((QuerySnapshot querySnapshot) -> {
+                    List<PEFEntry> entries = new ArrayList<>();
+                    for (QueryDocumentSnapshot doc : querySnapshot) {
+                        int value = doc.getLong("pefValue").intValue();
+                        long timestamp = doc.getLong("timestamp");
+                        String tagStr = doc.getString("medicineTag");
+                        PEFEntry.MedicineTag tag = PEFEntry.MedicineTag.NONE;
+                        if (tagStr != null) tag = PEFEntry.MedicineTag.valueOf(tagStr);
+
+                        entries.add(new PEFEntry(value, timestamp, tag));
+                    }
+
+                    historyAdapter.setPEFEntries(entries);
+                    latestSavedPef = entries.isEmpty() ? null : entries.get(0).getPefValue();
+                    updateZoneCardUsingCurrentState();
+
+                    emptyStateText.setVisibility(entries.isEmpty() ? View.VISIBLE : View.GONE);
+                    pefHistoryRecyclerView.setVisibility(entries.isEmpty() ? View.GONE : View.VISIBLE);
+                })
+                .addOnFailureListener(e -> {
+                    Toast.makeText(this, "Failed to fetch entries: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+                });
+    }
+
+    private void updatePersonalBestCard() {
+        // 这里仍可使用 SharedPreferences 或 Firebase PB，暂不改动
+        if (personalBestValueText == null || personalBestStatusText == null) return;
+
+        if (currentPersonalBest != null) {
+            personalBestValueText.setText(getString(R.string.personal_best_value_format, currentPersonalBest));
+            personalBestStatusText.setText(R.string.personal_best_status_set);
+        } else {
+            personalBestValueText.setText(R.string.personal_best_status_missing);
+            personalBestStatusText.setText(R.string.personal_best_description);
+        }
+        updateZoneCardUsingCurrentState();
+    }
+
+    private void updateZoneCardUsingCurrentState() {
+        if (zoneCard == null) return;
+        Integer inputValue = parseInputValue();
+        if (inputValue != null) updateZoneCard(inputValue, true);
+        else updateZoneCard(latestSavedPef, false);
+    }
+
+    private Integer parseInputValue() {
+        if (pefInput == null) return null;
+        String pefString = pefInput.getText().toString().trim();
+        if (pefString.isEmpty()) return null;
+        try {
+            int value = Integer.parseInt(pefString);
+            return value > 0 ? value : null;
+        } catch (NumberFormatException e) {
+            return null;
+        }
+    }
+
+    private void updateZoneCard(Integer pefValue, boolean basedOnInput) {
+        if (currentPersonalBest == null || currentPersonalBest <= 0) {
+            zoneContentGroup.setVisibility(View.GONE);
+            zoneEmptyText.setVisibility(View.VISIBLE);
+            zoneEmptyText.setText(R.string.zone_missing_pb);
+            applyZoneColors(null);
+            return;
+        }
+        if (pefValue == null) {
+            zoneContentGroup.setVisibility(View.GONE);
+            zoneEmptyText.setVisibility(View.VISIBLE);
+            zoneEmptyText.setText(R.string.zone_missing_entries);
+            applyZoneColors(null);
+            return;
+        }
+
+        PEFZoneCalculator.ZoneResult result = PEFZoneCalculator.calculateZone(pefValue, currentPersonalBest);
+        if (!result.isReady() || result.getZone() == PEFZoneCalculator.Zone.UNKNOWN) {
+            zoneContentGroup.setVisibility(View.GONE);
+            zoneEmptyText.setVisibility(View.VISIBLE);
+            zoneEmptyText.setText(R.string.zone_unknown_guidance);
+            applyZoneColors(null);
+            return;
+        }
+
+        zoneContentGroup.setVisibility(View.VISIBLE);
+        zoneEmptyText.setVisibility(View.GONE);
+
+        int labelRes, guidanceRes;
+        switch (result.getZone()) {
+            case GREEN:
+                labelRes = R.string.zone_label_green;
+                guidanceRes = R.string.zone_green_guidance;
+                break;
+            case YELLOW:
+                labelRes = R.string.zone_label_yellow;
+                guidanceRes = R.string.zone_yellow_guidance;
+                break;
+            case RED:
+            default:
+                labelRes = R.string.zone_label_red;
+                guidanceRes = R.string.zone_red_guidance;
+                break;
+        }
+
+        zoneStateText.setText(labelRes);
+        zoneGuidanceText.setText(guidanceRes);
+        zonePercentText.setText(getString(R.string.zone_percent_format,
+                formatPercent(result.getPercentOfPersonalBest())));
+        zoneSourceText.setText(basedOnInput ? R.string.zone_based_on_current_entry
+                : R.string.zone_based_on_latest_entry);
+
+        applyZoneColors(result.getZone());
+    }
+
+    private String formatPercent(float percent) {
+        if (percent < 0f) percent = 0f;
+        return String.format(Locale.getDefault(), "%.0f", percent);
+    }
+
+    private void applyZoneColors(PEFZoneCalculator.Zone zone) {
+        int backgroundColorRes, textColorRes;
+
+        if (zone == null) {
+            backgroundColorRes = R.color.zone_neutral_bg;
+            textColorRes = android.R.color.black;
+        } else {
+            switch (zone) {
+                case GREEN:
+                    backgroundColorRes = R.color.zone_green_bg;
+                    textColorRes = R.color.zone_green_text;
+                    break;
+                case YELLOW:
+                    backgroundColorRes = R.color.zone_yellow_bg;
+                    textColorRes = R.color.zone_yellow_text;
+                    break;
+                case RED:
+                default:
+                    backgroundColorRes = R.color.zone_red_bg;
+                    textColorRes = R.color.zone_red_text;
+                    break;
+            }
+        }
+
+        zoneCard.setCardBackgroundColor(ContextCompat.getColor(this, backgroundColorRes));
+        zoneStateText.setTextColor(ContextCompat.getColor(this, textColorRes));
+        zonePercentText.setTextColor(ContextCompat.getColor(this, textColorRes));
+    }
+}
Index: app/src/main/java/com/example/smartair/medicine_logs/MedicineLogAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/medicine_logs/MedicineLogAdapter.java b/app/src/main/java/com/example/smartair/medicine_logs/MedicineLogAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002073)
+++ b/app/src/main/java/com/example/smartair/medicine_logs/MedicineLogAdapter.java	(date 1763918002073)
@@ -0,0 +1,85 @@
+package com.example.smartair.medicine_logs;
+
+
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.core.content.ContextCompat;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.google.firebase.firestore.DocumentSnapshot;
+
+import java.text.SimpleDateFormat;
+import java.util.ArrayList;
+import java.util.Date;
+import java.util.List;
+import java.util.Locale;
+
+public class MedicineLogAdapter extends RecyclerView.Adapter<MedicineLogAdapter.LogViewHolder> {
+
+    private List<DocumentSnapshot> logList = new ArrayList<>();
+    private static final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault());
+
+    public void setLogs(List<DocumentSnapshot> logs) {
+        this.logList = logs != null ? logs : new ArrayList<>();
+        notifyDataSetChanged();
+    }
+
+    @NonNull
+    @Override
+    public LogViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(parent.getContext())
+                .inflate(R.layout.item_medicine_log, parent, false);
+        return new LogViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull LogViewHolder holder, int position) {
+        holder.bind(logList.get(position));
+    }
+
+    @Override
+    public int getItemCount() {
+        return logList.size();
+    }
+
+    static class LogViewHolder extends RecyclerView.ViewHolder {
+
+        TextView typeText, doseText, timestampText;
+
+        public LogViewHolder(@NonNull View itemView) {
+            super(itemView);
+            typeText = itemView.findViewById(R.id.type_text);
+            doseText = itemView.findViewById(R.id.dose_text);
+            timestampText = itemView.findViewById(R.id.timestamp_text);
+        }
+
+        public void bind(DocumentSnapshot doc) {
+            String type = doc.getString("type");
+            Long dose = doc.getLong("dose");
+            Long ts = doc.getLong("timestamp");
+
+            typeText.setText(type != null ? type : "-");
+            doseText.setText("Dose: " + (dose != null ? dose : "-") + " puffs");
+
+            if (type != null) {
+                if (type.equalsIgnoreCase("Rescue")) {
+                    typeText.setTextColor(ContextCompat.getColor(itemView.getContext(), android.R.color.holo_orange_dark));
+                } else if (type.equalsIgnoreCase("Controller")) {
+                    typeText.setTextColor(ContextCompat.getColor(itemView.getContext(), android.R.color.holo_green_dark));
+                }
+            }
+
+            if (ts != null) {
+                timestampText.setText(sdf.format(new Date(ts)));
+            } else {
+                timestampText.setText("-");
+            }
+        }
+    }
+}
+
Index: app/src/main/java/com/example/smartair/medicine_logs/LogMedicineActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/medicine_logs/LogMedicineActivity.java b/app/src/main/java/com/example/smartair/medicine_logs/LogMedicineActivity.java
new file mode 100644
--- /dev/null	(date 1763918002072)
+++ b/app/src/main/java/com/example/smartair/medicine_logs/LogMedicineActivity.java	(date 1763918002072)
@@ -0,0 +1,131 @@
+package com.example.smartair.medicine_logs;
+
+import android.os.Bundle;
+import android.text.TextUtils;
+import android.view.View;
+import android.widget.RadioButton;
+import android.widget.RadioGroup;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.google.android.material.button.MaterialButton;
+import com.google.android.material.textfield.TextInputEditText;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.firestore.CollectionReference;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.List;
+
+public class LogMedicineActivity extends AppCompatActivity {
+
+    private RadioGroup rgType;
+    private TextInputEditText etDose;
+    private MaterialButton btnSubmit;
+    private RecyclerView rvHistory;
+    private MedicineLogAdapter adapter;
+    private View emptyStateText;
+
+    private FirebaseFirestore db;
+    private FirebaseAuth auth;
+    private CollectionReference logRef;
+    private FirebaseUser user;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_log_medicine);
+
+        rgType = findViewById(R.id.rgType);
+        etDose = findViewById(R.id.etDose);
+        btnSubmit = findViewById(R.id.btnSubmitLog);
+        rvHistory = findViewById(R.id.rvLogHistory);
+        emptyStateText = findViewById(R.id.empty_state_text);
+
+        auth = FirebaseAuth.getInstance();
+        db = FirebaseFirestore.getInstance();
+        user = auth.getCurrentUser();
+
+        if (user == null) {
+            Toast.makeText(this, "请先登录", Toast.LENGTH_SHORT).show();
+            finish();
+            return;
+        }
+
+        logRef = db.collection("users").document(user.getUid()).collection("medicine_logs");
+
+        rvHistory.setLayoutManager(new LinearLayoutManager(this));
+        adapter = new MedicineLogAdapter();
+        rvHistory.setAdapter(adapter);
+
+        btnSubmit.setOnClickListener(v -> submitLog());
+
+        fetchLogs();
+    }
+
+    private void submitLog() {
+        int checkedId = rgType.getCheckedRadioButtonId();
+        if (checkedId == -1) {
+            Toast.makeText(this, "请选择 Rescue 或 Controller", Toast.LENGTH_SHORT).show();
+            return;
+        }
+        RadioButton rb = findViewById(checkedId);
+        String type = rb.getText().toString();
+
+        String doseStr = etDose.getText().toString();
+        if (TextUtils.isEmpty(doseStr)) {
+            Toast.makeText(this, "请输入剂量（puffs）", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        long dose;
+        try {
+            dose = Long.parseLong(doseStr);
+        } catch (NumberFormatException ex) {
+            Toast.makeText(this, "剂量必须为数字", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        long now = System.currentTimeMillis();
+        HashMap<String, Object> data = new HashMap<>();
+        data.put("uid", user.getUid());
+        data.put("email", user.getEmail());
+        data.put("type", type);
+        data.put("dose", dose);
+        data.put("timestamp", now);
+
+        btnSubmit.setEnabled(false);
+        logRef.add(data).addOnSuccessListener(documentReference -> {
+            btnSubmit.setEnabled(true);
+            Toast.makeText(this, "记录已保存", Toast.LENGTH_SHORT).show();
+            etDose.setText("");
+            fetchLogs(); // 更新列表
+        }).addOnFailureListener(e -> {
+            btnSubmit.setEnabled(true);
+            Toast.makeText(this, "保存失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+        });
+    }
+
+    private void fetchLogs() {
+        logRef.orderBy("timestamp").limit(50).get().addOnSuccessListener(queryDocumentSnapshots -> {
+            List<DocumentSnapshot> logs = queryDocumentSnapshots.getDocuments();
+            if (logs.isEmpty()) {
+                emptyStateText.setVisibility(View.VISIBLE);
+                rvHistory.setVisibility(View.GONE);
+            } else {
+                emptyStateText.setVisibility(View.GONE);
+                rvHistory.setVisibility(View.VISIBLE);
+                adapter.setLogs(logs);
+            }
+        }).addOnFailureListener(e -> {
+            Toast.makeText(this, "读取历史失败: " + e.getMessage(), Toast.LENGTH_SHORT).show();
+        });
+    }
+}
Index: app/src/main/java/com/example/smartair/badges_system/BadgeAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/badges_system/BadgeAdapter.java b/app/src/main/java/com/example/smartair/badges_system/BadgeAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002064)
+++ b/app/src/main/java/com/example/smartair/badges_system/BadgeAdapter.java	(date 1763918002064)
@@ -0,0 +1,85 @@
+package com.example.smartair.badges_system;
+
+import android.content.Context;
+import android.graphics.Color;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.cardview.widget.CardView;
+import androidx.recyclerview.widget.RecyclerView;
+
+
+import com.example.smartair.R;
+
+import java.util.List;
+
+public class BadgeAdapter extends RecyclerView.Adapter<BadgeAdapter.ViewHolder> {
+
+    private List<BadgeModel> list;
+    private Context ctx;
+
+    public BadgeAdapter(List<BadgeModel> list, Context ctx) {
+        this.list = list;
+        this.ctx = ctx;
+    }
+
+    @NonNull
+    @Override
+    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(ctx).inflate(R.layout.badge_item, parent, false);
+        return new ViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull ViewHolder h, int pos) {
+        BadgeModel b = list.get(pos);
+
+        // 设置图片
+        int imgRes = ctx.getResources().getIdentifier(b.id, "drawable", ctx.getPackageName());
+        h.ivBadge.setImageResource(imgRes);
+
+        // 标题
+        h.tvBadgeTitle.setText(b.title);
+
+        // 是否获得
+        h.tvAchieved.setText("已获得：" + (b.achieved ? "是" : "否"));
+
+        // 第一次获得时间
+        h.tvFirstTime.setText("第一次获得：" + b.firstTime);
+
+        // 描述
+        h.tvDescription.setText(b.description);
+
+        // 是否高亮（新徽章）
+        if (b.highlight) {
+            h.card.setCardBackgroundColor(Color.parseColor("#FFF59D")); // 黄色高亮
+        } else {
+            h.card.setCardBackgroundColor(Color.WHITE);
+        }
+    }
+
+    @Override
+    public int getItemCount() {
+        return list.size();
+    }
+
+    static class ViewHolder extends RecyclerView.ViewHolder {
+        ImageView ivBadge;
+        TextView tvBadgeTitle, tvAchieved, tvFirstTime, tvDescription;
+        CardView card;
+
+        public ViewHolder(@NonNull View itemView) {
+            super(itemView);
+            ivBadge = itemView.findViewById(R.id.ivBadge);
+            tvBadgeTitle = itemView.findViewById(R.id.tvBadgeTitle);
+            tvAchieved = itemView.findViewById(R.id.tvAchieved);
+            tvFirstTime = itemView.findViewById(R.id.tvFirstTime);
+            tvDescription = itemView.findViewById(R.id.tvDescription);
+            card = itemView.findViewById(R.id.cardBadge);
+        }
+    }
+}
Index: app/src/main/java/com/example/smartair/badges_system/BadgeActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/badges_system/BadgeActivity.java b/app/src/main/java/com/example/smartair/badges_system/BadgeActivity.java
new file mode 100644
--- /dev/null	(date 1763918002063)
+++ b/app/src/main/java/com/example/smartair/badges_system/BadgeActivity.java	(date 1763918002063)
@@ -0,0 +1,94 @@
+package com.example.smartair.badges_system;
+
+import android.os.Bundle;
+import android.widget.Toast;
+
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.RecyclerView;
+
+
+import com.example.smartair.R;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import androidx.recyclerview.widget.LinearLayoutManager;
+
+
+public class BadgeActivity extends AppCompatActivity {
+
+    private RecyclerView rvBadges;
+    private BadgeAdapter adapter;
+    private String uid;
+    private String newBadgeId; // 刚解锁的徽章，用于高亮
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        String newBadge = getIntent().getStringExtra("newBadge");
+        // newBadge 可能是 "badge_2"，也可能是 null（如果不是从解锁来的）
+
+        setContentView(R.layout.activity_badge);
+
+        rvBadges = findViewById(R.id.rvBadges);
+        rvBadges.setLayoutManager(new LinearLayoutManager(this));
+
+        uid = FirebaseAuth.getInstance().getCurrentUser().getUid();
+
+        // 接收从 medicinelog 传来的新徽章 ID
+        newBadgeId = getIntent().getStringExtra("newBadge");
+
+        loadBadges();
+    }
+
+    private void loadBadges() {
+        FirebaseFirestore.getInstance()
+                .collection("users").document(uid)
+                .collection("badges")
+                .get()
+                .addOnSuccessListener(snap -> {
+
+                    List<BadgeModel> list = new ArrayList<>();
+
+                    for (int i = 1; i <= 5; i++) {
+                        String id = "badge_" + i;
+                        DocumentSnapshot doc = snap.getDocuments()
+                                .stream()
+                                .filter(d -> d.getId().equals(id))
+                                .findFirst()
+                                .orElse(null);
+
+                        boolean achieved = doc != null && doc.getBoolean("achieved") != null
+                                && doc.getBoolean("achieved");
+
+                        String time = (doc != null && doc.getTimestamp("firstAchieved") != null)
+                                ? doc.getTimestamp("firstAchieved").toDate().toString()
+                                : "——";
+
+                        String description = doc != null && doc.getString("description") != null
+                                ? doc.getString("description")
+                                : "继续努力，相信你可以做到的！";
+
+                        list.add(new BadgeModel(
+                                id,
+                                "徽章 " + i,
+                                achieved,
+                                time,
+                                description,
+                                id.equals(newBadgeId)   // 是否高亮
+                        ));
+                    }
+
+                    adapter = new BadgeAdapter(list, this);
+                    rvBadges.setAdapter(adapter);
+
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(this, "加载徽章失败：" + e.getMessage(),
+                                Toast.LENGTH_SHORT).show()
+                );
+    }
+}
Index: app/src/main/java/com/example/smartair/util/PEFZoneCalculator.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/util/PEFZoneCalculator.java b/app/src/main/java/com/example/smartair/util/PEFZoneCalculator.java
new file mode 100644
--- /dev/null	(date 1763918002087)
+++ b/app/src/main/java/com/example/smartair/util/PEFZoneCalculator.java	(date 1763918002087)
@@ -0,0 +1,66 @@
+package com.example.smartair.util;
+
+/**
+ * Helper for computing asthma zones based on a child's Personal Best (PB)
+ * and the current Peak Expiratory Flow (PEF) reading.
+ */
+public final class PEFZoneCalculator {
+
+    private PEFZoneCalculator() {
+        // Utility class
+    }
+
+    public enum Zone {
+        GREEN,
+        YELLOW,
+        RED,
+        UNKNOWN
+    }
+
+    public static class ZoneResult {
+        private final Zone zone;
+        private final float percentOfPersonalBest;
+        private final int pefValue;
+        private final boolean ready;
+
+        private ZoneResult(Zone zone, float percentOfPersonalBest, int pefValue, boolean ready) {
+            this.zone = zone;
+            this.percentOfPersonalBest = percentOfPersonalBest;
+            this.pefValue = pefValue;
+            this.ready = ready;
+        }
+
+        public Zone getZone() {
+            return zone;
+        }
+
+        public float getPercentOfPersonalBest() {
+            return percentOfPersonalBest;
+        }
+
+        public int getPefValue() {
+            return pefValue;
+        }
+
+        public boolean isReady() {
+            return ready;
+        }
+    }
+
+    public static ZoneResult calculateZone(Integer pefValue, Integer personalBest) {
+        if (pefValue == null || pefValue <= 0 || personalBest == null || personalBest <= 0) {
+            return new ZoneResult(Zone.UNKNOWN, 0f, 0, false);
+        }
+
+        float percent = (pefValue * 100f) / personalBest;
+        Zone zone;
+        if (percent >= 80f) {
+            zone = Zone.GREEN;
+        } else if (percent >= 50f) {
+            zone = Zone.YELLOW;
+        } else {
+            zone = Zone.RED;
+        }
+        return new ZoneResult(zone, percent, pefValue, true);
+    }
+}
Index: app/src/main/java/com/example/smartair/util/PEFValidator.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/util/PEFValidator.java b/app/src/main/java/com/example/smartair/util/PEFValidator.java
new file mode 100644
--- /dev/null	(date 1763918002087)
+++ b/app/src/main/java/com/example/smartair/util/PEFValidator.java	(date 1763918002087)
@@ -0,0 +1,82 @@
+package com.example.smartair.util;
+
+/**
+ * Utility class for validating PEF (Peak Expiratory Flow) values.
+ * Provides kid-friendly warnings for out-of-range values.
+ */
+public class PEFValidator {
+    
+    // Typical PEF ranges for children (ages 6-16)
+    // These are general guidelines; actual ranges vary by age, height, gender, etc.
+    private static final int MIN_REASONABLE_PEF = 50;  // Very low, but possible for young children
+    private static final int MAX_REASONABLE_PEF = 800;  // High end for older(maybe larger) children
+    private static final int MIN_WARNING_PEF = 100;    // Below this is unusually low
+    private static final int MAX_WARNING_PEF = 600;     // Above this is unusually high
+
+    /**
+     * Validates a PEF value and returns a validation result.
+     * 
+     * @param pefValue The PEF value to validate
+     * @return ValidationResult containing whether the value is valid and a warning message if needed
+     */
+    public static ValidationResult validatePEF(Integer pefValue) {
+        if (pefValue == null) {
+            return new ValidationResult(false, "Please enter a PEF value");
+        }
+
+        if (pefValue <= 0) {
+            return new ValidationResult(false, "PEF value must be greater than 0");
+        }
+
+        if (pefValue < MIN_REASONABLE_PEF) {
+            return new ValidationResult(false, 
+                "This value seems very low. Please check your meter and try again. " +
+                "If this is correct, talk to your parent or doctor.");
+        }
+
+        if (pefValue > MAX_REASONABLE_PEF) {
+            return new ValidationResult(false, 
+                "This value seems very high. Please check your meter and make sure you entered the number correctly.");
+        }
+
+        // Check for warning ranges (values that are unusual but not impossible)
+        if (pefValue < MIN_WARNING_PEF) {
+            return new ValidationResult(true, 
+                "⚠️ This value is lower than usual. Double-check your meter reading.");
+        }
+
+        if (pefValue > MAX_WARNING_PEF) {
+            return new ValidationResult(true, 
+                "⚠️ This value is higher than usual. Make sure you entered the number correctly.");
+        }
+
+        // Value is in normal range
+        return new ValidationResult(true, null);
+    }
+
+    /**
+     * Result of PEF validation.
+     */
+    public static class ValidationResult {
+        private final boolean isValid;
+        private final String warningMessage;
+
+        public ValidationResult(boolean isValid, String warningMessage) {
+            this.isValid = isValid;
+            this.warningMessage = warningMessage;
+        }
+
+        public boolean isValid() {
+            return isValid;
+        }
+
+        public String getWarningMessage() {
+            return warningMessage;
+        }
+
+        public boolean hasWarning() {
+            return warningMessage != null && !warningMessage.isEmpty();
+        }
+    }
+}
+
Index: app/src/main/java/com/example/smartair/utils/SharedPrefsHelper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/utils/SharedPrefsHelper.java b/app/src/main/java/com/example/smartair/utils/SharedPrefsHelper.java
new file mode 100644
--- /dev/null	(date 1763918002088)
+++ b/app/src/main/java/com/example/smartair/utils/SharedPrefsHelper.java	(date 1763918002088)
@@ -0,0 +1,36 @@
+package com.example.smartair.utils;
+
+import android.content.Context;
+import android.content.SharedPreferences;
+
+public class SharedPrefsHelper {
+    private static final String PREFS_NAME = "SmartAirPrefs";
+    private static final String KEY_USER_ROLE = "user_role";
+    private static final String KEY_USER_UID = "user_uid";
+
+    private final SharedPreferences preferences;
+
+    public SharedPrefsHelper(Context context) {
+        this.preferences = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
+    }
+
+    public void saveUserRole(String role) {
+        preferences.edit().putString(KEY_USER_ROLE, role).apply();
+    }
+
+    public String getUserRole() {
+        return preferences.getString(KEY_USER_ROLE, null);
+    }
+
+    public void saveUserUid(String uid) {
+        preferences.edit().putString(KEY_USER_UID, uid).apply();
+    }
+
+    public String getUserUid() {
+        return preferences.getString(KEY_USER_UID, null);
+    }
+
+    public void clear() {
+        preferences.edit().clear().apply();
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/example/smartair/util/ZoneCalculator.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/util/ZoneCalculator.java b/app/src/main/java/com/example/smartair/util/ZoneCalculator.java
new file mode 100644
--- /dev/null	(date 1763918002087)
+++ b/app/src/main/java/com/example/smartair/util/ZoneCalculator.java	(date 1763918002087)
@@ -0,0 +1,62 @@
+package com.example.smartair.util;
+
+/**
+ * Utility class for calculating asthma zones based on Personal Best (PB) and current PEF.
+ * Zone thresholds:
+ * - Green: ≥80% of PB
+ * - Yellow: 50-79% of PB
+ * - Red: <50% of PB
+ */
+public class ZoneCalculator {
+    
+    public enum Zone {
+        GREEN,
+        YELLOW,
+        RED,
+        UNKNOWN // When PB is not set
+    }
+
+
+    public static Zone calculateZone(Integer currentPef, Integer personalBest) {
+        if (personalBest == null || personalBest <= 0 || currentPef == null || currentPef < 0) {
+            return Zone.UNKNOWN;
+        }
+
+        double percentage = (currentPef * 100.0) / personalBest;
+
+        if (percentage >= 80) {
+            return Zone.GREEN;
+        } else if (percentage >= 50) {
+            return Zone.YELLOW;
+        } else {
+            return Zone.RED;
+        }
+    }
+
+    public static int[] getZoneThresholds(Integer personalBest) {
+        if (personalBest == null || personalBest <= 0) {
+            return new int[]{0, 0, 0};
+        }
+
+        int greenThreshold = (int) Math.round(personalBest * 0.80);
+        int yellowThreshold = (int) Math.round(personalBest * 0.50);
+        int redThreshold = 0; // Red is anything below yellow
+
+        return new int[]{greenThreshold, yellowThreshold, redThreshold};
+    }
+
+    public static String getZoneName(Zone zone) {
+        switch (zone) {
+            case GREEN:
+                return "Green";
+            case YELLOW:
+                return "Yellow";
+            case RED:
+                return "Red";
+            case UNKNOWN:
+            default:
+                return "Unknown";
+        }
+    }
+}
+
Index: app/src/main/java/com/example/smartair/ui/child/PEFHistoryAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/ui/child/PEFHistoryAdapter.java b/app/src/main/java/com/example/smartair/ui/child/PEFHistoryAdapter.java
new file mode 100644
--- /dev/null	(date 1763918002084)
+++ b/app/src/main/java/com/example/smartair/ui/child/PEFHistoryAdapter.java	(date 1763918002084)
@@ -0,0 +1,118 @@
+package com.example.smartair.ui.child;
+
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.core.content.ContextCompat;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.example.smartair.R;
+import com.example.smartair.model.PEFEntry;
+
+import java.text.SimpleDateFormat;
+import java.util.ArrayList;
+import java.util.Date;
+import java.util.List;
+import java.util.Locale;
+
+/**
+ * RecyclerView adapter for displaying PEF entry history.
+ * Shows PEF values with pre/post-medicine tags to help children see
+ * how medicine affects breathing.
+ */
+public class PEFHistoryAdapter extends RecyclerView.Adapter<PEFHistoryAdapter.PEFViewHolder> {
+
+    private List<PEFEntry> pefEntries;
+    private final SimpleDateFormat dateFormat;
+
+    public PEFHistoryAdapter() {
+        this.pefEntries = new ArrayList<>();
+        this.dateFormat = new SimpleDateFormat("MMM dd, yyyy 'at' hh:mm a", Locale.getDefault());
+    }
+
+    public void setPEFEntries(List<PEFEntry> entries) {
+        this.pefEntries = entries != null ? entries : new ArrayList<>();
+        notifyDataSetChanged();
+    }
+
+    @NonNull
+    @Override
+    public PEFViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        View view = LayoutInflater.from(parent.getContext())
+                .inflate(R.layout.item_pef_entry, parent, false);
+        return new PEFViewHolder(view);
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull PEFViewHolder holder, int position) {
+        PEFEntry entry = pefEntries.get(position);
+        holder.bind(entry);
+    }
+
+    @Override
+    public int getItemCount() {
+        return pefEntries.size();
+    }
+
+    static class PEFViewHolder extends RecyclerView.ViewHolder {
+
+        private final TextView pefValueText;
+        private final TextView medicineTagText;
+        private final TextView timestampText;
+        private final TextView comparisonText;
+        private final SimpleDateFormat dateFormat;
+
+        public PEFViewHolder(@NonNull View itemView) {
+            super(itemView);
+            pefValueText = itemView.findViewById(R.id.pef_value_text);
+            medicineTagText = itemView.findViewById(R.id.medicine_tag_text);
+            timestampText = itemView.findViewById(R.id.timestamp_text);
+            comparisonText = itemView.findViewById(R.id.comparison_text);
+            this.dateFormat = new SimpleDateFormat("MMM dd, yyyy 'at' hh:mm a", Locale.getDefault());
+        }
+
+        public void bind(PEFEntry entry) {
+            // 显示 PEF 数值
+            pefValueText.setText(entry.getPefValue() + " L/min");
+
+            // 显示 medicine 标签
+            if (entry.getMedicineTag() != PEFEntry.MedicineTag.NONE) {
+                medicineTagText.setText(entry.getMedicineTag().getDisplayName());
+                medicineTagText.setVisibility(View.VISIBLE);
+
+                // 根据标签颜色标记
+                if (entry.isPreMedicine()) {
+                    medicineTagText.setTextColor(
+                            ContextCompat.getColor(itemView.getContext(), android.R.color.holo_orange_dark));
+                } else if (entry.isPostMedicine()) {
+                    medicineTagText.setTextColor(
+                            ContextCompat.getColor(itemView.getContext(), android.R.color.holo_green_dark));
+                }
+            } else {
+                medicineTagText.setVisibility(View.GONE);
+            }
+
+            // 显示时间戳
+            Date date = new Date(entry.getTimestamp());
+            timestampText.setText(dateFormat.format(date));
+
+            // 显示对比信息
+            if (entry.isPostMedicine()) {
+                comparisonText.setVisibility(View.VISIBLE);
+                comparisonText.setText("✓ After medicine");
+                comparisonText.setTextColor(
+                        ContextCompat.getColor(itemView.getContext(), android.R.color.holo_green_dark));
+            } else if (entry.isPreMedicine()) {
+                comparisonText.setVisibility(View.VISIBLE);
+                comparisonText.setText("Before medicine");
+                comparisonText.setTextColor(
+                        ContextCompat.getColor(itemView.getContext(), android.R.color.holo_orange_dark));
+            } else {
+                comparisonText.setVisibility(View.GONE);
+            }
+        }
+    }
+}
Index: app/src/main/java/com/example/smartair/ui/child/ChildTriageActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/ui/child/ChildTriageActivity.java b/app/src/main/java/com/example/smartair/ui/child/ChildTriageActivity.java
new file mode 100644
--- /dev/null	(date 1763918002084)
+++ b/app/src/main/java/com/example/smartair/ui/child/ChildTriageActivity.java	(date 1763918002084)
@@ -0,0 +1,64 @@
+package com.example.smartair.ui.child;
+
+import android.os.Bundle;
+import android.widget.TextView;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.appcompat.widget.AppCompatCheckBox;
+import androidx.core.content.ContextCompat;
+import com.example.smartair.R;
+import com.google.android.material.button.MaterialButton;
+
+/**
+ * Simple triage screen that lets a child answer red-flag questions
+ * and instantly see whether to call emergency services or follow home steps.
+ */
+public class ChildTriageActivity extends AppCompatActivity {
+
+    private AppCompatCheckBox speechCheck;
+    private AppCompatCheckBox chestCheck;
+    private AppCompatCheckBox colorCheck;
+    private TextView resultTitle;
+    private TextView resultMessage;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_child_triage);
+
+        speechCheck = findViewById(R.id.check_speech);
+        chestCheck = findViewById(R.id.check_chest);
+        colorCheck = findViewById(R.id.check_color);
+        resultTitle = findViewById(R.id.result_title);
+        resultMessage = findViewById(R.id.result_message);
+
+        MaterialButton checkButton = findViewById(R.id.check_triage_button);
+        checkButton.setOnClickListener(v -> evaluateFlags());
+    }
+
+    private void evaluateFlags() {
+        boolean hasSpeechFlag = speechCheck.isChecked();
+        boolean hasChestFlag = chestCheck.isChecked();
+        boolean hasColorFlag = colorCheck.isChecked();
+
+        boolean hasRedFlag = hasSpeechFlag || hasChestFlag || hasColorFlag;
+        if (hasRedFlag) {
+            resultTitle.setText(R.string.triage_result_emergency_title);
+            resultMessage.setText(R.string.triage_result_emergency_message);
+            setResultColors(true);
+        } else {
+            resultTitle.setText(R.string.triage_result_home_title);
+            resultMessage.setText(R.string.triage_result_home_message);
+            setResultColors(false);
+        }
+    }
+
+    private void setResultColors(boolean emergency) {
+        int titleColor = emergency
+            ? ContextCompat.getColor(this, R.color.zone_red_text)
+            : ContextCompat.getColor(this, R.color.zone_green_text);
+        int messageColor = ContextCompat.getColor(this, android.R.color.black);
+
+        resultTitle.setTextColor(titleColor);
+        resultMessage.setTextColor(messageColor);
+    }
+}
Index: app/src/main/java/com/example/smartair/ui/parent/SetPersonalBestDialog.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/ui/parent/SetPersonalBestDialog.java b/app/src/main/java/com/example/smartair/ui/parent/SetPersonalBestDialog.java
new file mode 100644
--- /dev/null	(date 1763918002085)
+++ b/app/src/main/java/com/example/smartair/ui/parent/SetPersonalBestDialog.java	(date 1763918002085)
@@ -0,0 +1,119 @@
+package com.example.smartair.ui.parent;
+
+import android.app.Dialog;
+import android.os.Bundle;
+import android.text.InputType;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.widget.EditText;
+import android.widget.TextView;
+import android.widget.Toast;
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AlertDialog;
+import androidx.fragment.app.DialogFragment;
+import com.example.smartair.R;
+import com.example.smartair.data.ChildRepository;
+import com.example.smartair.model.Child;
+
+/**
+ * Dialog for setting or updating a child's Personal Best (PB) value.
+ * Allows parents to input a PB value which is used for zone calculations.
+ */
+public class SetPersonalBestDialog extends DialogFragment {
+    private static final String ARG_CHILD = "child";
+    
+    private Child child;
+    private ChildRepository childRepository;
+    private EditText pbInput;
+
+    public static SetPersonalBestDialog newInstance(Child child) {
+        SetPersonalBestDialog dialog = new SetPersonalBestDialog();
+        Bundle args = new Bundle();
+        args.putSerializable(ARG_CHILD, child);
+        dialog.setArguments(args);
+        return dialog;
+    }
+
+    @NonNull
+    @Override
+    public Dialog onCreateDialog(Bundle savedInstanceState) {
+        if (getArguments() != null) {
+            child = (Child) getArguments().getSerializable(ARG_CHILD);
+        }
+
+        if (child == null) {
+            return super.onCreateDialog(savedInstanceState);
+        }
+
+        childRepository = new ChildRepository(requireContext());
+
+        LayoutInflater inflater = requireActivity().getLayoutInflater();
+        View view = inflater.inflate(R.layout.dialog_set_personal_best, null);
+
+        TextView childNameText = view.findViewById(R.id.child_name_text);
+        pbInput = view.findViewById(R.id.pb_input);
+        TextView currentPbText = view.findViewById(R.id.current_pb_text);
+
+        childNameText.setText("Set Personal Best for " + child.getName());
+
+        if (child.hasPersonalBest()) {
+            currentPbText.setText("Current PB: " + child.getPersonalBest() + " L/min");
+            pbInput.setText(String.valueOf(child.getPersonalBest()));
+        } else {
+            currentPbText.setText("No Personal Best set");
+        }
+
+        pbInput.setInputType(InputType.TYPE_CLASS_NUMBER);
+        pbInput.setHint("Enter PB value (L/min)");
+
+        AlertDialog.Builder builder = new AlertDialog.Builder(requireContext())
+                .setTitle("Set Personal Best")
+                .setView(view)
+                .setPositiveButton("Save", (dialog, which) -> {
+                    savePersonalBest();
+                })
+                .setNegativeButton("Cancel", null);
+
+        return builder.create();
+    }
+
+    private void savePersonalBest() {
+        String pbString = pbInput.getText().toString().trim();
+        
+        if (pbString.isEmpty()) {
+            Toast.makeText(requireContext(), "Please enter a Personal Best value", Toast.LENGTH_SHORT).show();
+            return;
+        }
+
+        try {
+            int pbValue = Integer.parseInt(pbString);
+            
+            if (pbValue <= 0) {
+                Toast.makeText(requireContext(), "Personal Best must be greater than 0", Toast.LENGTH_SHORT).show();
+                return;
+            }
+
+            if (pbValue > 1000) {
+                Toast.makeText(requireContext(), "Please enter a realistic value (typically 100-800 L/min)", Toast.LENGTH_SHORT).show();
+                return;
+            }
+
+            // Update the child's Personal Best
+            childRepository.updatePersonalBest(child.getId(), pbValue);
+            
+            Toast.makeText(requireContext(), 
+                "Personal Best updated to " + pbValue + " L/min", 
+                Toast.LENGTH_SHORT).show();
+
+            // Notify parent activity to refresh
+            if (getActivity() instanceof ParentHomeActivity) {
+                ((ParentHomeActivity) getActivity()).onResume();
+            }
+
+            dismiss();
+        } catch (NumberFormatException e) {
+            Toast.makeText(requireContext(), "Please enter a valid number", Toast.LENGTH_SHORT).show();
+        }
+    }
+}
+
Index: app/src/main/java/com/example/smartair/ui/parent/ParentHomeActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/smartair/ui/parent/ParentHomeActivity.java b/app/src/main/java/com/example/smartair/ui/parent/ParentHomeActivity.java
new file mode 100644
--- /dev/null	(date 1763918002084)
+++ b/app/src/main/java/com/example/smartair/ui/parent/ParentHomeActivity.java	(date 1763918002084)
@@ -0,0 +1,105 @@
+package com.example.smartair.ui.parent;
+
+import android.os.Bundle;
+import android.view.View;
+import android.widget.LinearLayout;
+import android.widget.TextView;
+import androidx.appcompat.app.AppCompatActivity;
+import com.example.smartair.R;
+import com.example.smartair.data.ChildRepository;
+import com.example.smartair.model.Child;
+import com.example.smartair.util.ZoneCalculator;
+import com.google.android.material.button.MaterialButton;
+import java.util.List;
+
+/**
+ * Parent home activity for managing children and their Personal Best values.
+ * Allows parents to view children, set/update PB, and see zone information.
+ */
+public class ParentHomeActivity extends AppCompatActivity {
+    private ChildRepository childRepository;
+    private LinearLayout childrenContainer;
+    private TextView emptyStateText;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.activity_parent_home);
+
+        childRepository = new ChildRepository(this);
+
+        childrenContainer = findViewById(R.id.children_container);
+        emptyStateText = findViewById(R.id.empty_state_text);
+
+        // for test create sample of child it it don't exist
+        if (childRepository.getAllChildren().isEmpty()) {
+            Child sampleChild = new Child(null, "Sample Child", "2010-01-01");
+            childRepository.addChild(sampleChild);
+        }
+
+        refreshChildrenList();
+    }
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        refreshChildrenList();
+    }
+
+    private void refreshChildrenList() {
+        List<Child> children = childRepository.getAllChildren();
+        childrenContainer.removeAllViews();
+
+        if (children.isEmpty()) {
+            emptyStateText.setVisibility(View.VISIBLE);
+            childrenContainer.setVisibility(View.GONE);
+        } else {
+            emptyStateText.setVisibility(View.GONE);
+            childrenContainer.setVisibility(View.VISIBLE);
+
+            for (Child child : children) {
+                View childCard = createChildCard(child);
+                childrenContainer.addView(childCard);
+            }
+        }
+    }
+
+    private View createChildCard(Child child) {
+        View cardView = getLayoutInflater().inflate(R.layout.item_child_pb, childrenContainer, false);
+
+        TextView nameText = cardView.findViewById(R.id.child_name);
+        TextView pbText = cardView.findViewById(R.id.child_pb);
+        TextView zoneInfoText = cardView.findViewById(R.id.zone_info);
+        MaterialButton setPbButton = cardView.findViewById(R.id.set_pb_button);
+
+        nameText.setText(child.getName());
+
+        if (child.hasPersonalBest()) {
+            pbText.setText("Personal Best: " + child.getPersonalBest() + " L/min");
+            pbText.setVisibility(View.VISIBLE);
+            
+            // Show zone thresholds
+            int[] thresholds = ZoneCalculator.getZoneThresholds(child.getPersonalBest());
+            int greenThreshold = thresholds[0];
+            int yellowThreshold = thresholds[1];
+            String zoneInfo = String.format(
+                "Green: ≥%d | Yellow: %d-%d | Red: <%d",
+                greenThreshold, yellowThreshold, greenThreshold - 1, yellowThreshold
+            );
+            zoneInfoText.setText(zoneInfo);
+            zoneInfoText.setVisibility(View.VISIBLE);
+        } else {
+            pbText.setText("Personal Best: Not Set");
+            pbText.setVisibility(View.VISIBLE);
+            zoneInfoText.setVisibility(View.GONE);
+        }
+
+        setPbButton.setOnClickListener(v -> {
+            SetPersonalBestDialog dialog = SetPersonalBestDialog.newInstance(child);
+            dialog.show(getSupportFragmentManager(), "SetPersonalBestDialog");
+        });
+
+        return cardView;
+    }
+}
+
